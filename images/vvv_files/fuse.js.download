!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";var M=this;function F(){try{this.location=this.getBrowserWindowObject().self.location}catch(t){this.location=this.getBrowserWindowObject().location}}Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var i=e||window,n=0;n<M.length;n++)t.call(i,M[n],n,M)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0==n)return!1;for(var o,r,e=0|e,s=Math.max(0<=e?e:n-Math.abs(e),0);s<n;){if((o=i[s])===(r=t)||"number"==typeof o&&"number"==typeof r&&isNaN(o)&&isNaN(r))return!0;s++}return!1}}),Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),i=e.length>>>0,n=arguments[1],o=0;o<i;o++){var r=e[o];if(t.call(n,r,o,e))return r}}),"undefined"!=typeof window&&window.NodeList&&!window.NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),F.prototype.getWindowLocation=function(){return this.location},F.prototype.getFuseDob=function(){return this.getBrowserWindowObject().performance.timing.navigationStart},F.prototype.getPackageMajorVersion=function(){return 2},F.prototype.getBrowserWindowObject=function(){return window.self},F.prototype.getQueryParam=function(e){return this.getWindowLocation().search.split(/[?&]/).filter(function(t){return""!==t}).map(function(t){return t.split("=")}).filter(function(t){return t[0]===e})[0]||[]};var a=new F,U=a.getBrowserWindowObject(),B=function(t,e){var i;t.hasOwnProperty("url")&&((i=U.document.createElement("script")).async=!0,i.type="text/javascript","function"==typeof e&&(i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,e())}:i.onload=function(){e()}),i.src="https:".concat(t.url).concat(t.file),(t=U.document.getElementsByTagName("script")[0]).parentNode.insertBefore(i,t))},G=(z.prototype.updateSlotMetric=function(t,e,i){this.slotMetrics[t]||(this.slotMetrics[t]={}),this.slotMetrics[t].key=i},z.prototype.updateMetric=function(t,e){this.globalMetrics[t]=e},z.prototype.logResources=function(t){},z);function z(t,e,i){void 0===e&&(e={}),void 0===i&&(i={}),this.logger=t,this.globalMetrics=e,this.slotMetrics=i}var W=this&&this.__spreadArray||function(t,e,i){if(i||2===arguments.length)for(var n,o=0,r=e.length;o<r;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},j=["debug","info","warn","error","off"],q=(H.prototype.setFuseDob=function(t){this.fuseDob=t},H.prototype.getTimestamp=function(){return this.fuseDob?" [".concat(Date.now()-this.fuseDob,"]"):""},H.prototype.callLogMethod=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=W(["[".concat(this.logName,"]-").concat(e[0]).concat(this.getTimestamp())],e.slice(1),!0);"warn"!==t&&"error"!==t||(1e3<=this.logs.length&&(this.logs=[]),this.logs.push({level:t,params:n})),"error"!==t&&j.indexOf(t)<j.indexOf(this.logLevel)||this.console[t].apply(null,n)},H.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.callLogMethod("error",t)},H.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.callLogMethod("warn",t)},H.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.callLogMethod("info",t)},H.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.callLogMethod("info",t)},H.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.callLogMethod("debug",t)},H.prototype.setLogLevel=function(t){this.logLevel=t},H.prototype.getLogLevel=function(){return this.logLevel},H.prototype.getLogs=function(){return this.logs},H);function H(t,e,i,n){void 0===n&&(n=n||"off"),this.console=t,this.logName=e,this.fuseDob=i,this.logLevel=n,this.logs=[]}var V,Q,Y,K=this&&this.__assign||function(){return(K=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},J=(Z.prototype.getSlotProblems=function(){return this.slotProblems},Z.prototype.addSlotProblem=function(t){1e3<=this.slotProblems.length&&(this.slotProblems=this.slotProblems.slice(100)),this.slotProblems.push(K(K({},t),{time:this.getElapsedTime()}))},Z.prototype.getFuseDob=function(){return this.fuseDob},Z.prototype.getElapsedTime=function(){return(new Date).getTime()-this.getFuseDob()},Z.prototype.setStateStatus=function(t){var e,i=Date.now();this.states.push(((e={})[t]=!0,e.ts=i,e.load_time_ms=i-this.getFuseDob(),e))},Z.prototype.addAdEvent=function(t,e){var i=Date.now();this.events.push({adEvent:t,requestID:e,ts:i,event_time_ms:i-this.getFuseDob()})},Z);function Z(t){this.fuseDob=t,this.states=[],this.events=[],this.slotProblems=[]}(o=V=V||{}).Desktop="desktop",o.Tablet="tablet",o.Mobile="mobile",(o=Q=Q||{}).Chrome="chrome",o.Safari="safari",o.Opera="opera",o.Edge="edge",o.IE11="ie11",o.Firefox="firefox",o.Other="other",(o=Y=Y||{}).IOS="ios",o.MacOS="mac",o.Android="android",o.Windows="windows",o.Linux="linux",o.ChromeOs="chromeos",o.Other="other";var X=[{regex:/chrome|crios|crmo/i,browser:Q.Chrome},{regex:/firefox|iceweasel|fxios/i,browser:Q.Firefox},{regex:/safari|applewebkit/i,browser:Q.Safari},{regex:/opera/i,browser:Q.Opera},{regex:/opr\/|opios/i,browser:Q.Opera},{regex:/\sedg\//i,browser:Q.Edge},{regex:/edg([ea]|ios)/i,browser:Q.Edge}],$=[{regex:/huawei/i,device:V.Mobile},{regex:/nexus\s*(?:7|8|9|10).*/i,device:V.Tablet},{regex:/ipad/i,device:V.Tablet},{regex:/tablet(?! pc)/i,device:V.Tablet},{regex:/(ipod|iphone)/i,device:V.Mobile},{regex:/nexus\s*[0-6].*/i,device:V.Mobile},{regex:/[^-]mobi/i,device:V.Mobile}],tt=[{os:Y.MacOS,regex:/macintosh/i},{os:Y.IOS,regex:/(ipod|iphone|ipad)/i},{os:Y.Android,regex:/android/i},{os:Y.Windows,regex:/windows /i},{os:Y.Linux,regex:/linux/i},{os:Y.ChromeOs,regex:/CrOS/}],et=(it.prototype.parseDevice=function(){var e=this,t=$.filter(function(t){return t.regex.test(e.userAgent)});return 0<t.length?t[0].device:null!=(t=this.browserWindow.navigator.userAgentData)&&t.mobile?V.Mobile:V.Desktop},it.prototype.parseBrowser=function(){var e=this,t=X.filter(function(t){return t.regex.test(e.userAgent)});return 0<t.length?t[0].browser:Q.Other},it.prototype.parseOperatingSystem=function(){var e=this,t=tt.filter(function(t){return t.regex.test(e.userAgent)});return 0<t.length?t[0].os:Y.Other},it.prototype.getDevice=function(){return this.device},it.prototype.getBrowser=function(){return this.browser},it.prototype.getOperatingSystem=function(){return this.os},it);function it(t){this.browserWindow=t,this.userAgent=t.navigator.userAgent,this.device=this.parseDevice(),this.browser=this.parseBrowser(),this.os=this.parseOperatingSystem()}ot.prototype.recordAdUnitLoad=function(t){var e=t.baseUrl,i=t.fuseId,n=t.adUnitId,t=t.publicationId,e=this.makeUrl("success",{baseUrl:e,fuseId:i,adUnitId:n,publicationId:t});return this.logDetails(i,n,"success"),this.addLinkTag(e)},ot.prototype.recordAdUnitError=function(t){var e=t.baseUrl,i=t.fuseId,n=t.adUnitId,t=t.publicationId,e=this.makeUrl("error",{baseUrl:e,fuseId:i,adUnitId:n,publicationId:t});return this.logDetails(i,n,"error"),this.addLinkTag(e)},ot.prototype.makeUrl=function(t,e){var i=e.baseUrl,n=e.fuseId,o=e.adUnitId,e=e.publicationId;return"https:".concat(i,"2/").concat(n,"/telemetry/").concat(e,"/").concat(o,"/").concat(t,"/").concat(this.deviceInfo.getDevice(),"/").concat(this.deviceInfo.getBrowser())},ot.prototype.addLinkTag=function(t){var e;this._registeredUrls[t]||((e=this.browserWindow.document.createElement("link")).href=t,e.rel="preload",e.as="fetch",this.browserWindow.document.getElementsByTagName("head")[0].appendChild(e),this._registeredUrls[t]=!0)},ot.prototype.logDetails=function(t,e,i){this.logger.log("[STATS]: Record ".concat(i," event for fuse ").concat(t,", ad ").concat(e," on device ").concat(this.deviceInfo.getDevice()," and browser ").concat(this.deviceInfo.getBrowser()))};var nt=ot;function ot(t,e,i){this.deviceInfo=t,this.browserWindow=e,this.logger=i,this._registeredUrls={}}function rt(){}rt.prototype.getResourceLogger=function(){return this.resourceLogger||(this.resourceLogger=new G(this.getLogger())),this.resourceLogger},rt.prototype.getLogLevel=function(){return this.isInDebugMode()?"debug":a.getQueryParam("fuse_log_level")&&a.getQueryParam("fuse_log_level")[1]?(t=a.getQueryParam("fuse_log_level")[1],-1!==j.indexOf(t)?t:"off"):"off";var t},rt.prototype.getLogger=function(){return this.logger||(this.logger=new q(a.getBrowserWindowObject().console,this.getMainLogPrefix(),a.getFuseDob(),this.getLogLevel())),this.logger},rt.prototype.getReporter=function(){return this.reporter||(this.reporter=new J(a.getFuseDob())),this.reporter},rt.prototype.getDeviceInfo=function(){return this.deviceInfo||(this.deviceInfo=new et(a.getBrowserWindowObject())),this.deviceInfo},rt.prototype.getTelemetry=function(){return this.telemetry||(this.telemetry=new nt(this.getDeviceInfo(),a.getBrowserWindowObject(),this.getLogger())),this.telemetry},rt.prototype.getMainLogPrefix=function(){return"FUSE"},rt.prototype.isInDebugMode=function(){return"true"===a.getQueryParam("fuse_debug")[1]};var c=new rt;function st(t){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return null==t}function at(t){return a.getQueryParam(t)[1]||""}var ct=c.getLogger(),lt=function(){return pt("fuseDelayQuantcastInit")},ut=function(){return pt("fuseDelayGptInit")},dt=function(){return pt("fuseDelayPrebidInit")},gt=function(){return pt("fuseDelayUamInit")},pt=function(t){var e=a.getQueryParam(t)[1];if(e)return parseInt(e)||(ct.info("[SETTINGS]: Could not parse ".concat(t," with value ").concat(e," as a number")),null)},ht=function(t){var e=a.getQueryParam(t)[1];if(l(e))return null;var i=/^(false|true|1|0)$/i.test(e)?Boolean(/^(true|1)$/i.test(e)):null;return l(i)&&ct.info("[SETTINGS] Could not parse ".concat(t," with value: ").concat(e," as a boolean")),i};function ft(t,e,i){t&&0<t?(ct.info("[DELAY]: Delaying by ".concat(t,"ms to ").concat(e)),setTimeout(i,t)):i()}function bt(t){var n=new RegExp("^fuse_(\\d+)_".concat(t,"(\\.\\w+|)$"),"i"),t=a.getWindowLocation().search.split(/[?&]/).filter(function(t){return""!==t}).map(function(t){return t.split("=")}).filter(function(t){return n.test(t[0])}),o=[];return t.forEach(function(t){var e,i=t[0].match(n);i[1]&&(e=decodeURIComponent(t[1]),"true"===t[1]?e=!0:"false"===t[1]&&(e=!1),t=i[1],void 0===o[t]&&(o[t]={}),i[2]&&(i=i[2].substring(1),o[t][i]=e))}),o}function mt(){return bt("miniscroller")}var yt="ScrollTrigger",St=(vt.prototype.destroy=function(){this.window.removeEventListener("scroll",this.triggeredCB,this.options)},vt.prototype.enable=function(t,e){this.window=t.getWindow(),this.triggeredCB=e,this.window.addEventListener("scroll",e,this.options)},vt);function vt(){this.options={capture:!0,passive:!0}}var It=function(t,e,i,n,o){var r=t.top,s=t.bottom,a=t.left,c=t.right,l=t.width,t=t.height*o,l=l*o;return 0<=r+t+n&&0<=a+l&&s-t-n<=i&&c-l<=e};var Et=function(t){return!0===t?0:t},Ct={viewable:It,checkInView:function(t,e,i,n){var e=e.getBoundingClientRect(),o=t.document.hidden,r=t.innerWidth||t.document.documentElement.clientWidth,t=t.innerHeight||t.document.documentElement.clientHeight,i=i/100,n=Et(n),e=It(e,r,t,n,i);return!o&&e}},Tt="InView",At=(wt.prototype.check=function(t,e){var i,n,t=e.slotRegistry.getSlot(t);return!!t&&(n=t.slotTemplate,i=e.getCurrentBreakpointName(),n=e.settings.getLazyDeviceToggle(n,i),Ct.checkInView(e.getWindow(),t.element,50,n))},wt);function wt(){}var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},n={fuse_blocked_url:[],fuse_breakpoints:{l:1200,m:970,s:468,xl:1800,xs:0},fuse_cdn:"//cdn.fuseplatform.net/publift/tags/",fuse_id:2356,fuse_industry:["IAB19"],fuse_settings:{adblock:!1,amazonUam:{enabled:!1},blockthrough:!1,cmp:!0,confiant:!1,disableAutoLoadSlots:!1,disable_quantcast:!1,enableMiniScrollers:!1,fuse_test_urls:[],headerbidding:1e3,identity:{enabled:!1},inskinWidth:1200,lazy:!1,onLoadCallback:"",prebid:{analytics:[],breakpoint_options:{l:{enabled:!0,timeout:1e3},m:{enabled:!0,timeout:1e3},s:{enabled:!0,timeout:1e3},xl:{enabled:!0,timeout:1e3},xs:{enabled:!0,timeout:1e3}},defaultTimeout:1e3,enabled:!0,sendAllBids:!1},quickstart:!1,responsive:!0,strict_cmp:!1,useDomObserver:!1,yandex:!1,publication_metadata:{publication_id:3,generation_version:"4.24440.0",generation_time:"2022-05-31T03:03:22.495Z",revision:"v3"}},fuse_slots:[{attributes:{adblock:!1,headerbidding:!0,lazy:!1,refresh:30},bids:[{bidder:"33across",labelAny:["l","xl"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"120x600"}},{bidder:"33across",labelAny:["l","xl"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"160x600"}},{bidder:"33across",labelAny:["xl"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"300x600"}},{bidder:"33across",labelAny:["m"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"728x90"}},{bidder:"33across",labelAny:["m"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"970x90"}},{bidder:"amx",labelAny:["l","xl"],params:{size:"120x600",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["l","xl"],params:{size:"160x600",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["xl"],params:{size:"300x600",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["m"],params:{size:"728x90",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["m"],params:{size:"970x90",tagId:"cHVibGlmdC5jb20"}},{bidder:"appnexus",params:{placementId:"21272737"}},{bidder:"connectad",labelAny:["l","xl"],params:{networkId:"10047",siteId:"1044167",size:"120x600"}},{bidder:"connectad",labelAny:["l","xl"],params:{networkId:"10047",siteId:"1044167",size:"160x600"}},{bidder:"connectad",labelAny:["xl"],params:{networkId:"10047",siteId:"1044167",size:"300x600"}},{bidder:"connectad",labelAny:["m"],params:{networkId:"10047",siteId:"1044167",size:"728x90"}},{bidder:"connectad",labelAny:["m"],params:{networkId:"10047",siteId:"1044167",size:"970x90"}},{bidder:"criteo",labelAny:["l","xl"],params:{publisherSubId:"22339278103_1486316_160x600",size:"160x600",zoneId:"1486316"}},{bidder:"criteo",labelAny:["xl"],params:{publisherSubId:"22339278103_1486322_300x600",size:"300x600",zoneId:"1486322"}},{bidder:"criteo",labelAny:["m"],params:{publisherSubId:"22339278103_1486324_728x90",size:"728x90",zoneId:"1486324"}},{bidder:"criteo",labelAny:["m"],params:{publisherSubId:"22339278103_1486325_970x90",size:"970x90",zoneId:"1486325"}},{bidder:"ix",labelAny:["l","xl"],params:{siteId:"650883",size:[120,600]}},{bidder:"ix",labelAny:["l","xl"],params:{siteId:"650883",size:[160,600]}},{bidder:"ix",labelAny:["xl"],params:{siteId:"650883",size:[300,600]}},{bidder:"ix",labelAny:["m"],params:{siteId:"650883",size:[728,90]}},{bidder:"ix",labelAny:["m"],params:{siteId:"650883",size:[970,90]}},{bidder:"openx",labelAny:["l","xl"],params:{delDomain:"publift-d.openx.net",size:"120x600",unit:"544052390"}},{bidder:"openx",labelAny:["l","xl"],params:{delDomain:"publift-d.openx.net",size:"160x600",unit:"544052390"}},{bidder:"openx",labelAny:["xl"],params:{delDomain:"publift-d.openx.net",size:"300x600",unit:"544052390"}},{bidder:"openx",labelAny:["m"],params:{delDomain:"publift-d.openx.net",size:"728x90",unit:"544052390"}},{bidder:"openx",labelAny:["m"],params:{delDomain:"publift-d.openx.net",size:"970x90",unit:"544052390"}},{bidder:"pubmatic",labelAny:["l","xl"],params:{adSlot:"71161633/OCTOL_octaveonline/rhs_vrec@120x600",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["l","xl"],params:{adSlot:"71161633/OCTOL_octaveonline/rhs_vrec@160x600",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["xl"],params:{adSlot:"71161633/OCTOL_octaveonline/rhs_vrec@300x600",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["m"],params:{adSlot:"71161633/OCTOL_octaveonline/rhs_vrec@728x90",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["m"],params:{adSlot:"71161633/OCTOL_octaveonline/rhs_vrec@970x90",publisherId:"156762"}},{bidder:"rubicon",labelAny:["l"],params:{accountId:"20884",siteId:"370064",sizes:[8,9],zoneId:"2023450"}},{bidder:"rubicon",labelAny:["m"],params:{accountId:"20884",siteId:"370064",sizes:[2,55],zoneId:"2023450"}},{bidder:"rubicon",labelAny:["xl"],params:{accountId:"20884",siteId:"370064",sizes:[8,9,10],zoneId:"2023450"}},{bidder:"triplelift",labelAny:["l","xl"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"120x600"}},{bidder:"triplelift",labelAny:["l","xl"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"160x600"}},{bidder:"triplelift",labelAny:["xl"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"300x600"}},{bidder:"triplelift",labelAny:["m"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"728x90"}},{bidder:"triplelift",labelAny:["m"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"970x90"}}],customLazy:{l:!1,m:!1,s:!1,xl:!1,xs:!1},id:"22339278103",sizeMapping:{l:[[120,600],[160,600]],m:[[728,90],[970,90]],s:[],xl:[[120,600],[160,600],[300,600]],xs:[]},sizes:[[120,600],[160,600],[300,600],[728,90],[970,90]],slot:"/71161633,22201677130/OCTOL_octaveonline/rhs_vrec"},{attributes:{adblock:!1,headerbidding:!0,lazy:!1,refresh:30},bids:[{bidder:"33across",labelAny:["s","xs"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"300x100"}},{bidder:"33across",labelAny:["s","xs"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"320x100"}},{bidder:"33across",labelAny:["s","xs"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"320x50"}},{bidder:"33across",labelAny:["s"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"468x60"}},{bidder:"33across",labelAny:["s"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"728x90"}},{bidder:"amx",labelAny:["s","xs"],params:{size:"300x100",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["s","xs"],params:{size:"320x100",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["s","xs"],params:{size:"320x50",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["s"],params:{size:"468x60",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["s"],params:{size:"728x90",tagId:"cHVibGlmdC5jb20"}},{bidder:"appnexus",params:{placementId:"21272738"}},{bidder:"connectad",labelAny:["s","xs"],params:{networkId:"10047",siteId:"1044167",size:"300x100"}},{bidder:"connectad",labelAny:["s","xs"],params:{networkId:"10047",siteId:"1044167",size:"320x100"}},{bidder:"connectad",labelAny:["s","xs"],params:{networkId:"10047",siteId:"1044167",size:"320x50"}},{bidder:"connectad",labelAny:["s"],params:{networkId:"10047",siteId:"1044167",size:"468x60"}},{bidder:"connectad",labelAny:["s"],params:{networkId:"10047",siteId:"1044167",size:"728x90"}},{bidder:"criteo",labelAny:["s","xs"],params:{publisherSubId:"22339278106_1486318_300x100",size:"300x100",zoneId:"1486318"}},{bidder:"criteo",labelAny:["s","xs"],params:{publisherSubId:"22339278106_1486320_320x100",size:"320x100",zoneId:"1486320"}},{bidder:"criteo",labelAny:["s","xs"],params:{publisherSubId:"22339278106_1486319_320x50",size:"320x50",zoneId:"1486319"}},{bidder:"criteo",labelAny:["s"],params:{publisherSubId:"22339278106_1486324_728x90",size:"728x90",zoneId:"1486324"}},{bidder:"ix",labelAny:["s","xs"],params:{siteId:"650883",size:[300,100]}},{bidder:"ix",labelAny:["s","xs"],params:{siteId:"650883",size:[320,50]}},{bidder:"ix",labelAny:["s","xs"],params:{siteId:"650883",size:[320,100]}},{bidder:"ix",labelAny:["s"],params:{siteId:"650883",size:[468,60]}},{bidder:"ix",labelAny:["s"],params:{siteId:"650883",size:[728,90]}},{bidder:"openx",labelAny:["s","xs"],params:{delDomain:"publift-d.openx.net",size:"300x100",unit:"544052390"}},{bidder:"openx",labelAny:["s","xs"],params:{delDomain:"publift-d.openx.net",size:"320x100",unit:"544052390"}},{bidder:"openx",labelAny:["s","xs"],params:{delDomain:"publift-d.openx.net",size:"320x50",unit:"544052390"}},{bidder:"openx",labelAny:["s"],params:{delDomain:"publift-d.openx.net",size:"468x60",unit:"544052390"}},{bidder:"openx",labelAny:["s"],params:{delDomain:"publift-d.openx.net",size:"728x90",unit:"544052390"}},{bidder:"pubmatic",labelAny:["s","xs"],params:{adSlot:"71161633/OCTOL_octaveonline/sticky_header@300x100",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["s","xs"],params:{adSlot:"71161633/OCTOL_octaveonline/sticky_header@320x100",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["s","xs"],params:{adSlot:"71161633/OCTOL_octaveonline/sticky_header@320x50",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["s"],params:{adSlot:"71161633/OCTOL_octaveonline/sticky_header@468x60",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["s"],params:{adSlot:"71161633/OCTOL_octaveonline/sticky_header@728x90",publisherId:"156762"}},{bidder:"rubicon",labelAny:["s"],params:{accountId:"20884",siteId:"370064",sizes:[1,2,19,43,117],zoneId:"2023452"}},{bidder:"rubicon",labelAny:["xs"],params:{accountId:"20884",siteId:"370064",sizes:[19,43,117],zoneId:"2023452"}},{bidder:"triplelift",labelAny:["s","xs"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"300x100"}},{bidder:"triplelift",labelAny:["s","xs"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"320x100"}},{bidder:"triplelift",labelAny:["s","xs"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"320x50"}},{bidder:"triplelift",labelAny:["s"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"468x60"}},{bidder:"triplelift",labelAny:["s"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"728x90"}}],customLazy:{l:!1,m:!1,s:!1,xl:!1,xs:!1},id:"22339278106",sizeMapping:{m:[],s:[[300,100],[320,50],[320,100],[468,60],[728,90]],xs:[[300,100],[320,50],[320,100]]},sizes:[[300,100],[320,50],[320,100],[468,60],[728,90]],slot:"/71161633,22201677130/OCTOL_octaveonline/sticky_header"},{attributes:{adblock:!1,headerbidding:!0,lazy:!1,refresh:30},bids:[{bidder:"33across",labelAny:["l","xl"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"120x600"}},{bidder:"33across",labelAny:["l","xl"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"160x600"}},{bidder:"33across",labelAny:["xl"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"300x600"}},{bidder:"33across",labelAny:["m"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"728x90"}},{bidder:"33across",labelAny:["m"],params:{productId:"siab",siteId:"bvC2SwQD0r65GbaKlKyvbs",size:"970x90"}},{bidder:"amx",labelAny:["l","xl"],params:{size:"120x600",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["l","xl"],params:{size:"160x600",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["xl"],params:{size:"300x600",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["m"],params:{size:"728x90",tagId:"cHVibGlmdC5jb20"}},{bidder:"amx",labelAny:["m"],params:{size:"970x90",tagId:"cHVibGlmdC5jb20"}},{bidder:"appnexus",params:{placementId:"21333365"}},{bidder:"connectad",labelAny:["l","xl"],params:{networkId:"10047",siteId:"1044167",size:"120x600"}},{bidder:"connectad",labelAny:["l","xl"],params:{networkId:"10047",siteId:"1044167",size:"160x600"}},{bidder:"connectad",labelAny:["xl"],params:{networkId:"10047",siteId:"1044167",size:"300x600"}},{bidder:"connectad",labelAny:["m"],params:{networkId:"10047",siteId:"1044167",size:"728x90"}},{bidder:"connectad",labelAny:["m"],params:{networkId:"10047",siteId:"1044167",size:"970x90"}},{bidder:"criteo",labelAny:["l","xl"],params:{publisherSubId:"22355425224_1486316_160x600",size:"160x600",zoneId:"1486316"}},{bidder:"criteo",labelAny:["xl"],params:{publisherSubId:"22355425224_1486322_300x600",size:"300x600",zoneId:"1486322"}},{bidder:"criteo",labelAny:["m"],params:{publisherSubId:"22355425224_1486324_728x90",size:"728x90",zoneId:"1486324"}},{bidder:"criteo",labelAny:["m"],params:{publisherSubId:"22355425224_1486325_970x90",size:"970x90",zoneId:"1486325"}},{bidder:"ix",labelAny:["l","xl"],params:{siteId:"650883",size:[120,600]}},{bidder:"ix",labelAny:["l","xl"],params:{siteId:"650883",size:[160,600]}},{bidder:"ix",labelAny:["xl"],params:{siteId:"650883",size:[300,600]}},{bidder:"ix",labelAny:["m"],params:{siteId:"650883",size:[728,90]}},{bidder:"ix",labelAny:["m"],params:{siteId:"650883",size:[970,90]}},{bidder:"openx",labelAny:["l","xl"],params:{delDomain:"publift-d.openx.net",size:"120x600",unit:"544052390"}},{bidder:"openx",labelAny:["l","xl"],params:{delDomain:"publift-d.openx.net",size:"160x600",unit:"544052390"}},{bidder:"openx",labelAny:["xl"],params:{delDomain:"publift-d.openx.net",size:"300x600",unit:"544052390"}},{bidder:"openx",labelAny:["m"],params:{delDomain:"publift-d.openx.net",size:"728x90",unit:"544052390"}},{bidder:"openx",labelAny:["m"],params:{delDomain:"publift-d.openx.net",size:"970x90",unit:"544052390"}},{bidder:"pubmatic",labelAny:["l","xl"],params:{adSlot:"71161633/OCTOL_octaveonline/test_vrec_1@120x600",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["l","xl"],params:{adSlot:"71161633/OCTOL_octaveonline/test_vrec_1@160x600",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["xl"],params:{adSlot:"71161633/OCTOL_octaveonline/test_vrec_1@300x600",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["m"],params:{adSlot:"71161633/OCTOL_octaveonline/test_vrec_1@728x90",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["m"],params:{adSlot:"71161633/OCTOL_octaveonline/test_vrec_1@970x90",publisherId:"156762"}},{bidder:"rubicon",labelAny:["l"],params:{accountId:"20884",siteId:"370064",sizes:[8,9],zoneId:"2023454"}},{bidder:"rubicon",labelAny:["m"],params:{accountId:"20884",siteId:"370064",sizes:[2,55],zoneId:"2023454"}},{bidder:"rubicon",labelAny:["xl"],params:{accountId:"20884",siteId:"370064",sizes:[8,9,10],zoneId:"2023454"}},{bidder:"triplelift",labelAny:["l","xl"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"120x600"}},{bidder:"triplelift",labelAny:["l","xl"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"160x600"}},{bidder:"triplelift",labelAny:["xl"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"300x600"}},{bidder:"triplelift",labelAny:["m"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"728x90"}},{bidder:"triplelift",labelAny:["m"],params:{inventoryCode:"OctaveOnline_StandardDisplay",size:"970x90"}}],id:"22355425224",sizeMapping:{l:[[120,600],[160,600]],m:[[728,90],[970,90]],s:[],xl:[[120,600],[160,600],[300,600]],xs:[]},sizes:[[120,600],[160,600],[300,600],[728,90],[970,90]],slot:"/71161633,22201677130/OCTOL_octaveonline/test_vrec_1"},{attributes:{adblock:!1,headerbidding:!1,interstitial:!1,lazy:!1,refresh:30},bids:[{bidder:"appnexus",params:{placementId:"23205718"}},{bidder:"pubmatic",labelAny:["s","xs"],params:{adSlot:"71161633/OCTOL_octaveonline/mob_footer_sticky@320x50",publisherId:"156762"}},{bidder:"rubicon",labelAny:["s"],params:{accountId:"20884",siteId:"370064",sizes:[43],zoneId:"2203340"}},{bidder:"rubicon",labelAny:["xs"],params:{accountId:"20884",siteId:"370064",sizes:[43],zoneId:"2203340"}}],id:"22645000534",sizeMapping:{m:[],s:[[320,50],"fluid"],xs:[[320,50],"fluid"]},sizes:[[320,50],["fluid"]],slot:"/71161633,22201677130/OCTOL_octaveonline/mob_footer_sticky"},{attributes:{adblock:!1,headerbidding:!1,interstitial:!1,lazy:!1,refresh:25},bids:[{bidder:"appnexus",params:{placementId:"23205719"}},{bidder:"pubmatic",labelAny:["m"],params:{adSlot:"71161633/OCTOL_octaveonline/desktop_sticky@728x90",publisherId:"156762"}},{bidder:"pubmatic",labelAny:["m"],params:{adSlot:"71161633/OCTOL_octaveonline/desktop_sticky@970x90",publisherId:"156762"}},{bidder:"rubicon",labelAny:["m"],params:{accountId:"20884",siteId:"370064",sizes:[2,55],zoneId:"2203342"}}],id:"22645000537",sizeMapping:{m:[[728,90],[970,90]],s:[],xs:[]},sizes:[[728,90],[970,90]],slot:"/71161633,22201677130/OCTOL_octaveonline/desktop_sticky"}],fuse_tenant:"publift",fuse_uuid:"4d43e955-8617-590e-b7ef-0a0231ea7e93",sco:{asi:"publift.com",sellerId:"01F1P2NEW8C2G4MYQQJX10SCVJ"},supported_sizes:{l:[[120,600],[160,600],[300,250],[336,280]],m:[[300,250],[336,280],[728,90],[970,90]],s:[[300,100],[300,250],[320,50],[320,100],[336,280],[468,60],[728,90],"fluid"],xl:[[120,600],[160,600],[300,250],[300,600],[336,280]],xs:[[300,100],[300,250],[320,50],[320,100],[336,280],"fluid"]},tenantId:"DGKSPXNV53",fuse_flavour:"default"},_t=!1,e=n.fuse_settings,xt=c.getLogger();function t(t){var o=this;this.overrideParams=t,this.fuseSettings=n.fuse_settings,this.cleaned_fuse_slots=!1,this.v2Compatibility={disableWidgetsRenderer:!1},this.isFluid=function(t){return Array.isArray(t)?"fluid"===t[0]:"fluid"===t},this.isUamEnabled=function(){return!o.isYandexEnabled()&&(e.amazonUam&&e.amazonUam.enabled)},this.isAdblockEnabled=function(){return e.adblock},this.isResponsiveEnabled=function(){return e.responsive},this.getInskinWidth=function(){return e.inskinWidth},this.filterFluidSizes=function(t){return t.filter(function(t){return!o.isFluid(t)})},this.getCurrentSizeMapSizes=function(e,t){var i,n=(o.getFuseSlots().filter(function(t){return t.id===e})||[])[0];return n?n.sizeMapping&&n.sizeMapping[t]?(0===(i=o.filterFluidSizes(n.sizeMapping[t])).length&&xt.debug("[SLOTS]: No non-fluid sizes available for ".concat(e," at current breakpoint: '").concat(t,"'")),i):(xt.warn('[SLOTS]: Fuse slot "'.concat(e,'" has no sizemap at breakpoint ').concat(t,", sizeless prebid units may act strangely.")),o.filterFluidSizes(n.sizes||[])):(xt.warn("[SLOTS]: getCurrentSizeMapSizes(): Could not find fuseSlot with id ".concat(e)),[])},this.getSupportedSizes=function(t){return n.supported_sizes[t]}}t.prototype.getUamSettings=function(){return e.amazonUam},t.prototype.isPrebidEnabled=function(){return!this.isYandexEnabled()&&(!_t&&e.prebid&&e.prebid.enabled)},t.prototype.isPrebidServer=function(){return 0<this.getPrebidServerBidders().length&&!ht("fuseDisablePrebidServer")},t.prototype.getPrebidServerBidders=function(){return this.fuseSettings.prebidServerBidderCodes||[]},t.prototype.getPrebidSettings=function(){return e.prebid},t.prototype.getFuseUUID=function(){return n.fuse_uuid},t.prototype.getSco=function(){return n.sco},t.prototype.getFuseId=function(){return n.fuse_id},t.prototype.getUseTelemetry=function(){return Boolean(e.useTelemetry)},t.prototype.getIosChromeClickHandle=function(){return Boolean(e.iosChromeClickHandle)},t.prototype.getConfiantId=function(){return e.confiantId},t.prototype.isQuantcastEnabled=function(){return this.isCmpRequired()&&(l(e.disable_quantcast)||!e.disable_quantcast)},t.prototype.isCmpRequired=function(){return!this.isYandexEnabled()&&e.cmp},t.prototype.getGdprTimeoutMillis=function(){return 2e4},t.prototype.getUspTimeoutMillis=function(){return 100},t.prototype.getTagStartCutoffMs=function(){return pt("fuseTagStartCutoffMs")||e.tagStartCutoffMs},t.prototype.getPrebidDownloadCutoffMs=function(){return pt("fusePrebidDownloadCutoffMs")||e.prebidDownloadCutoffMs},t.prototype.getPrebidTagStartCutoffMs=function(){return pt("fusePrebidTagStartCutoffMs")||e.prebidTagStartCutoffMs},t.prototype.getUamTagStartCutoffMs=function(){return pt("fuseUamTagStartCutoffMs")||e.uamTagStartCutoffMs},t.prototype.getAuctionMaxSlots=function(){return pt("fuseAuctionMaxSlots")||e.auctionMaxSlots||99},t.prototype.isRefreshCountFromLoaded=function(){return ht("fuseRefreshTimerFromLoaded")||e.refreshTimerFromLoaded||!1},t.prototype.isIdentityEnabled=function(){return e.identity&&e.identity.enabled},t.prototype.getIdentitySettings=function(){return e.identity},t.prototype.isConfiantEnabled=function(){return!this.isYandexEnabled()&&e.confiant},t.prototype.isBlockthroughEnabled=function(){return!this.isYandexEnabled()&&e.blockthrough},t.prototype.isWidgetRendererEnabled=function(){return!this.v2Compatibility.disableWidgetsRenderer&&!e.disableWidgetsRenderer},t.prototype.setDisableWidgetRenderer=function(){this.v2Compatibility.disableWidgetsRenderer=!0},t.prototype.isStrictCmp=function(){return Boolean(e.strict_cmp)},t.prototype.isRequestGdprPersonalisation=function(){return 2593!==this.getFuseId()},t.prototype.setForceDisablePrebid=function(){xt.log("[CONFIG]: Forcefully disabling prebid"),_t=!0},t.prototype.getBreakpoints=function(){var t={};return n.fuse_breakpoints.xl&&(t.xl=n.fuse_breakpoints.xl),n.fuse_breakpoints.l&&(t.l=n.fuse_breakpoints.l),t.m=n.fuse_breakpoints.m,t.s=n.fuse_breakpoints.s,t.xs=n.fuse_breakpoints.xs,t},t.prototype.isMiniScrollersEnabled=function(){var t;return 0<Object.keys(null==(t=this.overrideParams)?void 0:t.miniscrollersParams).length||Boolean(e.enableMiniScrollers)},t.prototype.getTopStickyHeaderSelector=function(){var t;return(null==(t=this.getFuseSlots().filter(function(t){var e;return(null==(e=t.attributes)?void 0:e.miniscroller)&&(null==(e=t.miniscrollerAttributes)?void 0:e.topStickyHeaderSelector)})[0])?void 0:t.miniscrollerAttributes.topStickyHeaderSelector)||at("fuseTopStickyHeaderSelector")||e.topStickyHeaderSelector},t.prototype.getPrebidAnalytics=function(){return e.prebid_analytics||[]},t.prototype.isDomObserverMode=function(){return ht("fuse_dom")||Boolean(e.useDomObserver)},t.prototype.getSlotRefWithoutMcm=function(t){var e=/^(\/\d*),(\d*)(\/.*)$/i;if(!1===e.test(t))return xt.debug("[SETTINGS]: regExGamAdUnitRef.test(slotRef): ".concat(JSON.stringify(e.test(t)),", slotRef: ").concat(t)),t;xt.debug("[SETTINGS]: regExGamAdUnitRef.test(slotRef): ".concat(JSON.stringify(e.test(t)),", slotRef: ").concat(t));e=e.exec(t);return xt.debug("[SETTINGS]: slotRef: ".concat(t,", matches: ").concat(JSON.stringify(e))),"".concat(e[1]).concat(e[3])},t.prototype.cleanSlotBasedOnMcmMode=function(t){var e=this.getSlotRefWithoutMcm(t.slot);return xt.debug("[SETTINGS]: before: with MCM: ".concat(t.slot,", after: without MCM: ").concat(e)),i(i({},t),{slot:e})},t.prototype.cleanSlotSizeMapping=function(t){var e={};return t.sizeMapping.xl&&(e.xl=t.sizeMapping.xl),t.sizeMapping.l&&(e.l=t.sizeMapping.l),e.m=t.sizeMapping.m,e.s=t.sizeMapping.s,e.xs=t.sizeMapping.xs,i(i({},t),{sizeMapping:e})},t.prototype.getFuseSlots=function(){var e,i=this;return this.cleaned_fuse_slots||(e=ht("fuseMcmOff"),n.fuse_slots=n.fuse_slots.map(function(t){return e&&(xt.debug("[SETTINGS]: will".concat(e?"":" NOT"," remove MCM child reference from the slot ref - ").concat(t.slot)),t=i.cleanSlotBasedOnMcmMode(t)),i.isSlotLazy(t)&&(t.conditionConfig={type:"trigger",conditionName:Tt,triggers:[{triggerName:yt,triggerParams:{}}],conditionParams:{}}),t=i.applyOverrides(t),i.cleanSlotSizeMapping(t)}),this.cleaned_fuse_slots=!0),n.fuse_slots},t.prototype.applyOverrides=function(t){var e;return i(i({},t),{attributes:i(i({},t.attributes),{interscroller:void 0!==(null==(e=this.overrideParams)?void 0:e.interscrollersParams[t.id])||(null==(e=t.attributes)?void 0:e.interscroller),sticky:void 0!==(null==(e=this.overrideParams)?void 0:e.stickiesParams[t.id])||(null==(e=t.attributes)?void 0:e.sticky),dynamic:void 0!==(null==(e=this.overrideParams)?void 0:e.dynamicParams[t.id])||((null==(e=t.attributes)?void 0:e.dynamic)||(null==(e=this.overrideParams)?void 0:e.dynamicParams[t.id])),scrollToStick:void 0!==(null==(e=this.overrideParams)?void 0:e.scrollToStickParams[t.id])||(null==(e=t.attributes)?void 0:e.scrollToStick),miniscroller:void 0!==(null==(e=this.overrideParams)?void 0:e.miniscrollersParams[t.id])||(null==(e=t.attributes)?void 0:e.miniscroller)}),interscrollerAttributes:i(i({},t.interscrollerAttributes),null==(e=this.overrideParams)?void 0:e.interscrollersParams[t.id]),stickyAttributes:i(i({},t.stickyAttributes),null==(e=this.overrideParams)?void 0:e.stickiesParams[t.id]),dynamicAttributes:i(i({},t.dynamicAttributes),null==(e=this.overrideParams)?void 0:e.dynamicParams[t.id]),miniscrollerAttributes:i(i({},t.miniscrollerAttributes),null==(e=this.overrideParams)?void 0:e.miniscrollersParams[t.id])})},t.prototype.getSlotTemplate=function(e){return this.getFuseSlots().filter(function(t){return t.id==e})[0]},t.prototype.isScanDOMOnPageLoad=function(){var t=e.disableAutoLoadSlots;return l(t)||!t},t.prototype.isHeaderBiddingSlot=function(t){return t.bids&&0<t.bids.length},t.prototype.isSlotLazy=function(t){return t.attributes.hasOwnProperty("lazy")&&!0===t.attributes.lazy},t.prototype.isSlotWidget=function(t){var e;return(null==(e=t.attributes)?void 0:e.interscroller)||(null==(e=t.attributes)?void 0:e.sticky)||(null==(e=t.attributes)?void 0:e.dynamic)},t.prototype.maxSlotHeightForBreakpoint=function(t,e){return null==(t=null==(t=t.sizeMapping)?void 0:t[e])?void 0:t.reduce(function(t,e){return e[1]>t?Number(e[1]):t},0)},t.prototype.lazyDeviceToggle=function(t,e){return t.hasOwnProperty("customLazy")&&t.customLazy.hasOwnProperty(e)&&!1!==t.customLazy[e]?t.customLazy[e]:t.attributes.lazy},t.prototype.getPrebidOptions=function(t){if(this.isPrebidEnabled()&&e.prebid.breakpoint_options){t=e.prebid.breakpoint_options[t];if(t)return t}return{enabled:this.isPrebidEnabled(),sendAllBids:!0===e.prebid.sendAllBids,timeout:e.prebid.defaultTimeout}},t.prototype.isPrebidEnabledAtBP=function(t){return this.isPrebidEnabled()&&this.getPrebidOptions(t).enabled},t.prototype.isUamEnabledAtBP=function(t){return this.isUamEnabled()&&void 0!==this.getHbTimeout(t)},t.prototype.getHbTimeout=function(t){return this.getPrebidOptions(t).timeout},t.prototype.isSlotEnabledForBreakpoint=function(t,e){var t=this.getSlotTemplate(t);return!!t&&(t.sizeMapping&&0<(null==(t=t.sizeMapping[e])?void 0:t.length))},t.prototype.getPublicationId=function(){return e.publication_metadata.publication_id},t.prototype.getFuseCDN=function(){return n.fuse_cdn},t.prototype.getBlockedUrls=function(){return n.fuse_blocked_url||[]},t.prototype.getFuseIndustry=function(){return n.fuse_industry},t.prototype.getFuseSettings=function(){return this.fuseSettings},t.prototype.getEdgeHtmlMaxAdsRefreshLimit=function(){return this.fuseSettings.edgeHtmlMaxAdsRefreshLimit||60},t.prototype.getDefaultRefreshInterval=function(){return this.fuseSettings.refresh},t.prototype.getAccountSettings=function(){return n},t.prototype.getV2CompatOverrides=function(){return this.v2Compatibility},t.prototype.isTestCreatives=function(){return ht("fuseTestCreatives")||!1},t.prototype.getSlotTestUrls=function(){return e.fuse_test_urls||[]},t.prototype.getYandexBlockId=function(){return at("fuseYandexBlockId")||e.yandexBlockId},t.prototype.isYandexEnabled=function(){return e.yandex||ht("fuseYandex")||""!==at("fuseYandexBlockId")};var u=new t({stickiesParams:bt("sticky"),interscrollersParams:bt("interscroller"),dynamicParams:bt("dynamic"),miniscrollersParams:mt(),scrollToStickParams:bt("scrolltostick")});function Rt(t,e){t&&e()}var d,kt={isEdgeBrowser:function(t){return/[E]dge/.test(t.navigator.userAgent)}},Ot={name:"Google Publisher Tag",url:"//securepubads.g.doubleclick.net/tag/js/",file:"gpt.js"},Pt="is_refresh",Dt="adunit_prev_count",Lt="slot_prev_count",Nt={},Mt={},Ft=!1,g=c.getLogger(),s=a.getBrowserWindowObject(),Ut=a.getWindowLocation(),p=c.getReporter(),Bt=function(){var t=Ut.host;return t.substring(t.length-40,t.length)},Gt=function(){var t=Ut.pathname;return t.substring(t.length-40,t.length)},zt=function(){var t=Ut.search;return t.substring(t.length-40,t.length)},Wt=function(){for(var t=[],e=Ut.pathname.split("/"),i=0;i<e.length;i+=1)e[i].length&&-1===e[i].indexOf(".")&&t.push(e[i]);return t},jt=function(){var e=Ut.host,i=Ut.pathname,n="false";return u.getBlockedUrls().forEach(function(t){-1<t.indexOf(e+i)&&(n="true")}),n};var qt=function(t){s.googletag&&s.googletag._loadStarted_?g.debug("[INIT]: GPT v".concat(d.getVersion()," is already on the page, skip loading another copy")):B(Ot,function(){g.debug("[INIT]: GPT ".concat(s.googletag&&s.googletag._loadStarted_?"v".concat(d.getVersion()," is loaded"):"not loaded")),t()})},Ht=function(){return s.googletag?s.googletag.cmd||(g.info("[GPT]: Initialised window.googletag.cmd as it was missing"),s.googletag.cmd=[]):s.googletag={cmd:[]},d=s.googletag,s.googletag},h=function(t){return Ht().cmd.push(t)};function Vt(t){return g.debug("[GPT]: googletag.display(".concat(t,")")),d.display(t)}function Qt(t){h(function(){t.forEach(function(t){d.pubads().clearTargeting(t.key)})})}var Yt=function(t){t.forEach(function(t){var e=t[1],i=e.getSlotElementId(),t=t[0].slotTemplate.id,i=Nt[i]||0,t=Mt[t]||0;e.setTargeting(Pt,(0<i).toString()),e.setTargeting(Lt,i.toString()),e.setTargeting(Dt,t.toString())})},Kt=function(t){t.forEach(function(t){var e=t[1].getSlotElementId(),t=t[0].slotTemplate.id;Mt[t]=(Mt[t]||0)+1,Nt[e]=(Nt[e]||0)+1})};function Jt(o,r){h(function(){var t,e,i=[],n=(o.forEach(function(t){var e=function(e){if(d){var t,i,n;if(e)return(t=(n=d.pubads().getSlots()).filter(function(t){return 0<=e.indexOf(t.getSlotElementId())})).length!==e.length&&(i=n.map(function(t){return t.getSlotElementId()}),n=e.filter(function(t){return-1===i.indexOf(t)}),g.warn("Could not find a GPT slot for all fuse slots.\n      Missing Slots=".concat(JSON.stringify(n),",\n      All GPT Slots: ").concat(JSON.stringify(i)))),t;g.error("Called getGPTSlot() without a fuseSlotCode")}else g.error("Called getGPTSlot(".concat(e,") but googletag not defined"))}([t.creativeDivId])[0];e&&i.push([t,e])}),i.map(function(t){return t[1]}));n&&0!==n.length?(Yt(i),t=JSON.stringify(n.map(function(t){return t.getSlotElementId()})),!0===kt.isEdgeBrowser(s)?(g.debug("[GC] will trigger GC for iFrames in Edge browser"),e=s.document.querySelectorAll("div[data-fuse] iframe"),new Promise(function(t){setTimeout(function(){try{t()}catch(t){}},5),e.forEach(function(t){t.addEventListener("load",function(){try{for(;this.contentWindow.lastChild;)this.contentWindow.removeChild(this.contentWindow.lastChild);g.debug("[GC]: cleaned iFrame contentWindow")}catch(t){g.error("[GC]: error in cleaning iFrame contentWindow => ".concat(t))}},{once:!0})}),e.forEach(function(t){t.setAttribute("src","about:blank")}),t()}).then(function(){try{CollectGarbage()}catch(t){g.error("[GC]: error in CollectGarbage => ".concat(t))}g.debug("[AUCTION][".concat(r,"]: Calling GPT for ").concat(t)),p.addAdEvent("gpt_pubads_refresh_".concat(t),r),Ft||(p.setStateStatus("first_gpt_refresh"),Ft=!0),d.pubads().refresh(n),Kt(i)}).catch(function(t){g.error("[GC]: error in purgeIframes => ".concat(t))})):(g.debug("[AUCTION][".concat(r,"]: Calling GPT for ").concat(t)),p.addAdEvent("gpt_pubads_refresh_".concat(t),r),Ft||(p.setStateStatus("first_gpt_refresh"),Ft=!0),d.pubads().refresh(n),Kt(i))):g.warn("[AUCTION][".concat(r,"]: Cancelled adserver request because no matching GPT slots found"))})}function Zt(t,e){var i,n,o,r=t.creativeDivId,s=(p.addAdEvent("register_gpt_slot_".concat(r)),t.slotTemplate.slot),a=t.slotTemplate.sizes,c=d.defineSlot(s,a,r);return c?(i=c,(n=t.slotTemplate).sizeMapping&&0!==Object.keys(n.sizeMapping).length?(o=d.sizeMapping(),Object.keys(n.sizeMapping).forEach(function(t){var e=u.getBreakpoints()[t],i=n.sizeMapping[t];void 0!==e&&(g.debug("[GPT] Setting breakpoint for slot ".concat(n.slot," for size ").concat(t," with breakpoint ").concat(e," and mapping ").concat(i)),o.addSize([e,0],pe(i)))}),i.defineSizeMapping(o.build())):g.debug("[GPT]: No fuse sizes defined for ".concat(n.id)),e.forEach(function(t){c.setTargeting(t.key,t.value)}),c.addService(d.pubads())):g.warn("[GPT]: googletag.defineSlot(".concat(s,", ").concat(JSON.stringify(a),", ").concat(r,") returned null")),c}var Xt=function(t,e){h(function(){g.debug("[GPT]: Setting page targeting for [key: ".concat(t,", value: ").concat(e,"]")),d.pubads().setTargeting(t,e)})},$t=function(){Xt("fuse_profanity",jt()),Xt("fuse_site",Bt()),Xt("fuse_path",Gt()),Xt("fuse_query",zt()),Xt("fuse_category",Wt()),Xt("fuse_industry",u.getFuseIndustry()),Xt("testmode","".concat(u.isTestCreatives()));var t=u.getInskinWidth(),t="".concat(s.screen.width>=t);Xt("inskin_yes",t),Xt("fuse_uuid",u.getFuseUUID()),Xt("fuse_publication_id",u.getPublicationId().toString())},te=function(){d.pubads().disableInitialLoad(),d.pubads().collapseEmptyDivs(!0),d.pubads().setCentering(!0),d.pubads().enableSingleRequest(),de(),le(),ue(),$t()};function ee(t){p.setStateStatus("gpt_load_start"),Ht(),qt(function(){p.setStateStatus("gpt_load_finish")}),h(function(){g.debug("[GPT]: Queued fuse events beginning to execute"),p.setStateStatus("gpt_queue_start"),Rt(!u.isCmpRequired(),function(){ge(!0)}),te(),d.enableServices(),t()})}function ie(t){t&&((t=d.defineOutOfPageSlot(t.slot,d.enums.OutOfPageFormat.INTERSTITIAL))?(t.addService(d.pubads()),d.enableServices(),d.display(t),d.pubads().refresh([t])):g.warn("setInterstitialSlot(): googletag.defineOutOfPageSlot returned undefined"))}function ne(t){d.destroySlots(t)}function oe(){Mt={},Nt={}}var re=function(t){h(function(){d.pubads().addEventListener("slotRenderEnded",t)})},se=function(t){h(function(){d.pubads().addEventListener("slotOnload",t)})},ae=function(t){h(function(){d.pubads().addEventListener("slotResponseReceived",t)})},ce=function(t){h(function(){d.pubads().addEventListener("slotRequested",t)})},le=function(){var e=!1;d.pubads().addEventListener("slotOnload",function(t){e||(p.setStateStatus("gpt_first_slot_loaded"),e=!0);t=t.slot.getSlotElementId();p.addAdEvent("gpt_slot_loaded_".concat(t))})},ue=function(){var e=!1;d.pubads().addEventListener("slotRenderEnded",function(t){e||(p.setStateStatus("gpt_first_slot_render_ended"),e=!0);t=t.slot.getSlotElementId();p.addAdEvent("gpt_slot_render_ended_".concat(t))})},de=function(){var e=!1;d.pubads().addEventListener("impressionViewable",function(t){e||(p.setStateStatus("gpt_first_impression_viewable"),e=!0);t=t.slot.getSlotElementId();g.debug("[EVENT]: AD_IMPRESSION_VIEW for ".concat(t)),p.addAdEvent("gpt_impression_viewable_".concat(t))})},ge=function(t){t=t?0:1;g.info("[GPT]: googletag.pubads().setRequestNonPersonalizedAds(".concat(t,")")),s.googletag.pubads().setRequestNonPersonalizedAds(t)},pe=function(t){return t.map(function(t){return u.isFluid(t)&&Array.isArray(t)?t[0]:t})},he=Object.freeze({__proto__:null,setDefaultTargetingAsync:$t,loadGPTLibrary:qt,defineSlot:Zt,setTargetingAsync:Xt,pushToGPTQue:h,displayDiv:Vt,refreshUnitsAsync:Jt,applyStandardSettings:te,registerSlotRenderEndedCallbackAsync:re,registerSlotOnLoadEndedCallbackAsync:se,registerSlotResponseReceivedCallbackAsync:ae,registerSlotOnRequestedCallbackAsync:ce,getFuseCategories:Wt,getFuseHost:Bt,getFusePath:Gt,getFuseQuery:zt,enableServices:function(){s.googletag.enableServices()},setAllowPersonalisedAds:ge,setInterstitialSlot:ie,destroySlots:ne,isGptReady:function(){return Boolean(s.googletag&&s.googletag.apiReady)},enable:ee,clearGPTTargeting:Qt,resetCounts:oe}),fe=c.getLogger(),be={},me=0,ye=0,Se=function(t){be[t]?(be[t].disconnect(),delete be[t],fe.log("[DOM-OBSERVER] observer stopped for ".concat(t))):fe.warn("[DOM-OBSERVER] observer not found for ".concat(t))},ve={addNodeDeletionObserver:function(i,n){var t,o=i.code;be[o]?fe.warn("[DOM-OBSERVER] node for ".concat(o," was already observed")):(fe.log("[DOM-OBSERVER] new observer added ".concat(o)),(t=new MutationObserver(function(t){fe.debug("[DOM-OBSERVER] Start for ".concat(o," Events:").concat(me," Time: ").concat(ye));var e=Date.now(),t=(me++,t.forEach(function(t){"childList"===t.type&&0<t.removedNodes.length&&t.removedNodes.forEach(function(t){(t.id===o||t.querySelector&&t.querySelector("#".concat(o)))&&(Se(o),fe.log("[DOM-OBSERVER] found deleted node ".concat(o)),n(i))})}),Date.now()-e);ye+=t,fe.debug("[DOM-OBSERVER] End for ".concat(o," Took:").concat(t," Events:").concat(me," Time: ").concat(ye))})).observe(document,{attributes:!1,childList:!0,subtree:!0}),be[o]=t),fe.log("[DOM-OBSERVER] observer set to track deletion of ".concat(o))},stopObserver:Se,getObservers:function(){return be}};function Ie(e,i,n){function o(){var t=Date.now()-c;t<i&&0<=t?r=setTimeout(o,i-t):(r=null,n||(l=e.apply(a,s),r||(a=s=null)))}var r,s,a,c,l;return function(){a=this,s=arguments,c=Date.now();var t=n&&!r;return r=r||setTimeout(o,i),t&&(l=e.apply(a,s),a=s=null),l}}var Ee,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ce={},Te={},r=(Object.defineProperty(Te,"__esModule",{value:!0}),{}),f=(f=r,Object.defineProperty(f,"__esModule",{value:!0}),f.TagRevision=void 0,(f=f.TagRevision||(f.TagRevision={})).Stable="stable",f.V2="v2",f.V3="v3",{}),Ae=(Object.defineProperty(f,"__esModule",{value:!0}),{}),we=(Object.defineProperty(Ae,"__esModule",{value:!0}),{}),_e=(D=we,Object.defineProperty(D,"__esModule",{value:!0}),D.BreakpointName=void 0,(D=D.BreakpointName||(D.BreakpointName={})).xl="xl",D.l="l",D.m="m",D.s="s",D.xs="xs",D=Ce,Ee=o&&o.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){t[n=void 0===n?i:n]=e[i]}),o=o&&o.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||Ee(e,t,i)},Object.defineProperty(D,"__esModule",{value:!0}),o(Te,D),o(r,D),o(f,D),o(Ae,D),o(we,D),a.getBrowserWindowObject()),xe=function(t){_e.addEventListener("resize",Ie(t,500))},b=function(t){var i,n=u.getBreakpoints(),o=null!=t?t:_e.innerWidth;return Object.keys(n).forEach(function(t){var e=n[t];e<=o&&(!i||e>i.size)&&(i={size:e,name:t})}),i};function Re(){return b().name!==Ce.BreakpointName.xs}var ke=function(i){var n=_e.innerWidth,o=b(n).size;xe(function(){n=_e.innerWidth;var t=b(n),e=t.size,t=t.name;return e!==o?i(!0,t,o=e):i(!1,t,e)})},Oe=Object.freeze({__proto__:null,setResizeListener:xe,getCurrentBreakpoint:b,isNotXsBreakpoint:Re,watchForBreakpoints:ke}),Pe=c.getLogger(),De=[];function Le(i,t){var n=-1;De.forEach(function(t,e){-1===n&&t.key===i&&(n=e)}),Pe.info("[TARGETING]: Updating custom targeting for [key: ".concat(i,", value: ").concat(t,"]")),-1<n?De[n].value=t:De.push({key:i,value:t}),Xt(i,t)}function Ne(){}Ne.prototype.getPrebidGlobal=function(){return a.getBrowserWindowObject().fusePbjs||(a.getBrowserWindowObject().fusePbjs={que:[]}),a.getBrowserWindowObject().fusePbjs};var Me,Fe=new Ne,Ue=this&&this.__assign||function(){return(Ue=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Be=(Ge.prototype.setup=function(){var t,e=this,i=this.browserWindow[this.userIdentityGlobal],n=(i&&("object"===st(n=i)&&null!==n)&&(i.email||i.phoneNumber||i.emailHashes)?(t={placementID:this.placementId},i.email?t.email=i.email:i.phoneNumber?t.phoneNumber=i.phoneNumber:t.emailHashes=i.emailHashes):t={placementID:this.placementId,storageType:"localStorage",detectionType:"scrapeAndUrl",cssSelectors:["input[type=text]","input[type=email]"],detectionSubject:"all",urlParameter:"user_id",logging:"debug"},document.createElement("script")),i=(n.src="https://ats.rlcdn.com/ats.js",n.onload=function(){e.browserWindow.ats.start(t)},this.browserWindow.document.getElementsByTagName("script")[0]);i.parentNode.insertBefore(n,i)},Ge.prototype.configPrebid=function(t){return Ue(Ue({},t),{userSync:Ue(Ue({},t.userSync),{userIds:[{name:"identityLink",params:{pid:this.placementId},storage:{type:"cookie",name:"idl_env",expires:7}}]})})},Ge);function Ge(t,e,i){this.browserWindow=t,this.userIdentityGlobal=e,this.placementId=i}var ze={UserIdentity:Be,enable:function(t){Me||(Me=new Be(t,u.getFuseSettings().identity.userIdentityGlobal,u.getFuseSettings().identity.placementId)).setup()},getIdentityModule:function(){return Me}},We=this&&this.__assign||function(){return(We=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},m=c.getLogger(),je=a.getPackageMajorVersion(),qe=a.getBrowserWindowObject(),y=Fe.getPrebidGlobal(),He=c.getReporter(),Ve={name:"Prebid.org",url:u.getFuseCDN()||"//cdn.publift.com/fuse/tag/",file:"prebid.js"},Qe="https://mpbs.rubiconproject.com/openrtb2/auction",Ye="https://mpbs.rubiconproject.com/cookie_sync",Ke=function(){var t;{if(He.setStateStatus("prebid_load_script_start"),!y||!y.libLoaded)return(t=We({},Ve)).url+="".concat(je,"/").concat(u.getFuseId(),"/"),B(t,function(){m.debug("[INIT]: Prebid ".concat(y&&y.libLoaded?"".concat(y.version," is loaded and ready"):"not loaded")),He.setStateStatus("prebid_onload_received")});m.warn("[INIT]: Prebid ".concat(y.version," is already loaded skip loading it again"))}},Je=function(t){y&&y.que?y.que.push(function(){try{t.call(void 0)}catch(t){m.error("Error processing command :",t.message,t.stack)}}):m.error("[PREBID]: No prebid que available")};var Ze=function(){u.getPrebidAnalytics().forEach(function(t,e){0!==e&&m.warn("\n        [PREBID]: Having more than one analytics provider active may affect page performance.\n      "),y.enableAnalytics(t),m.log("[ANALYTICS]: Analytics enabled for ".concat(t.provider))})};function Xe(t){return We(We({enableSendAllBids:t&&!0===t.sendAllBids,priceGranularity:{buckets:[{max:3,increment:.01,precision:2},{max:10,increment:.1,precision:2},{max:50,increment:1,precision:2},{max:100,increment:10,precision:2}]},sizeConfig:function(){var n,o;if(u.isResponsiveEnabled())return n=null,o=[],Object.keys(u.getBreakpoints()).forEach(function(t){var e=u.getBreakpoints()[t],i=n-1;m.debug("[PREBID]: Configured breakpoint ".concat(t," ").concat(e,"px to ").concat(i)),o.push({mediaQuery:"(min-width:".concat(e,"px)").concat(n?" and (max-width: ".concat(i,"px)"):""),sizesSupported:u.getSupportedSizes(t),labels:[t]}),n=e}),o}(),userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"}},enableOverride:!0}},t.sco&&{schain:{validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:(e=t.sco).asi,sid:e.sellerId,hp:1}]}}}),0<t.prebidServerBidders.length&&(e=t.prebidServerBidders,m.debug("[PREBID]: Enabling Prebid Server for ".concat(JSON.stringify(e))),{s2sConfig:{accountId:"20884",bidders:e,adapter:"prebidServer",enabled:!0,endpoint:Qe,syncEndpoint:Ye,timeout:750,extPrebid:{cache:{vastxml:{returnCreative:!1}}}}}));var e}var $e=function(t){return m.debug("[PREBID]: Applied config settings"),y.setConfig(t),t};var ti={loadPrebidLibrary:Ke,pushToPrebidQue:Je,setPrebidAdUnits:function(t){var e=b(),e=u.getCurrentSizeMapSizes(t.slotTemplate.id,e.name);m.log("[SLOTS]: Setting Prebid ad units for ".concat(t.creativeDivId," with sizes ").concat(JSON.stringify(e))),y.addAdUnits({code:t.creativeDivId,mediaTypes:{banner:{sizes:e}},bids:t.slotTemplate.bids})},getPrebidDefaultConfig:Xe,setPrebidConfig:$e,getPrebidUnitIndex:function(e){return y&&y.adUnits?y.adUnits.findIndex(function(t){return t.code===e}):void 0},getPrebidUnits:function(t){var i={},n=(y.adUnits.forEach(function(t){return i[t.code]=t}),{});return t.forEach(function(t){var e=i[t];e?n[t]=JSON.parse(JSON.stringify(e)):m.warn("[PREBID]: No prebid unit found for ".concat(t))}),n},enable:function(o){var r=He.getElapsedTime();Ke(),Je(function(){var t,e,i=He.getElapsedTime()-r,n=u.getPrebidDownloadCutoffMs(),n=l(n)||i<=n;n?(m.debug("[PREBID] Started processing queued fuse tasks"),He.setStateStatus("prebid_started_processing_queue"),qe.pbjs&&qe.pbjs.libLoaded?qe.pbjs.renderAd||(qe.pbjs.renderAd=y.renderAd):qe.pbjs=y,t=Xe({sendAllBids:u.getPrebidSettings()&&!0===u.getPrebidSettings().sendAllBids,sco:u.getSco(),prebidServerBidders:u.isPrebidServer()?u.getPrebidServerBidders():[]}),e=ze.getIdentityModule(),u.isIdentityEnabled()&&e&&(m.debug("[PREBID] Enabled identity module"),t=e.configPrebid(t)),$e(t),Ze(),m.debug("[PREBID]: Enabled prebid with ".concat(u.getFuseSettings().headerbidding,"ms bid timeout"))):m.log("[PREBID]: Not enabling because library took ".concat(i,"ms to download")),o(n)})},reset:function(){this.prebidGlobal&&this.prebidGlobal.adUnits&&this.prebidGlobal.removeAdUnit()}},ei=(ii.prototype.on=function(t,e){return!!this.registry[t]&&(this.registry[t].push(e),!0)},ii.prototype.off=function(t,i){return!!this.registry[t]&&(this.registry[t].forEach(function(t,e){t===i&&(n=e)}),!(!n&&0!==n)&&(this.registry[t].splice(n,1),!0));var n},ii.prototype.once=function(e,i){var n=this;return n.on(e,function t(){i.apply(null,Array.prototype.slice.call(arguments)),n.off(e,t)})},ii.prototype.emit=function(e){var i,t,n=this;this.registry[e]&&((i=Array.prototype.slice.call(arguments)).shift(),0<(t=this.registry[e].length)?this.logger.info("[EVENT][".concat(e,"]: Fired, start processing ").concat(t," callbacks")):this.logger.debug("[EVENT][".concat(e,"]: Fired, no pending callbacks")),this.triggered[e]=!0,this.registry[e].forEach(function(t){try{t.apply(null,i)}catch(t){n.logger.error("[EVENT][".concat(e,"]: Caught exception in callback"),t.message,t.stack)}}))},ii.prototype.isTriggered=function(t){return this.triggered[t]},ii);function ii(t,e){var i=this;this.logger=e,this.registry={},this.triggered={},t.forEach(function(t){i.registry[t]=[],i.triggered[t]=!1})}var ni="data-fuse",oi="".concat("div","[").concat(ni,"]"),ri="data-fuse-reset-at",si=(S.prototype.updateSlotElement=function(t,e,i){var n;return this.logger.debug("[SLOTS][".concat(t,": Preparing the element")),e.setAttribute("data-fuse-code","".concat(t)),e.setAttribute("data-fuse-slot","".concat(t)),e.setAttribute("data-fuse-processed-at",this.getElapsedTime().toString()),e.removeAttribute(ri),this.document.getElementById(t)?this.logger.warn("[DOM-SCAN]: Found existing slot element with id ".concat(t)):((n=this.document.createElement("div")).setAttribute("id","".concat(t)),n.classList.add("fuse-slot"),n.style.maxWidth="inherit",this.fuseSlotFormatter.format(e,i),this.templateSettings.isYandexEnabled()&&this.fuseSlotFormatter.updateSlotForYandex(n,i),e.appendChild(n)),e},S.prototype.assignSlotCounter=function(t){return this.slotCounter[t]||(this.slotCounter[t]=0),++this.slotCounter[t]},S.prototype.assignSlotElementId=function(t){return"".concat("fuse-slot-").concat(t,"-").concat(this.assignSlotCounter(t))},S.prototype.processRawElement=function(t,e){var i=t.getAttribute(ni),n=this.templateSettings.getSlotTemplate(i);if(!n)return this.logger.warn("[SLOTS]: Unknown FuseId ".concat(i)),null;var o=t.getAttribute("data-fuse-code"),r=t.getAttribute(ri);if(e){if(o&&!r)return this.logger.debug("[SLOTS]: Skip ".concat(o," because it was already processed")),null;o&&r&&this.logger.debug("[SLOTS]: Processing ".concat(o," again because it has been reset"))}else o&&this.logger.warn("[SLOTS]: Processing ".concat(o," again. This is likely to be an error, but preserved for backwards compatibility"));e=this.assignSlotElementId(i);return this.updateSlotElement(e,t,n),{slotTemplate:n,elementId:e,element:t,targeting:S.extractTargeting(t)}},S.getTargetingValue=function(t){return 0<t.indexOf(",")?t.split(",").map(function(t){return t.trim()}).filter(function(t){return""!==t}):t},S.extractTargeting=function(e){var t=e.getAttributeNames().filter(function(t){return"data-targeting-key"!==t&&"data-targeting-value"!==t}).filter(function(t){return 0===t.indexOf("data-targeting-",0)}).map(function(t){return{attributeKey:t,targetingKey:t.replace("data-targeting-","").trim()}}).map(function(t){return{key:t.targetingKey,value:e.getAttribute(t.attributeKey)}}).filter(function(t){var e=t.key,t=t.value;return e&&e.length&&t&&t.length}).map(function(t){var e=t.key,t=t.value;return{key:e,value:S.getTargetingValue(t)}}),i=e.getAttribute("data-targeting-key"),n=e.getAttribute("data-targeting-value");return i&&i.length&&n&&n.length&&!t.some(function(t){return t.key===i})&&t.push({key:i,value:S.getTargetingValue(n)}),t},S.prototype.findElementWithDomId=function(t){var e=this.document.querySelectorAll("".concat("div",'[id="').concat(t,'"][').concat(ni,"]"));return 0==e.length?this.logger.warn("[SLOTS]: No DOM element found with both id='".concat(t,"' AND a data-fuse attribute")):1<e.length&&this.logger.warn("[SLOTS]: Multiple DOM elements found with id '".concat(t,"'")),e},S.prototype.findAllFuseElements=function(){return this.document.querySelectorAll(oi)},S.prototype.findElementsWithTemplateId=function(t){return this.document.querySelectorAll("".concat("div","[").concat(ni,'="').concat(t,'"]'))},S.prototype.processRawElements=function(t,e){var i=this,n=[];return t.forEach(function(t){t=i.processRawElement(t,e);t&&n.push(t)}),n},S.prototype.processSlots=function(t){var e=this.findAllFuseElements();return this.processRawElements(e,t)},S.prototype.processZoneWithDivId=function(t,e){t=this.findElementWithDomId(t),t=this.processRawElements(t,e);return t[t.length-1]},S.prototype.processLastSlotWithFuseId=function(t,e){t=this.findElementsWithTemplateId(t),t=this.processRawElements(t,e);return t[t.length-1]},S.prototype.processSlotsWithFuseId=function(t,e){t=this.findElementsWithTemplateId(t);return this.processRawElements(t,e)},S);function S(t,e,i,n,o){this.logger=t,this.document=e,this.templateSettings=i,this.fuseSlotFormatter=n,this.getElapsedTime=o,this.slotCounter={}}var ai=this&&this.__assign||function(){return(ai=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ci="onSlotsInitialised",li="onSlotCreated",ui=(v.prototype.getElements=function(){var e=this,i={};return Object.keys(this.REGISTERED_SLOTS).forEach(function(t){t=e.REGISTERED_SLOTS[t];i[t.creativeDivId]=t.element}),i},v.prototype.getSlotTemplates=function(){var e=this,i={};return Object.keys(this.REGISTERED_SLOTS).forEach(function(t){t=e.REGISTERED_SLOTS[t];i[t.creativeDivId]=t.slotTemplate}),i},v.prototype.getSlotsForTemplateId=function(e){var i=this;return Object.keys(this.REGISTERED_SLOTS).filter(function(t){return i.REGISTERED_SLOTS[t].slotTemplate.id===e}).map(function(t){return i.REGISTERED_SLOTS[t]})},v.prototype.getActiveSlots=function(){var e=this;return Object.keys(this.REGISTERED_SLOTS).filter(function(t){return e.REGISTERED_SLOTS[t].currentlyActive}).map(function(t){return e.REGISTERED_SLOTS[t]})},v.prototype.getDeletedFuseCodes=function(){return this.DELETED_FUSE_DIVS},v.prototype.getSlotInitEmitter=function(){return this.tagInitEmitter},v.prototype.getSlotsCount=function(){return Object.keys(this.REGISTERED_SLOTS).length},v.prototype.isDeletedSlot=function(t){return-1!==this.DELETED_FUSE_DIVS.indexOf(t)},v.prototype.filterUndeleted=function(t,i){var n=this;return t.filter(function(t){var e=!n.isDeletedSlot(t);return!e&&i&&i(t),e})},v.prototype.reset=function(){var e=this,i=(Object.keys(this.REGISTERED_SLOTS).forEach(function(t){e.isDeletedSlot(t)&&e.logger.log("[EVENT]: resetSlots() unit already deleted ".concat(t)),e.DELETED_FUSE_DIVS.push(t)}),this.getElements());Object.keys(i).forEach(function(t){i[t].setAttribute(ri,e.reporter.getElapsedTime().toString())}),Object.keys(this.SLOT_ACTIVATOR).forEach(function(t){e.SLOT_ACTIVATOR[t].destroy()}),this.REGISTERED_SLOTS={},this.SLOT_ACTIVATOR={},this.clearFuseSkins()},v.prototype.registeredSlotConfig=function(i,n,t){return{creativeDivId:i,element:t,slotTemplate:n,isInView:function(t){var e=n.attributes.interscroller?t.document.querySelector(".publift-widget-".concat(n.id,"-container")):t.document.getElementById(i);return Ct.checkInView(t,e,50,!1)}}},v.prototype.registerActiveSlot=function(t,e,i,n){e=ai(ai({},this.registeredSlotConfig(t,e,i)),{initialisedActive:!0,activatedAt:this.reporter.getElapsedTime(),currentlyActive:!0,storedAt:this.reporter.getElapsedTime()});return this.REGISTERED_SLOTS[t]=e,this.enablePartners(e,n),e},v.prototype.registerInactiveSlot=function(t,e,i,n){e=ai(ai({},this.registeredSlotConfig(t,e,i)),{activatedAt:null,initialisedActive:!1,currentlyActive:!1,storedAt:this.reporter.getElapsedTime()});return this.REGISTERED_SLOTS[t]=e,this.SLOT_ACTIVATOR[t]=n,e},v.prototype.activateInactiveSlot=function(t,e,i){var n;this.REGISTERED_SLOTS[t]&&!0===this.REGISTERED_SLOTS[t].currentlyActive?this.logger.warn("[SLOTS][".concat(t,"]: Skipped activation because the unit was already activated")):(n=this.REGISTERED_SLOTS[t],this.SLOT_ACTIVATOR[t].destroy(),n.currentlyActive=!0,n.activatedAt=this.reporter.getElapsedTime(),this.enablePartners(n,e),i([n]))},v.prototype.enablePartners=function(t,e){this.enableGptAsync(t,e),this.settings.isHeaderBiddingSlot(t.slotTemplate)?this.enablePrebidAsync(t):this.logger.debug("[SLOTS]: Skip prebid registration for ".concat(t.creativeDivId," because headerbidding not enabled"))},v.prototype.enablePrebidAsync=function(t){var e=this;ti.pushToPrebidQue(function(){e.isDeletedSlot(t.creativeDivId)?e.logger.log("[SLOTS]: Skip prebid registration for deleted unit ".concat(t.creativeDivId)):ti.setPrebidAdUnits(t)})},v.prototype.enableGptAsync=function(t,e){var i=this;h(function(){i.isDeletedSlot(t.creativeDivId)?i.logger.log("[SLOTS]: Skip registration for deleted unit ".concat(t.creativeDivId)):(i.gptSlotRegistry.add(t.slotTemplate.id,Zt(t,e)),Vt(t.creativeDivId))})},v.prototype.getFuseElement=function(t){t=this.REGISTERED_SLOTS[t];if(t)return t.element},v.prototype.deleteSlot=function(t){this.logger.debug("[SLOTS][".concat(t,"]: Deleting slot")),this.DELETED_FUSE_DIVS.push(t),delete this.REGISTERED_SLOTS[t],this.SLOT_ACTIVATOR[t].destroy(),delete this.SLOT_ACTIVATOR[t]},v.prototype.getSlot=function(t){return this.REGISTERED_SLOTS[t]},v.prototype.getSlots=function(t){var e=this,i=[];return t.forEach(function(t){t=e.getSlot(t);t&&i.push(t)}),i},v.prototype.buildActivator=function(t,e,i,n,o){var r=this;return this.conditionFactory.buildActivator(e,t,i,function(){return r.activateInactiveSlot(t,n,o)})},v.prototype.registerFuseSlot=function(t,e,i,n,o,r,s){var a;return this.settings.isDomObserverMode()&&(ve.addNodeDeletionObserver(i,this.fuseNodeDeletionCallback),this.resourceLogger.logResources("addNodeDeletionObserver")),o?(this.logger.log("[SLOTS][".concat(t,"]: Registering as active because it is forced")),a=this.registerActiveSlot(t,i,e,n)):i.conditionConfig?(o=this.buildActivator(t,i.conditionConfig,r,n,s)).checkCondition()?(this.logger.log("[SLOTS][".concat(t,"]: Registering as active because conditions already satisfied")),a=this.registerActiveSlot(t,i,e,n)):(this.logger.log("[SLOTS][".concat(t,"]: Registering as inactive and enabling triggers")),a=this.registerInactiveSlot(t,i,e,o),o.enableTriggers()):(this.logger.log("[SLOTS][".concat(t,"]: Registering as active because no conditions defined")),a=this.registerActiveSlot(t,i,e,n)),this.tagInitEmitter.emit(li),a},v.prototype.register=function(t,e,i,n){var o=this,t=t.map(function(t){return o.registerFuseSlot(t.elementId,t.element,t.slotTemplate,t.targeting,i,e,n)});return this.logger.debug("[SLOTS]: Registered ".concat(t.length," slots")),this.tagInitEmitter.emit(ci),t},v.prototype.fuseNodeDeletionCallback=function(t){var e=t.creativeDivId,t=t.slotTemplate;this.logger.log("[DOM-OBSERVER] run node deletion callback for ".concat(e)),this.isDeletedSlot(e)?this.logger.log("[DOM-OBSERVER] unit already deleted ".concat(e)):(this.gptSlotRegistry.purgeByElement(t.id,e),this.deleteSlot(e),this.resourceLogger.logResources("fuseNodeDeletionCallback"),this.prebidGlobal&&this.prebidGlobal.adUnits&&this.prebidGlobal.adUnits.length&&this.prebidGlobal.removeAdUnit(e)),this.resourceLogger.logResources("resetSlots")},v.prototype.clearFuseSkins=function(){this.logger.debug("[DOM]: Clearing fuse skins");for(var t=this.browserWindow.document.querySelectorAll("div.fuse-custom-skin"),e=0;e<t.length;e++)t[e].parentNode.removeChild(t[e])},v);function v(t,e,i,n,o,r,s,a){this.prebidGlobal=t,this.logger=e,this.reporter=i,this.browserWindow=n,this.resourceLogger=o,this.gptSlotRegistry=r,this.settings=s,this.conditionFactory=a,this.DELETED_FUSE_DIVS=[],this.REGISTERED_SLOTS={},this.SLOT_ACTIVATOR={},this.tagInitEmitter=new ei([ci,li],this.logger)}I.prototype.add=function(t,e){var i=this,n=I.getLCTemplateId(t),o=(Array.isArray(this.slots[n])||(this.slots[n]=[]),this.logger.debug("[GPT-REGISTRY]: Added ".concat(n)),this.slots[n].push(e),this.templateTargetings[n]);o?(Object.keys(o).forEach(function(t){e.setTargeting(t,o[t]),i.logger.debug("[GPT-REGISTRY]: Set targeting. slotTemplateId: ".concat(n,", gpt slot id: ").concat(e.getSlotElementId(),", key: ").concat(t,", value: ").concat(o[t]))}),this.logger.debug("[GPT-REGISTRY]: Applied targeting for ".concat(n," on newly added gpt slot - id: ").concat(e.getSlotElementId()))):this.logger.debug("[GPT-REGISTRY]: No template targeting set for slotTemplateId: ".concat(n))},I.prototype.purgeAll=function(){var e=this;Object.keys(this.slots).forEach(function(t){return e.purge(t)})},I.getLCTemplateId=function(t){return t.toLowerCase()},I.prototype.purge=function(t){var t=I.getLCTemplateId(t),e=(this.logger.debug("[GPT REGISTRY]: Purging ".concat(t)),this.slots[t]);e&&(this.destroySlotsFunc(e),delete this.slots[t],delete this.templateTargetings[t])},I.prototype.purgeByElement=function(t,e){var i=this.getSlots(t)||[],n=i.find(function(t){return t.getSlotElementId()===e});n?(this.destroySlotsFunc([n]),this.slots[I.getLCTemplateId(t)]=i.filter(function(t){return t.getSlotElementId()!==e})):this.logger.warn("[GPT-REGISTRY]: No slot found for key: ".concat(t," code: ").concat(e))},I.prototype.getSlotsLength=function(){return Object.keys(this.slots).length},I.prototype.getSlots=function(t){return t&&"string"==typeof t&&Array.isArray(this.slots[I.getLCTemplateId(t)])?this.slots[I.getLCTemplateId(t)]:[]},I.prototype.addTemplateTargetings=function(t,e,i){t=I.getLCTemplateId(t);this.templateTargetings[t]||(this.templateTargetings[t]={}),this.templateTargetings[t][e]=i},I.prototype.getTemplateTargetings=function(t){t=I.getLCTemplateId(t);return this.templateTargetings[t]||null},I.prototype.setSlotTargetingById=function(e,i,n){var o=this;this.addTemplateTargetings(e,i,n),this.logger.debug("[GPT-REGISTRY]: Template targeting set. slotTemplateId: ".concat(e,", key: ").concat(i,", value: ").concat(JSON.stringify(n))),this.getSlots(e).forEach(function(t){try{t.setTargeting(i,n),o.logger.debug("[GPT-REGISTRY]: Applied template targetings. slot id: ".concat(t.getSlotElementId(),", key: ").concat(i,", value: ").concat(JSON.stringify(n)))}catch(t){o.logger.error("[GPT-REGISTRY]: Error occurred while individually setTargeting for slot ".concat(e,"."),t.message,t.stack)}})};var di=I;function I(t,e){var i=this;this.logger=t,this.gptDestroySlots=e,this.templateTargetings={},this.slots={},this.destroySlotsFunc=void 0,this.destroySlotsFunc=function(t){var e=t.map(function(t){return t.getSlotElementId()});i.logger.debug("[GPT-REGISTRY]: Calling googletag.destroySlots(".concat(JSON.stringify(e),")")),i.gptDestroySlots(t)}}function gi(){}gi.prototype.getGptSlotRegistry=function(){return this.gptSlotRegistry||(this.gptSlotRegistry=new di(c.getLogger(),ne)),this.gptSlotRegistry};var pi=new gi;fi.prototype.plan=function(t){var e=this,i="".concat(++this.auctionCounter),n=b().name,o=this.settings.getHbTimeout(n),r=void 0!==o,s=this.settings.isUamEnabledAtBP(n)&&r,r=this.settings.isPrebidEnabledAtBP(n)&&r,a=(s||r||this.logger.debug("[PLANNER][".concat(i,"]: Headerbidding is not configured at breakpoint ").concat(n)),this.settings.getAuctionMaxSlots()),t=this.sortSlotsByViewport(i,t).slice(0,a),a=t.filter(function(t){return e.settings.isHeaderBiddingSlot(t.slotTemplate)}),c=0<a.length;return{auctionId:i,usePrebid:this.isUsePrebid(r,i,c),useUam:this.isUseUam(s,i,c),hbTimeout:o,hbSlots:a,breakpointName:n,gptSlots:t}},fi.prototype.sortSlotsByViewport=function(t,e){var e=e.sort(function(t,e){t=t.element.getBoundingClientRect(),e=e.element.getBoundingClientRect();return t.top-e.top}),i=e.map(function(t){return t.creativeDivId});return this.logger.debug("[PLANNER][".concat(t,"]: Slot priority order: ").concat(JSON.stringify(i))),e},fi.prototype.isUseUam=function(t,e,i){return t&&!this.initManager.isUamReady()?this.logger.info("[AUCTION][".concat(e,"]: UAM has not finished loading and will be excluded from the auction")):t&&!i&&this.logger.debug("[AUCTION][".concat(e,"]: UAM has been excluded from the auction because no headerbidding slots are enabled")),t&&this.initManager.isUamReady()&&i},fi.prototype.isUsePrebid=function(t,e,i){return t&&!this.initManager.isPrebidReady()?this.logger.info("[AUCTION][".concat(e,"]: Prebid has not finished loading and will be excluded from the auction")):t&&!this.consentManager.isAllowPersonalisation()?this.logger.info("[AUCTION][".concat(e,"]: Prebid has been excluded from the auction because personalisation is disabled")):t&&!i&&this.logger.debug("[AUCTION][".concat(e,"]: Prebid has been excluded from the auction because no headerbidding slots are enabled")),t&&this.initManager.isPrebidReady()&&this.consentManager.isAllowPersonalisation()&&i};var hi=fi;function fi(t,e,i,n){this.logger=t,this.settings=e,this.initManager=i,this.consentManager=n,this.auctionCounter=0}var bi,mi,yi=this&&this.__assign||function(){return(yi=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Si=((Te=bi=bi||{}).GPT_REQUEST="GPT_REQUEST",Te.GPT_RESPONSE="GPT_RESPONSE",Te.GPT_RENDERED="GPT_RENDERED",Te.GPT_LOADED="GPT_LOADED",Te.CANCELLED="CANCELLED",Te.SUPERSEDED="SUPERSEDED",(r=mi=mi||{})[r.PREBID_REQUEST=0]="PREBID_REQUEST",r[r.PREBID_RESPONSE=1]="PREBID_RESPONSE",r[r.PREBID_SKIPPED=2]="PREBID_SKIPPED",r[r.UAM_REQUEST=3]="UAM_REQUEST",r[r.UAM_RESPONSE=4]="UAM_RESPONSE",r[r.UAM_SKIPPED=5]="UAM_SKIPPED",r[r.GPT_REQUEST=6]="GPT_REQUEST",r[r.CANCELLED=7]="CANCELLED",E.prototype.createNewAuction=function(t,e,i){this.auctions[t.auctionId]={started:this.reporter.getElapsedTime(),creativeDivIds:t.gptSlots.map(function(t){return t.creativeDivId}),slotNames:t.gptSlots.map(function(t){return t.slotTemplate.slot}),hbDivIds:t.hbSlots.map(function(t){return t.creativeDivId}),uamIncluded:t.useUam,uamResponded:!1,uamSkipped:!1,prebidIncluded:t.usePrebid,prebidResponded:!1,prebidSkipped:!1,uamCancelled:!1,prebidCancelled:!1,gptRequestSent:!1,auctionPhaseCallback:e,slotStatus:t.gptSlots.reduce(function(t,e){return yi(yi({},t),((t={})[e.creativeDivId]={slotPhaseCallback:function(t){return i(e,t)}},t))},{})}},E.prototype.getAuctionStatus=function(t){return this.auctions[t]},E.prototype.getActiveGptCalls=function(){return Object.keys(this.activeGptCalls)},E.prototype.getSlotStatus=function(t,e){return this.auctions[t].slotStatus[e]},E.prototype.getSlotStatusInferredAuction=function(t,e){var i=this.activeGptCalls[t];if(i)return this.auctions[i].slotStatus[t];this.logger.debug("[AUCTION-STATUS][".concat(e,"]: Could not find active GPT call for ").concat(t))},E.prototype.onPrebidRequest=function(t){t=this.auctions[t];t.prebidRequestTime=this.reporter.getElapsedTime(),t.auctionPhaseCallback(mi.PREBID_REQUEST)},E.prototype.onPrebidResponse=function(t){t=this.auctions[t];t.prebidResponseTime=this.reporter.getElapsedTime(),t.prebidResponded=!0,t.auctionPhaseCallback(mi.PREBID_RESPONSE)},E.prototype.onPrebidSkipped=function(t){t=this.auctions[t];t.prebidSkipped=!0,t.auctionPhaseCallback(mi.PREBID_SKIPPED)},E.prototype.onUamRequest=function(t){t=this.auctions[t];t.uamRequestTime=this.reporter.getElapsedTime(),t.auctionPhaseCallback(mi.UAM_REQUEST)},E.prototype.onUamSkipped=function(t){t=this.auctions[t];t.uamSkipped=!0,t.auctionPhaseCallback(mi.UAM_SKIPPED)},E.prototype.onUamResponse=function(t){t=this.auctions[t];t.uamResponseTime=this.reporter.getElapsedTime(),t.uamResponded=!0,t.auctionPhaseCallback(mi.UAM_RESPONSE)},E.prototype.cancelAuction=function(t){t=this.auctions[t];t.cancelled=this.reporter.getElapsedTime(),t.auctionPhaseCallback(mi.CANCELLED)},E.prototype.removeFromGptActive=function(t){var e=this.activeGptCalls[t];e?(this.logger.debug("[AUCTION][".concat(e,"]: Removed ").concat(t," from GPT active list")),delete this.activeGptCalls[t]):this.logger.debug("[AUCTION]: Could not find ".concat(t," in the GPT active list"))},E.prototype.onGptRequest=function(i,t){var n=this;t.forEach(function(t){var e=n.getSlotStatus(i,t);e&&(e.gptRequestTime=n.reporter.getElapsedTime(),e.slotPhaseCallback(bi.GPT_REQUEST),(e=n.activeGptCalls[t])&&(n.logger.warn("[AUCTION][".concat(i,"]: ").concat(t," is part of an uncompleted auction: ").concat(e," and is marked superseded")),n.auctions[e].slotStatus[t].supersededTime=n.reporter.getElapsedTime(),n.auctions[e].slotStatus[t].slotPhaseCallback(bi.SUPERSEDED)),n.activeGptCalls[t]=i)}),this.auctions[i].gptRequestSent=!0,this.auctions[i].auctionPhaseCallback(mi.GPT_REQUEST)},E.prototype.onGptResponse=function(t){t=this.getSlotStatusInferredAuction(t,bi.GPT_RESPONSE);t&&(t.gptResponseTime=this.reporter.getElapsedTime(),t.slotPhaseCallback(bi.GPT_RESPONSE))},E.prototype.onGptSlotRendered=function(t,e){var i=this.getSlotStatusInferredAuction(t,bi.GPT_RENDERED);i&&(i.gptOnRenderTime=this.reporter.getElapsedTime(),e||this.removeFromGptActive(t),i.slotPhaseCallback(bi.GPT_RENDERED))},E.prototype.onGptSlotLoaded=function(t){var e=this.getSlotStatusInferredAuction(t,bi.GPT_LOADED);e&&(e.gptOnLoadTime=this.reporter.getElapsedTime(),this.removeFromGptActive(t),e.slotPhaseCallback(bi.GPT_LOADED))},E.prototype.cancelSlotAuction=function(t,e,i){this.logger.info("[AUCTION][".concat(t,"]: Cancelled auction for ").concat(e," because ").concat(i));i=this.getSlotStatus(t,e);i&&(i.cancelledTime=this.reporter.getElapsedTime(),this.removeFromGptActive(e),i.slotPhaseCallback(bi.CANCELLED))},E.prototype.getAuctions=function(){return this.auctions},E);function E(t,e){this.logger=t,this.reporter=e,this.auctions={},this.activeGptCalls={}}C.prototype.sendGptRequest=function(t,e){var i=this,n=this.fuseSlotRegistry.filterUndeleted(t,function(t){i.auctionState.cancelSlotAuction(e,t,"slot DOM element was deleted")});this.auctionState.onGptRequest(e,t),this.fuseSlotRegistry.clearFuseSkins(),this.touchObserver.waitForTouchEnd(function(){i.logger.debug("Touch has ended, refreshing ads"),Jt(i.fuseSlotRegistry.getSlots(n),e)})},C.prototype.handleHBResponse=function(t,e,i){var n,o,r=this.auctionState.getAuctionStatus(t);r.gptRequestSent?e&&this.logger.debug("[AUCTION][".concat(t,"]: Received ").concat(e," bid after adserver request already sent")):(n=r.prebidIncluded,o=r.uamIncluded,i?(this.logger.info("[AUCTION][".concat(t,"]: Timeout reached with missing responses, sending to GPT.\n          Status: ").concat(JSON.stringify(r))),this.sendGptRequest(r.creativeDivIds,t)):o&&n?(r.uamResponded||r.uamCancelled)&&(r.prebidResponded||r.prebidCancelled)?(this.logger.info("[AUCTION][".concat(t,"]: All necessary responses received, sending to GPT")),this.sendGptRequest(r.creativeDivIds,t)):this.logger.debug("[AUCTION][".concat(t,"]: Still waiting for responses. Status: ").concat(JSON.stringify(r))):(this.logger.debug("[AUCTION][".concat(t,"]: ").concat(e," complete, calling GPT")),this.sendGptRequest(r.creativeDivIds,t)))},C.prototype.setAuctionTimeout=function(t,e){var i=this,t=t+250;this.logger.debug("[AUCTION][".concat(e,"]: Set auction failure timeout of ").concat(t)),setTimeout(function(){return i.handleHBResponse(e,null,!0)},t)},C.prototype.startPrebidAuction=function(n,t,e){var o=this,r=t.map(function(t){return t.code}),i=JSON.stringify(r);this.reporter.addAdEvent("prebid_request_".concat(i),n),this.logger.info("[AUCTION][".concat(n,"]: Requesting prebid for: ").concat(i)),this.logger.debug("[AUCTION][".concat(n,"]: Prebid request details: ").concat(JSON.stringify(t))),0<t.length?(this.firstPrebidRequest||(this.firstPrebidRequest=!0,this.reporter.setStateStatus("first_prebid_request")),this.prebidGlobal.requestBids({auctionId:n,adUnits:t,timeout:e,bidsBackHandler:function(t,e){o.auctionState.onPrebidResponse(n);var i=Object.keys(t);o.logger.info("[AUCTION][".concat(n,"]: Prebid auction complete. Any-bidder-timedout?=").concat(e,". Responding slots: ").concat(JSON.stringify(i))),0<i.length?o.logger.debug("[AUCTION][".concat(n,"]: Prebid response details: "),JSON.stringify(t)):o.logger.warn("[AUCTION][".concat(n,"]: No bid responses received from prebid")),o.reporter.addAdEvent("prebid_response_".concat(JSON.stringify(i)),n),o.firstPrebidResponse||(o.firstPrebidResponse=!0,o.reporter.setStateStatus("first_prebid_response"));try{o.prebidGlobal.setTargetingForGPTAsync(r),o.handleHBResponse(n,"prebid",!1)}catch(t){o.logger.error("[AUCTION][".concat(n,"]: ").concat(t.message," ").concat(t.stack))}}})):(this.logger.info("[AUCTION][".concat(n,"]: Skipped prebid call because no eligible slots available")),this.auctionState.onPrebidSkipped(n))},C.prototype.startUamAuction=function(e,t){var i,n=this;t.length?(i=JSON.stringify(t.map(function(t){return t.slotID})),this.reporter.addAdEvent("uam_request_".concat(i),e),this.logger.info("[AUCTION][".concat(e,"]: Sending UAM request for ").concat(i)),this.logger.debug("[AUCTION][".concat(e,"]: Sending UAM request with slot details: ").concat(JSON.stringify(t))),this.firstUamRequest||(this.firstUamRequest=!0,this.reporter.setStateStatus("first_uam_request")),this.uam.makeBids(t,function(t){n.logger.info("[AUCTION][".concat(e,"]: Received UAM response")),n.logger.debug("[AUCTION][".concat(e,"]: UAM response details: "),JSON.stringify(t)),n.reporter.addAdEvent("uam_response_".concat(i),e),n.firstUamResponse||(n.firstUamResponse=!0,n.reporter.setStateStatus("first_uam_response")),n.auctionState.onUamResponse(e),n.handleHBResponse(e,"uam",!1)})):(this.logger.debug("[AUCTION][".concat(e,"]: Skipped UAM bid because no UAM slots found")),this.auctionState.onUamSkipped(e))},C.prototype.startGptOnlyAuction=function(t,e){this.logger.debug("[AUCTION][".concat(t,"]: Starting GPT-only auction")),this.sendGptRequest(e,t)},C.prototype.prepareUamRequest=function(t,e){var i=this,n=b().name;return e.map(function(t){var e=i.settings.getCurrentSizeMapSizes(t.slotTemplate.id,n);return{slotID:t.creativeDivId,slotName:t.slotTemplate.slot,sizes:e}})},C.prototype.preparePrebidRequest=function(n,t){var o=this,e=t.map(function(t){return t.creativeDivId}),r=[],s=ti.getPrebidUnits(e);return t.forEach(function(t){var e=b().name,e=o.settings.getCurrentSizeMapSizes(t.slotTemplate.id,e),i=s[t.creativeDivId];i?(r.push(i),i.mediaTypes||(i.mediaTypes={}),i.mediaTypes.banner||(i.mediaTypes.banner={}),i.mediaTypes.banner.sizes=e):o.logger.debug("[AUCTION][".concat(n,"]: Could not find prebid unit for ").concat(t.creativeDivId))}),r},C.prototype.executeAuction=function(e,t,i){var n,o=this,r=e.auctionId,s=e.gptSlots.map(function(t){return t.creativeDivId});this.auctionState.createNewAuction(e,t,i),this.logger.log("[AUCTION][".concat(r,"]: Running with plan: ").concat((t={auctionId:(t=e).auctionId,usePrebid:t.usePrebid,useUam:t.useUam,hbSlots:t.hbSlots.map(function(t){return t.creativeDivId}),gptSlots:t.gptSlots.map(function(t){return t.creativeDivId}),hbTimeout:t.hbTimeout,breakpointName:t.breakpointName},JSON.stringify(t)))),this.settings.isYandexEnabled()?(n=this.settings.getYandexBlockId())?(this.logger.log("[AUCTION][".concat(r,"]: Run Yandex with blockId ").concat(n)),window.yaContextCb.push(function(){e.gptSlots.forEach(function(t){var e=t.creativeDivId,t=t.slotTemplate.id,t=Number(t.substring(7)+e.substring(e.lastIndexOf("-")+1));o.logger.log("[AUCTION][".concat(r,"][").concat(e,"]: Set pageNumber ").concat(t)),Ya.Context.AdvManager.render({renderTo:"".concat(e),blockId:n,pageNumber:t,onRender:function(t){o.reporter.setStateStatus("yandex_unit_rendered")}})})})):this.logger.error("[AUCTION][".concat(r,"]: Cannot run Yandex cause yandexBlockId is not set")):(e.usePrebid&&ti.pushToPrebidQue(function(){var t=o.preparePrebidRequest(r,e.hbSlots);o.startPrebidAuction(r,t,e.hbTimeout)}),e.useUam&&(i=this.prepareUamRequest(r,e.hbSlots),this.startUamAuction(r,i)),t=e.usePrebid&&!this.auctionState.getAuctionStatus(r).prebidCancelled,i=e.useUam&&!this.auctionState.getAuctionStatus(r).uamCancelled,t||i?this.setAuctionTimeout(e.hbTimeout,r):this.startGptOnlyAuction(r,s))},C.prototype.reportOnLoadEvent=function(t){t=t.slot.getSlotElementId();this.auctionState.onGptSlotLoaded(t)},C.prototype.reportSlotResponseReceived=function(t){t=t.slot.getSlotElementId();this.auctionState.onGptResponse(t)},C.prototype.reportOnRenderEndedEvent=function(t){var e=!t.isEmpty,i=t.slot.getSlotElementId(),t=(this.logger.debug("[AUCTION]: ".concat(i," render event details: ").concat(JSON.stringify(t))),this.fuseSlotRegistry.getSlot(i));t?(e?this.logger.info("[AUCTION]: Adserver responded with creative for ".concat(i)):(t={fuseSlotId:t.slotTemplate.id,fuseSlotCode:i,errorType:"MISSING_CREATIVE"},this.reporter.addSlotProblem(t),this.logger.warn("[AUCTION]: Adserver responded without creative for ".concat(i))),this.auctionState.onGptSlotRendered(i,e)):this.fuseSlotRegistry.isDeletedSlot(i)?(this.logger.info("[AUCTION]: Slot Render Ended Event fired for deleted unit ".concat(i)),this.auctionState.onGptSlotRendered(i,e)):this.logger.debug("[AUCTION]: SlotRenderEnded Event fired for non fuse units: ".concat(i,". HasCreative: ").concat(e))},C.prototype.getStateView=function(){return this.auctionState};var vi=C;function C(t,e,i,n,o,r,s){this.fuseSlotRegistry=t,this.prebidGlobal=e,this.uam=i,this.logger=n,this.reporter=o,this.settings=r,this.touchObserver=s,this.firstPrebidRequest=!1,this.firstUamRequest=!1,this.firstPrebidResponse=!1,this.firstUamResponse=!1,this.auctionState=new Si(n,o)}T.prototype.registerAndQueue=function(t,e,i){t=this.domProcessor.processSlots(t),t=this.fuseSlotRegistry.register(t,i,e,this.runAuctionFn),i=t.filter(function(t){return t.initialisedActive});return this.auctionScheduler.queueSlots(i),t},T.prototype.registerAndRunAuction=function(t,e,i){t=this.registerAndQueue(t,e,i);return this.runAuction(),t},T.prototype.registerZoneAndQueue=function(t,e,i,n){t=this.domProcessor.processZoneWithDivId(t,e);if(!t)return null;e=this.fuseSlotRegistry.register([t],n,i,this.runAuctionFn)[0];return null!=e&&e.initialisedActive&&this.auctionScheduler.queueSlots([e]),e},T.prototype.registerAndQueueLastSlotWithFuseId=function(t,e,i,n){t=this.domProcessor.processLastSlotWithFuseId(t,e);if(t)return e=this.fuseSlotRegistry.register([t],n,i,this.runAuctionFn)[0],e&&e.initialisedActive&&this.auctionScheduler.queueSlots([e]),e},T.prototype.registerAndQueueWithFuseId=function(t,e,i,n){t=this.domProcessor.processSlotsWithFuseId(t,e),e=this.fuseSlotRegistry.register(t,n,i,this.runAuctionFn),t=e.filter(function(t){return t.initialisedActive});return this.auctionScheduler.queueSlots(t),e},T.prototype.runAuction=function(){return this.isTagInitialised()?this.auctionScheduler.runAuction():(this.logger.info("[CONTROLLER] Deferred the auction start until the tag is initialised"),!(this.wasPreInitAuctionDeferred=!0))},T.prototype.runDeferredAuctionIfRequired=function(){this.wasPreInitAuctionDeferred&&(this.logger.info("[CONTROLLER]: Running deferred auction now that tag is initialised"),this.runAuction())},T.prototype.forceRunAuction=function(t){var e=this.fuseSlotRegistry.getSlot(t);e?this.auctionScheduler.forceRunAuction(e):this.logger.warn("[CONTROLLER]: Could not force auction because slot ".concat(t," not found"))},T.prototype.runAuctionAllActiveSlots=function(){this.auctionScheduler.queueSlots(this.fuseSlotRegistry.getActiveSlots()),this.runAuction()},T.prototype.reset=function(){this.logger.log("[CONTROLLER]: resetSlots()"),this.settings.isDomObserverMode()?this.logger.log("[CONTROLLER]: resetSlots() using DomObserver"):(this.fuseSlotRegistry.reset(),this.auctionScheduler.reset()),this.wasPreInitAuctionDeferred=!1},T.prototype.clearRefreshIntervals=function(){this.auctionScheduler.clearRefreshIntervals()},T.prototype.getRefreshIntervals=function(){return this.auctionScheduler.getRefreshIntervals()},T.prototype.configureResponsive=function(){var n=this;ke(function(t,e,i){t?n.logger.log("[CONTROLLER]: Window resized to ".concat(i," which crossed a breakpoint: New breakpoint is ").concat(e)):n.logger.debug("[CONTROLLER]: Window resized to ".concat(i,", but the current breakpoint (").concat(e,") was unchanged"))}),ke(function(t,e){t&&(n.logger.log("[CONTROLLER]: Breakpoint changed to ".concat(e,". Cleared pending auctions, refreshes, next-auction requirements. All active slots will re-auction now.")),n.auctionScheduler.clearPendingAuctions(),n.auctionScheduler.clearAuctionBlock(),n.auctionScheduler.clearRefreshIntervals(),t=n.fuseSlotRegistry.getActiveSlots(),n.auctionScheduler.queueSlots(t),n.auctionScheduler.runAuction())})},T.prototype.loadSlots=function(t,e,i){if(!t.initialised)return this.logger.warn("[CONTROLLER]: loadSlots() called during initialisation. Translating call to registerSlots() to avoid reset"),void this.registerAndRunAuction(!0,!1,e);i(),this.registerAndQueue(!1,!1,e),this.runAuction()};var Ii=T;function T(t,e,i,n,o,r){var s=this;this.fuseSlotRegistry=t,this.logger=e,this.auctionScheduler=i,this.settings=n,this.domProcessor=o,this.isTagInitialised=r,this.wasPreInitAuctionDeferred=!1,this.runAuctionFn=function(t){s.auctionScheduler.queueSlots(t),s.runAuction()}}A.prototype.queueSlots=function(t){var e,i=this,n=this.getCurrentBreakpointName(),t=t.filter(function(t){return i.settings.isSlotEnabledForBreakpoint(t.slotTemplate.id,n)?t.currentlyActive?i.isScheduled(t)?(i.logger.debug("[SCHEDULER]: Skipped ".concat(t.creativeDivId," because it is already scheduled")),!1):!i.isRefreshDisabled(t.creativeDivId)||(i.logger.debug("[SCHEDULER]: Skipped ".concat(t.creativeDivId," because it is disabled")),!1):(i.logger.info("[SCHEDULER]: Skipped ".concat(t.creativeDivId," because it is hasn't activated")),!1):(i.logger.debug("[SCHEDULER]: Skipped ".concat(t.creativeDivId," because no sizes mapped at the current breakpoint (").concat(n,")")),!1)});0<t.length&&(e=t.map(function(t){return t.creativeDivId}),this.logger.info("[SCHEDULER]: Added ".concat(e," to auction queue")),t.forEach(function(t){return i.queuedSlots.push(t)}))},A.prototype.isScheduled=function(e){return 0<this.queuedSlots.filter(function(t){return t.creativeDivId===e.creativeDivId}).length},A.prototype.isTemplateScheduled=function(e){return 0<this.queuedSlots.filter(function(t){return t.slotTemplate.id===e}).length},A.prototype.isRefreshDisabled=function(e){return 0<this.disabledSlots.filter(function(t){return t===e}).length},A.prototype.purgeDeletedFromQueue=function(){var e=this;this.queuedSlots=this.queuedSlots.filter(function(t){return!e.isDeletedSlot(t.creativeDivId)||(e.logger.info("[SCHEDULER]: Removed deleted slot ".concat(t.creativeDivId," from queue")),!1)})},A.prototype.runAuction=function(){if(this.purgeDeletedFromQueue(),0===this.queuedSlots.length)return this.logger.log("[SCHEDULER]: Auction will not run because no slots are queued"),[];var t,e=this.getMissingAuctionBlockSlots();if(0<e.length){if(this.auctionBlockTimeoutHandle)return t=this.queuedSlots.map(function(t){return t.creativeDivId}),this.logger.info("[SCHEDULER] Deferred the auction for ".concat(JSON.stringify(t)," because slots missing from the auction block: ").concat(JSON.stringify(e))),this.auctionBlockTriggered=!0,[]}else this.auctionBlockTimeoutHandle&&(this.logger.info("[SCHEDULER]: Auction block cleared, as requirements satisfied "),this.clearAuctionBlock());this.settings.isRefreshCountFromLoaded()||this.scheduleRefreshTimers();var i=this.planAuction(this.queuedSlots);return this.queuedSlots=this.queuedSlots.filter(function(t){return-1===i.gptSlots.indexOf(t)}),this.logger.log("[SCHEDULER]: Starting auction with ".concat(i.gptSlots.length," slots, ").concat(this.queuedSlots.length," slots remaining")),this.startAuction(i),i.gptSlots.map(function(t){return t.creativeDivId})},A.prototype.forceRunAuction=function(t){var e=this.planAuction([t]);this.logger.log("[SCHEDULER][".concat(e.auctionId,"]: Forcing auction for ").concat(t.creativeDivId)),this.startAuction(e)},A.prototype.disableSlotRefresh=function(e){this.disabledSlots=this.disabledSlots.filter(function(t){return t!==e}).concat(e)},A.prototype.enableSlotRefresh=function(e){this.disabledSlots=this.disabledSlots.filter(function(t){return t!==e})},A.prototype.handleOnSlotOutcome=function(t,e,i){i!==bi.GPT_RENDERED||this.triggeredAuctions[t]||(this.triggeredAuctions[t]=!0,0<this.queuedSlots.length&&(this.logger.debug("[SCHEDULER][".concat(t,"]: The first slot has received a render event, initiating the next auction")),this.runAuction())),i===bi.GPT_LOADED&&this.settings.isRefreshCountFromLoaded()&&this.scheduleRefreshTimer(e)},A.prototype.startAuction=function(i){var n=this;this.anyAuctionExecuted=!0,this.executeAuction(i,function(){},function(t,e){return n.handleOnSlotOutcome(i.auctionId,t,e)})},A.prototype.scheduleRefreshTimers=function(){var e=this;this.queuedSlots.forEach(function(t){e.scheduleRefreshTimer(t)})},A.prototype.scheduleRefreshTimer=function(t){this.scheduledRefresh[t.creativeDivId]||(this.scheduledRefresh[t.creativeDivId]=!0,this.setRefreshTimer(t))},A.prototype.getRefreshIntervals=function(){return JSON.parse(JSON.stringify(this.refreshTimers))},A.prototype.getRefreshingCodes=function(){return Object.keys(this.refreshTimers)},A.prototype.clearRefreshIntervals=function(){var e=this;Object.keys(this.refreshTimers).forEach(function(t){e.logger.debug("[REFRESH]: Clearing refresh timer for ".concat(t)),clearInterval(e.refreshTimers[t])}),this.refreshTimers={}},A.prototype.reset=function(){this.clearRefreshIntervals(),this.clearAuctionBlock(),this.refreshCounts={},this.scheduledRefresh={},this.queuedSlots=[]},A.prototype.clearPendingAuctions=function(){this.queuedSlots=[]},A.prototype.setRefreshTimer=function(t){var e,i=t.slotTemplate.attributes.refresh,n=t.creativeDivId;"number"==typeof(e=i)&&e==e&&0<i?(this.logger.log("[SCHEDULER]: Setting custom refresh time of ".concat(i," seconds for ").concat(n)),this.addRefreshInterval(t,i)):0===i?this.logger.log("[SCHEDULER]: No refresh timer set for ".concat(n)):(e=this.settings.getDefaultRefreshInterval())&&0<e?(this.logger.log("[SCHEDULER]: Setting default refresh time of ".concat(e," seconds for ").concat(n)),this.addRefreshInterval(t,e)):this.logger.debug("[SCHEDULER]: No default refresh timer exists in account settings.")},A.prototype.isSkipRefreshInEdgeBrowser=function(t){this.refreshCounts[t.creativeDivId]=this.refreshCounts[t.creativeDivId]||0;var e=this.refreshCounts[t.creativeDivId]>this.settings.getEdgeHtmlMaxAdsRefreshLimit();return(e||!this.browserWindow.document.hasFocus())&&(this.logger.log((e?'will skip refreshing ad(code: "'.concat(t.creativeDivId,'") as it reached Edge browser ads refresh limit of ').concat(this.settings.getEdgeHtmlMaxAdsRefreshLimit()," at the moment - "):"will skip refreshing ad as browser page/tab is NOT active at the moment - ").concat((new Date).toISOString(),".")),!0)},A.prototype.refreshCallback=function(t){kt.isEdgeBrowser(this.browserWindow)&&this.isSkipRefreshInEdgeBrowser(t)||(this.browserWindow.document.getElementById(t.creativeDivId)?t.element&&t.isInView(this.browserWindow)?(kt.isEdgeBrowser(this.browserWindow)&&(this.refreshCounts[t.creativeDivId]+=1),this.queueSlots([t]),this.runAuction()):this.logger.debug("[SCHEDULER]: Not refreshing ".concat(t.creativeDivId," because it is not in view")):this.logger.warn("[AUCTION]: Could not refresh ".concat(t.creativeDivId," because a div with that id was not found in the DOM")))},A.prototype.addRefreshInterval=function(t,e){var i=this;this.refreshTimers[t.creativeDivId]&&(this.logger.warn("[SCHEDULER]: Refresh timer already set for ".concat(t.creativeDivId)),clearInterval(this.refreshTimers[t.creativeDivId])),this.refreshTimers[t.creativeDivId]=setInterval(function(){i.refreshCallback(t)},1e3*e)},A.prototype.setAuctionBlock=function(t,e){var i=this;this.auctionBlockSlots=t.filter(function(t){var e=i.settings.getSlotTemplate(t);if(!e)return i.logger.warn("[SLOTS][".concat(t,"]: Excluded from next-auction slot requirement, because the slot does not exist in this tag")),!1;if(e.conditionConfig)return i.logger.warn("[SLOTS][".concat(t,"]: Excluded from next-auction slot requirement, because the slot has an activation condition")),!1;e=i.getCurrentBreakpointName();return!!i.settings.isSlotEnabledForBreakpoint(t,e)||(i.logger.info("[SLOTS][".concat(t,"]: Excluded from next-auction slot requirement, because it is not enabled at the ").concat(e," breakpoint")),!1)}),0<this.auctionBlockSlots.length?(this.logger.info("[SCHEDULER]: Enabled auction block. Will not proceed until Zones with FuseIds ".concat(JSON.stringify(this.auctionBlockSlots)," are registered, or ").concat(e,"ms have elapsed")),this.auctionBlockTimeoutHandle=setTimeout(function(){i.auctionBlockTriggered?(i.logger.warn("[SCHEDULER]: Auction block timeout reached, missing: ".concat(JSON.stringify(i.getMissingAuctionBlockSlots()),". Running deferred auction")),i.clearAuctionBlock(),i.runAuction()):(0<i.getMissingAuctionBlockSlots().length&&i.logger.warn("[SCHEDULER]: Auction block timeout reached, missing: ".concat(i.getMissingAuctionBlockSlots())),i.clearAuctionBlock())},e)):this.logger.info("[SCHEDULER]: Did not enable AuctionBlock, because no (valid) slots specified")},A.prototype.getMissingAuctionBlockSlots=function(){var e=this;return this.auctionBlockSlots.filter(function(t){return!e.isTemplateScheduled(t)})},A.prototype.inAnyAuctionExecuted=function(){return this.anyAuctionExecuted},A.prototype.clearAuctionBlock=function(){this.auctionBlockSlots=[],this.auctionBlockTriggered=null,clearTimeout(this.auctionBlockTimeoutHandle),this.auctionBlockTimeoutHandle=null};var Ei=A;function A(t,e,i,n,o,r,s){this.logger=t,this.browserWindow=e,this.executeAuction=i,this.planAuction=n,this.isDeletedSlot=o,this.getCurrentBreakpointName=r,this.settings=s,this.refreshTimers={},this.refreshCounts={},this.scheduledRefresh={},this.disabledSlots=[],this.queuedSlots=[],this.triggeredAuctions={},this.auctionBlockSlots=[],this.anyAuctionExecuted=!1}var Ci="CMP_DETERMINED",Ti="INIT_READY",Ai=(w.prototype.isReadyForInit=function(){var e=this.getInitStatus();return 0===Object.keys(e).filter(function(t){return null===e[t]||void 0===e[t]||!e[t]}).length},w.prototype.getInitStatus=function(){return{cmpOk:!this.settings.isCmpRequired()||this.isCmpDetermined(),docReady:this.isDocReady(),anyBidLibraryReady:this.isAnyBidLibraryReady()}},w.prototype.checkAndTrigger=function(){l(this.firedCmpDetermined)&&this.isCmpDetermined()&&(this.firedCmpDetermined=this.reporter.getElapsedTime(),this.cmpDeterminedEmitter.emit(Ci)),l(this.firedInitReady)&&this.isReadyForInit()&&(clearInterval(this.initInterval),this.reporter.setStateStatus("initmanager_fired_auction_ready"),this.firedInitReady=this.reporter.getElapsedTime(),this.initReadyEmitter.emit(Ti))},w.prototype.isDocReady=function(){return!this.settings.isScanDOMOnPageLoad()||this.state.doc_ready},w.prototype.setDocReady=function(){this.state.doc_ready=!0,this.checkAndTrigger()},w.prototype.isCmpDetermined=function(){return!l(this.state.cmp.load_wait_finish_millis)},w.prototype.isCmpTimeout=function(){var t=this.state.cmp.load_wait_start_millis;return!!t&&this.reporter.getElapsedTime()-t>this.settings.getGdprTimeoutMillis()},w.prototype.cmpLoadWaitStart=function(){this.state.cmp.load_wait_start_millis=this.reporter.getElapsedTime(),this.checkAndTrigger()},w.prototype.setCmpDetermined=function(){this.logger.debug("[INITMANAGER]: setPersonalisationDetermined()"),this.state.cmp.load_wait_finish_millis=this.reporter.getElapsedTime(),this.checkAndTrigger()},w.prototype.setPrebidLoadStart=function(){this.state.prebid_load_start=this.reporter.getElapsedTime(),this.checkAndTrigger()},w.prototype.isPrebidLoadStarted=function(){return null!==this.state.prebid_load_start},w.prototype.setPrebidReady=function(){this.state.prebid_ready=!0,this.checkAndTrigger()},w.prototype.isPrebidReady=function(){return this.state.prebid_ready},w.prototype.setPrebidAutoScanRegistrationsComplete=function(){this.state.prebid_autoscan_registrations_complete=this.reporter.getElapsedTime(),this.checkAndTrigger()},w.prototype.isPrebidAutoScanRegistrationsComplete=function(){return this.state.prebid_autoscan_registrations_complete},w.prototype.isGptReady=function(){return this.state.gpt_ready},w.prototype.setGptReady=function(){this.state.gpt_ready=!0,this.checkAndTrigger()},w.prototype.isYandexReady=function(){return this.state.yandex_ready},w.prototype.setYandexReady=function(){this.state.yandex_ready=!0,this.checkAndTrigger()},w.prototype.setGptAutoScanRegistrationsComplete=function(){this.state.gpt_autoscan_registrations_complete=this.reporter.getElapsedTime(),this.checkAndTrigger()},w.prototype.isGptAutoScanRegistrationsComplete=function(){return this.state.gpt_autoscan_registrations_complete},w.prototype.isUamReady=function(){return this.state.uam_ready},w.prototype.setUamReady=function(){this.state.uam_ready=!0,this.checkAndTrigger()},w.prototype.setUamLoadStart=function(){this.state.uam_load_start=this.reporter.getElapsedTime(),this.checkAndTrigger()},w.prototype.isUamLoadStarted=function(){return null!==this.state.uam_load_start},w.prototype.isAnyBidLibraryReady=function(){return this.settings.isYandexEnabled()?this.isYandexReady():null!==this.isPrebidAutoScanRegistrationsComplete()||null!==this.isGptAutoScanRegistrationsComplete()||this.isUamReady()},w.prototype.setTagInitialised=function(){this.state.tag_initialised=!0},w.prototype.isTagInitialised=function(){return this.state.tag_initialised},w.prototype.addInitReadyListener=function(t){this.initReadyEmitter.isTriggered(Ti)?(this.logger.debug("[EVENT][".concat(Ti,"]: Already triggered, invoking callback synchronously")),t()):this.initReadyEmitter.once(Ti,t)},w.prototype.addCmpDeterminedListener=function(t){this.cmpDeterminedEmitter.isTriggered(Ci)?(this.logger.debug("[EVENT][".concat(Ci,"]: Already triggered, invoking callback synchronously")),t()):this.cmpDeterminedEmitter.once(Ci,t)},w);function w(t,e,i){var n=this;this.logger=t,this.reporter=e,this.settings=i,this.state={cmp:{last_report:null,load_wait_start_millis:null,load_wait_finish_millis:null},prebid_load_start:null,uam_load_start:null,prebid_ready:!1,gpt_ready:!1,uam_ready:!1,doc_ready:!1,gpt_autoscan_registrations_complete:null,prebid_autoscan_registrations_complete:null,tag_initialised:!1,yandex_ready:!1},this.firedInitReady=null,this.firedCmpDetermined=null,this.initInterval=setInterval(function(){return n.checkAndTrigger()},100),this.cmpDeterminedEmitter=new ei([Ci],this.logger),this.initReadyEmitter=new ei([Ti],this.logger)}function wi(){}wi.prototype.getInitManager=function(){return this.initManager||(this.initManager=new Ai(c.getLogger(),c.getReporter(),u)),this.initManager};var _i=new wi,xi=(Ri.prototype.code=function(){return"1---"},Ri);function Ri(){}Oi.prototype.loadAmazonUam=function(i,n,t,e,o,r){var s;function a(t,e){n[i]._Q.push([t,e])}n[i]||(n[i]={init:function(){a("i",arguments)},fetchBids:function(){a("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]},(s=t.createElement(e)).async=!0,s.src=o,"function"==typeof r&&(s.readyState?s.onreadystatechange=function(){"loaded"!==s.readyState&&"complete"!==s.readyState||(s.onreadystatechange=null,r())}:s.onload=function(){r()}),(o=t.getElementsByTagName(e)[0]).parentNode.insertBefore(s,o))},Oi.prototype.load=function(t){var e=this;if(this.logger.debug("[UAM]: Loading script"),this.reporter.setStateStatus("uam_script_load_start"),this.initManager.setUamLoadStart(),this.loadAmazonUam("apstag",this.browserWindow,this.browserWindow.document,"script","//c.amazon-adsystem.com/aax2/apstag.js",function(){e.reporter.setStateStatus("uam_script_load_finish"),e.init(t)}),!this.browserWindow.apstag)return this.logger.error("[INIT]: UAM script load failed.")},Oi.prototype.init=function(t){var e=this;this.reporter.setStateStatus("uam_initialise_start"),this.browserWindow.apstag.init(this.getUamConfig(t),function(){e.logger.info("[UAM]: Initialisation finished"),e.reporter.setStateStatus("uam_initialise_finish"),e.initManager.setUamReady()})},Oi.prototype.getUamConfig=function(t){var e={pubID:this.pubId,adServer:this.adServer};return t||(e.gdpr={cmpTimeout:0}),!l(this.sco)&&Object.getOwnPropertyNames(this.sco).length&&(e.schain={ver:"1.0",complete:1,nodes:[{asi:this.sco.asi,sid:this.sco.sellerId,hp:1}]}),e},Oi.prototype.makeBids=function(t,e){var i=this;this.browserWindow.apstag.fetchBids({slots:t},function(t){i.gptPushFn(function(){i.browserWindow.apstag.setDisplayBids(),e(t)})})};var ki=Oi;function Oi(t,e,i,n,o,r,s,a,c){this.pubId=t,this.adServer=e,this.logger=i,this.browserWindow=n,this.consentManager=o,this.reporter=r,this.initManager=s,this.gptPushFn=a,this.sco=c}Di.prototype.load=function(){this.reporter.setStateStatus("cmp_load_quantcast_start");var t=new XMLHttpRequest,e=this.browserWindow.document.location.hostname,i=this.browserWindow.document.createElement("script"),n=this.browserWindow.document.getElementsByTagName("script")[0],o=this.browserWindow.document.getElementsByTagName("head")[0]||this.browserWindow.document.documentElement,r="https://quantcast.mgr.consensu.org".concat("/choice/","PRrmquD1Ggcb1","/",e,"/choice.js");t.onreadystatechange=function(){var t;4===this.readyState&&(i.async=!0,i.type="text/javascript",200===this.status?i.src=r:(t="https://quantcast.mgr.consensu.org".concat("/choice.js"),i.src=t,r=t),n&&n.parentNode?n.parentNode.insertBefore(i,n):(console.debug("First script element not fully initialised, falling back to head-based insertion"),o.insertBefore(i,o.firstChild)))},t.open("GET",r,!0),t.send()};var Pi=Di;function Di(t,e){this.browserWindow=t,this.reporter=e}Ni.prototype.generate=function(){this.createStubFunctionV2()},Ni.prototype.createStubFunctionV2=function(){var r=this;r.logger.debug("[CMP]: Generating V2 stub");for(var t,o="__tcfapiLocator",i=[],s=r.browserWindow,e=function t(){var e,i=s.document,n=!!s.frames[o];return n?r.logger.debug("[CMP] Found existing version 2 stub"):(r.logger.debug("[CMP] Version 2 stub not found - generating"),i.body?((e=i.createElement("iframe")).style.cssText="display:none",e.name=o,i.body.appendChild(e)):setTimeout(t,25)),!n},n=s;n;){try{if(n.frames[o]){t=n,r.logger.debug("[CMP] Found locator frame");break}}catch(t){"{}"!==JSON.stringify(t)&&r.logger.log("[CMP]:",JSON.stringify(t))}if(n===r.browserWindow.top)break;n=n.parent}t||(r.logger.debug("[CMP] Locator frame not found"),e(),s.__tcfapi=function(){var t,e=arguments;if(!e.length)return i;"setGdprApplies"===e[0]?3<e.length&&2===e[2]&&"boolean"==typeof e[3]&&(t=e[3],"function"==typeof e[2]&&e[2]("set",!0)):"ping"===e[0]?"function"==typeof e[2]&&e[2]({gdprApplies:t,cmpLoaded:!1,cmpStatus:"stub"}):i.push(e)},s.addEventListener("message",function(i){var n="string"==typeof i.data,t={};try{t=n?JSON.parse(i.data):i.data}catch(t){"{}"!==JSON.stringify(t)&&r.logger.error("[CMP]:",JSON.stringify(t))}var o=t.__tcfapiCall;o&&r.browserWindow.__tcfapi(o.command,o.version,function(t,e){t={__tcfapiReturn:{returnValue:t,success:e,callId:o.callId}};n?i.source.postMessage(JSON.stringify(t),"*"):i.source.postMessage(t,"*")},o.parameter)},!1))};var Li=Ni;function Ni(t,e){this.logger=t,this.browserWindow=e}Fi.prototype.checkForCCPA=function(i){var n=this;this.browserWindow.__uspapi("uspPing",1,function(t,e){e&&t.mode.includes("USP")&&t.jurisdiction.includes(t.location.toUpperCase())?(n.logger.log("[CMP-V2]: CCPA Region"),n.browserWindow.__uspapi("setUspDftData",1,function(t,e){n.logger.log("[CMP-V2]: Setting up data for USP API",JSON.stringify(t),e),n.browserWindow.__uspapi("getUSPData",1,function(t,e){if(!e)return n.logger.log("[CMP-V2]: Failed retrieving USP data use default instead"),i({applies:!0,privacyString:"1---"});i({applies:!0,privacyString:t.uspString})})})):i({applies:!1})})},Fi.prototype.setGDPRConsentPrompt=function(){var t=this;this.consentUIPrompt.setup("Privacy Settings",function(){t.browserWindow.__tcfapi("displayConsentUi",2,function(){return t.logger.log("[CMP-V2]: GDPR Consent UI displayed")})})},Fi.prototype.setCCPAConsentPrompt=function(){var t=this;this.consentUIPrompt.setup("Do Not Sell My Data",function(){t.browserWindow.__uspapi("displayUspUi")})},Fi.prototype.cmpLoaded=function(e){var i=!1;setTimeout(function(){if(!i)return e(!1)},1e3),this.browserWindow.__tcfapi("ping",2,function(t){return i=!0,t&&t.cmpLoaded?e(!0):e(!1)})},Fi.prototype.getConsentData=function(i){var n=this;this.browserWindow.__tcfapi("getTCData",2,function(t,e){return n.callCount++,e&&t?l(t.gdprApplies)||"loading"===(null==t?void 0:t.cmpStatus.toLowerCase())?i({dataAvailable:!0,gdprApplies:void 0,cmpStatus:null==t?void 0:t.cmpStatus,eventStatus:null==t?void 0:t.eventStatus}):!1===t.gdprApplies?i({dataAvailable:!0,gdprApplies:!1,cmpStatus:null==t?void 0:t.cmpStatus,eventStatus:null==t?void 0:t.eventStatus}):!0===t.gdprApplies?n.handleGdprApplies(t,i):void n.logger.warn("[CMP-V2]: Unexpected gdprApplies status. Data: ".concat(JSON.stringify(t))):i({dataAvailable:!1,cmpStatus:null==t?void 0:t.cmpStatus,eventStatus:null==t?void 0:t.eventStatus})})},Fi.prototype.handleGdprApplies=function(t,e){var i,n,o,r,s=t.eventStatus.toLowerCase();return"useractioncomplete"===s||"tcloaded"===s?(i=(null==(i=null==(i=t.purpose)?void 0:i.consents)?void 0:i[2])||(null==(i=t.purposeConsents)?void 0:i[2]),n=(null==(n=null==(n=t.purpose)?void 0:n.consents)?void 0:n[3])||(null==(n=t.purposeConsents)?void 0:n[3]),o=!l(i),r=!l(n),r=(o=o&&r)&&i&&n,this.logger.debug("[CMP-V2]: Purposes available: ".concat(o,", Consent: ").concat(r," Data: ").concat(JSON.stringify(t))),e({dataAvailable:!0,gdprChoiceReceived:!0,personalisedAdsConsent:r,gdprApplies:!0,cmpStatus:null==t?void 0:t.cmpStatus,eventStatus:null==t?void 0:t.eventStatus})):("cmpuishown"===s||this.callCount%8==0&&this.logger.warn("[CMP-V2]: Unexpected eventStatus. Data: ".concat(JSON.stringify(t))),e({dataAvailable:!0,gdprChoiceReceived:!1,gdprApplies:!0,cmpStatus:null==t?void 0:t.cmpStatus,eventStatus:null==t?void 0:t.eventStatus}))},Fi.prototype.createUspStub=function(){function e(){var t=arguments;st(o.__uspapi)!==e?setTimeout(function(){void 0!==o.__uspapi&&o.__uspapi.apply(o.__uspapi,t)},400):(n.warn("[CMP-V2] USP is still in stub mode. Calling to ".concat(t[0]," API will be unsuccessful")),"function"==typeof t[2]&&t[2](void 0,!1))}var t,i=this,n=this.logger,o=this.browserWindow;void 0===o.__uspapi&&(o.__uspapi=e,t=setInterval(function(){i.uspTries++,o.__uspapi!==e?(n.warn("[CMP-V2]: USP stub function has been replaced"),clearInterval(t)):i.uspTries<i.uspTriesLimit?n.warn("[CMP-V2]: USP stub function has NOT been replaced, will retry"):(n.warn("[CMP-V2]: USP stub function has NOT been replaced, but the timeout has been reached"),clearInterval(t))},300))};var Mi=Fi;function Fi(t,e,i){this.logger=t,this.consentUIPrompt=i,this.uspTries=0,this.uspTriesLimit=3,this.callCount=-1,this.browserWindow=e,this.createUspStub()}_.prototype.isAllowPersonalisation=function(){return!u.isCmpRequired()||(null!==this.allowPersonalisation?this.allowPersonalisation:!u.isStrictCmp())},_.prototype.generateStubs=function(){this.stubFunctionsGenerator.generate()},_.prototype.loadVersion=function(){this.initManager.cmpLoadWaitStart(),this.reporter.setStateStatus("cmp_load_wait_start"),this.logger.info("[CMP]: Wait for CMP to load"),this.checkForVersion2()},_.prototype.versionLoader=function(t){var e=this,i=t.found,t=t.versionNumber;null===this.version&&(i?2===t?(this.reporter.setStateStatus("cmp_load_wait_finish"),this.logger.debug("[CMP]: Loaded version ".concat(t)),this.version=new Mi(this.logger,this.browserWindow,this.consentUIPrompt),this.handleCmpLoaded()):(this.logger.warn("[CMP]: Version ".concat(t," is not supported, disabling personalisation")),this.allowPersonalisation=!1,this.initManager.setCmpDetermined()):(++this.cmpLoadCounter%10==0&&this.logger.debug("[CMP] Waiting for load"),setTimeout(function(){return e.checkForVersion2()},50)))},_.prototype.checkForVersion2=function(){var e=this;this.browserWindow.__tcfapi("ping",null,function(t){e.versionLoader({found:t.cmpLoaded,versionNumber:2})})},_.prototype.checkForCCPA=function(t){this.version.checkForCCPA(t)},_.prototype.isCmpLoaded=function(){return null!==this.version},_.prototype.cmpLoaded=function(t){if(this.logger.log("[CMP]: Check if loaded"),null===this.version)return t(!1);this.version.cmpLoaded(t)},_.prototype.getConsentData=function(t){this.version.getConsentData(t)},_.prototype.setGDPRConsentPrompt=function(){this.version.setGDPRConsentPrompt()},_.prototype.setCCPAConsentPrompt=function(){this.version.setCCPAConsentPrompt()},_.prototype.setNonPrivacyRegionsPrompt=function(){this.consentUIPrompt.setup("You are outside the CCPA jurisdiction.")},_.prototype.handleGdprNotApplies=function(){var i,n=this,o=(this.logger.info("[CMP]: GDPR does not apply"),!1);setTimeout(function(){o||(n.reporter.setStateStatus("cmp_check_for_ccpa_timeout"),n.logger.warn("[CMP]: USP API is not responding, continue as if not in CCPA region"),o=!0,n.allowPersonalisation=!0,n.initManager.setCmpDetermined())},1),this.reporter.setStateStatus("cmp_check_for_ccpa_start"),this.checkForCCPA(function(t){var e=t.applies,t=t.privacyString;n.reporter.setStateStatus("cmp_check_for_ccpa_finish"),e?(n.setCCPAConsentPrompt(),i="Y"===t[2].toUpperCase(),n.logger.info("[CMP]: CCPA applies. disablePersonalisation: ".concat(i)),n.cmpRegion=2,n.allowPersonalisation=!i):(n.logger.info("[CMP]: Not in CCPA region, continue with personalisation"),n.setNonPrivacyRegionsPrompt(),n.cmpRegion=0,n.allowPersonalisation=!0),o||(o=!0,n.initManager.setCmpDetermined())})},_.prototype.handleGdprApplies=function(){var o,r,s=this,a=(this.logger.log("[CMP]: GDPR applies, checking if personalisation is allowed"),this.cmpRegion=1,this.reporter.setStateStatus("cmp_gdpr_choice_wait_start"),!1);this.getConsentData(function(t){var e=t.gdprChoiceReceived,t=t.personalisedAdsConsent;e&&(a=!0,s.reporter.setStateStatus("cmp_gdpr_choice_wait_finish"),s.logger.info("[CMP]: GDPR decision received via short-circuit. Allow personalisation: ".concat(t)),s.allowPersonalisation=t,s.initManager.setCmpDetermined())}),a||(o=0,this.setGDPRConsentPrompt(),r=setInterval(function(){s.getConsentData(function(t){var e=t.gdprChoiceReceived,i=t.personalisedAdsConsent,n=t.cmpStatus,t=t.eventStatus;e?(a=!0,s.reporter.setStateStatus("cmp_gdpr_choice_wait_finish"),s.logger.info("[CMP]: GDPR decision received. Allow personalisation: ".concat(i)),clearInterval(r),s.allowPersonalisation=i,s.initManager.setCmpDetermined()):++o%10==0&&s.logger.info("[CMP]: Waiting for GDPR personalisation choice. cmpStatus: ".concat(n,", eventStatus: ").concat(t))})},100))},_.prototype.handleCmpLoaded=function(){function o(t){r.reporter.setStateStatus("cmp_gdpr_applies_check_finish"),!1===t?r.handleGdprNotApplies():u.isRequestGdprPersonalisation()?r.handleGdprApplies():(r.reporter.setStateStatus("cmp_gdpr_choice_wait_finish"),r.logger.info("[CMP]: The GDPR applies, but we will assume they do not allow personalisation"),r.cmpRegion=1,r.allowPersonalisation=!1,r.initManager.setCmpDetermined())}var r=this;this.logger.info("[CMP]: Checking if the GDPR applies"),this.reporter.setStateStatus("cmp_gdpr_applies_check_start");this.getConsentData(function(t){var e,i,n,t=t.gdprApplies;l(t)?(e=0,r.logger.debug("[CMP]: Setting a check interval of ".concat(250,"ms")),i=!1,n=setInterval(function(){r.getConsentData(function(t){t=t.gdprApplies;l(t)?e++%4==0&&r.logger.info("[CMP]: Waiting for GDPR determination"):(clearInterval(n),i||(i=!0,o(t)))})},250)):(r.logger.debug("[CMP]: GDPR status already available, processing immediately"),o(t))})};var Ui=_;function _(t,e,i,n,o,r){this.logger=e,this.reporter=i,this.stubFunctionsGenerator=n,this.consentUIPrompt=o,this.initManager=r,this.version=null,this.allowPersonalisation=null,this.cmpLoadCounter=0,this.cmpRegion=null,this.browserWindow=t}Gi.prototype.setup=function(t,e){var i,n=this.browserWindow.document.querySelector(this.domSelector);n&&(e?((i=document.createElement("a")).href="javascript:void(0)",i.id=this.elementId,i.innerHTML=t,i.addEventListener("click",e),n.appendChild(i)):n.textContent=t)};var Bi=Gi;function Gi(t,e,i){void 0===e&&(e="div[data-fuse-privacy-tool]"),void 0===i&&(i="fuse-privacy-tool"),this.browserWindow=t,this.domSelector=e,this.elementId=i}function zi(){}zi.prototype.getStubFunctionsGenerator=function(){return this.stubFunctionsGenerator||(this.stubFunctionsGenerator=new Li(c.getLogger(),a.getBrowserWindowObject())),this.stubFunctionsGenerator},zi.prototype.getConsentManger=function(){return this.consentManager||(this.consentManager=new Ui(a.getBrowserWindowObject(),c.getLogger(),c.getReporter(),this.getStubFunctionsGenerator(),new Bi(a.getBrowserWindowObject()),_i.getInitManager())),this.consentManager},zi.prototype.getQuantcastLoader=function(){return this.quantcastLoader||(this.quantcastLoader=new Pi(a.getBrowserWindowObject(),c.getReporter())),this.quantcastLoader};var Wi=new zi;function ji(){}ji.prototype.getCcpaPrivacyStringCoder=function(){return new xi},ji.prototype.getUamAdServer=function(){return"googletag"},ji.prototype.getSco=function(){return u.getSco()},ji.prototype.getUam=function(){return this.uam||(this.uam=new ki(u.getUamSettings().pubID,qi.getUamAdServer(),c.getLogger(),a.getBrowserWindowObject(),Wi.getConsentManger(),c.getReporter(),_i.getInitManager(),h,qi.getSco())),this.uam};var qi=new ji,Hi="AlwaysTrue",Vi="AlwaysFalse",Qi=(Yi.prototype.check=function(){return!0},Yi);function Yi(){}Ji.prototype.check=function(){return!1};var Ki=Ji;function Ji(){}Xi.prototype.check=function(){return this.conditions.reduce(function(t,e){return t&&e.checkCondition()},!0)};var Zi=Xi;function Xi(t){this.conditions=t}tn.prototype.check=function(){return this.conditions.reduce(function(t,e){return t||e.checkCondition()},!1)};var $i=tn;function tn(t){this.conditions=t}nn.prototype.checkCondition=function(){return this.checkConditionAndNotify(!1)},nn.prototype.checkConditionAndNotify=function(t){if(!this.satisfied){try{this.satisfied=this.condition.check(this.context,this.api)}catch(t){return this.logger.warn("[CONDITION][".concat(this.context,"]: Caught exception while checking condition"),t.stack),!1}this.satisfied&&t&&this.activatorCallback()}return this.satisfied},nn.prototype.destroyTriggers=function(){var i=this;this.condition instanceof Zi||this.condition instanceof $i?this.condition.conditions.forEach(function(t){return t.destroyTriggers()}):this.triggers.forEach(function(e){try{e.destroy()}catch(t){i.logger.warn("[CONDITION][".concat(i.context,"][").concat(e,"]: Caught exception while destroying trigger: "),t.stack)}})},nn.prototype.enableTriggers=function(t){var i=this;this.condition instanceof Zi||this.condition instanceof $i?this.condition.conditions.forEach(function(t){return t.enableTriggers(i.api)}):this.triggers.forEach(function(e){try{e.enable(t,function(){return i.checkConditionAndNotify(!0)})}catch(t){i.logger.warn("[CONDITION][".concat(i.context,"][").concat(e,"]: Caught exception while enabling trigger: "),t.stack)}})};var en=nn;function nn(t,e,i,n,o,r){this.context=t,this.condition=e,this.triggers=i,this.api=n,this.activatorCallback=o,this.logger=r,this.satisfied=!1}rn.prototype.enableTriggers=function(){this.rootCondition.enableTriggers(this.api)},rn.prototype.destroy=function(){this.rootCondition.destroyTriggers()},rn.prototype.checkCondition=function(){return this.rootCondition.checkCondition()},rn.prototype.checkAndFire=function(){this.firedCallback||this.rootCondition.checkCondition()&&(this.logger.info("[ACTIVATOR][".concat(this.context,"]: Conditions are satisfied. Destroying triggers and invoking callback")),this.rootCondition.destroyTriggers(),this.firedCallback=!0,this.onSatisfiedCB(this.context))};var on=rn;function rn(t,e,i,n,o){this.logger=t,this.context=e,this.rootCondition=i,this.api=n,this.onSatisfiedCB=o,this.firedCallback=!1}an.prototype.destroy=function(){},an.prototype.enable=function(t,e){ke(function(t){t||e()})};var sn=an;function an(){this.options={capture:!0,passive:!0}}ln.prototype.buildActivator=function(t,e,i,n){var t=this.buildCondition(e,t,i,function(){return o.checkAndFire()}),o=new on(this.logger,e,t,i,n);return o},ln.prototype.registerCondition=function(t,e){if(this.conditions[t])throw Error("Condition with ".concat(t," already registered"));this.conditions[t]=e},ln.prototype.registerTrigger=function(t,e){if(this.triggers[t])throw Error("Trigger with ".concat(t," already registered"));this.triggers[t]=e},ln.prototype.buildCondition=function(t,e,i,n){var o=e.type;switch(o){case"and":return this.buildBooleanCondition(t,e,i,n,function(t){return new Zi(t)});case"or":return this.buildBooleanCondition(t,e,i,n,function(t){return new $i(t)});case"trigger":return this.buildTriggerCondition(t,e,i,n);default:var r=o;throw new Error("exhaustiveCheck(".concat(r,") should not have been called"))}},ln.prototype.buildTriggerCondition=function(t,e,i,n){var o=this,r=this.conditions[e.conditionName];if(!r)return this.logger.error("[CONDITION-FACTORY]: Could not find condition ".concat(e.conditionName,", it will be deemed false")),this.buildAlwaysFalseCondition(t,i,n);r=r(e.conditionParams),e=e.triggers.map(function(t){var e=o.triggers[t.triggerName];return e?e(t.triggerParams):(o.logger.error("[CONDITION-FACTORY]: Could not find trigger with name ".concat(t.triggerName)),null)}).filter(function(t){return null!=t}).concat(new sn);return new en(t,r,e,i,n,this.logger)},ln.prototype.buildAlwaysFalseCondition=function(t,e,i){return new en(t,new Ki,[],e,i,this.logger)},ln.prototype.buildBooleanCondition=function(e,t,i,n,o){var r=this,t=t.subConditions;if(!t||0===t.length)return this.logger.error("[CONDITION-FACTORY]: Boolean condition with no sub-conditions"),this.buildAlwaysFalseCondition(e,i,n);o=o(t.map(function(t){return r.buildCondition(e,t,i,n)}));return new en(e,o,[],i,n,this.logger)};var cn=ln;function ln(t){this.logger=t,this.conditions={},this.triggers={}}var un="IntervalTrigger",dn=(gn.prototype.enable=function(t,e){this.intervalId=setInterval(function(){return e(t)},this.intervalMs)},gn.prototype.destroy=function(){clearInterval(this.intervalId)},gn);function gn(t){if(this.config=t,this.intervalMs=t.intervalMs,!this.intervalMs)throw Error("intervalMs not defined for IntervalTrigger")}var pn="DocumentStatus",hn=(fn.prototype.check=function(t,e){return-1!==this.state.indexOf(document.readyState)},fn);function fn(t){this.config=t,this.state=t.state}var bn="UrlRegex",mn=(yn.prototype.check=function(t,e){var i;return 0<(null==(i=window.location.toString().match(this.regex))?void 0:i.length)},yn);function yn(t){this.config=t,this.regex=t.regex}var Sn="PageCount",vn=(In.getCountKey=function(t){return"fuse-page-views-".concat(t)},In.getPageCount=function(t,e){return Number(e.sessionStorage.getItem(In.getCountKey(t))||0)},In.incrementPageCount=function(t,e){e.sessionStorage.setItem(In.getCountKey(t),"".concat(this.getPageCount(t,e)+1))},In.resetPageCount=function(t,e){e.sessionStorage.setItem(In.getCountKey(t),"0")},In.prototype.check=function(t,e){var i;return this.hasChecked||(In.incrementPageCount(t,e.getWindow()),this.hasChecked=!0,i=In.getPageCount(t,e.getWindow()),this.isOver=i>=this.pageCount,this.isOver&&In.resetPageCount(t,e.getWindow())),this.isOver},In);function In(t){this.config=t,this.hasChecked=!1,this.isOver=!1,this.pageCount=t.pageCount||1}var En="DomElementExists",Cn=(Tn.prototype.check=function(t,e){return null!==document.querySelector(this.selector)},Tn);function Tn(t){this.config=t,this.selector=t.selector}var An="AbsoluteScrollDistance",wn=(_n.prototype.check=function(t,e){return window.scrollY>=this.pixelsDistance},_n);function _n(t){this.config=t,this.pixelsDistance=Number(t.pixelsDistance)||0}var xn="DocumentStatusTrigger",Rn=(kn.prototype.destroy=function(){this.window.removeEventListener("readystatechange",this.triggeredCB)},kn.prototype.enable=function(t,e){this.window=t.getWindow(),this.triggeredCB=e,document.addEventListener("readystatechange",this.triggeredCB)},kn);function kn(){}var On="WindowHeightDistance",Pn=(Dn.prototype.check=function(t,e){return window.scrollY>=window.innerHeight*this.windowHeightDistance},Dn);function Dn(t){this.config=t,this.windowHeightDistance=Number(t.windowHeightDistance)||0}function Ln(t){this.logger=t}function Nn(t){t.registerCondition(Hi,function(t){return new Qi}),t.registerCondition(Vi,function(t){return new Ki})}function Mn(t){t.registerTrigger(yt,function(t){return new St}),t.registerTrigger(un,function(t){return new dn(t)}),t.registerTrigger(xn,function(t){return new Rn})}Ln.prototype.getSlotConditionFactory=function(){return this.slotConditionFactory||(this.slotConditionFactory=new cn(this.logger),Nn(this.slotConditionFactory),this.slotConditionFactory.registerCondition(Tt,function(t){return new At}),Mn(this.slotConditionFactory)),this.slotConditionFactory},Ln.prototype.getInsertConditionFactory=function(){var t;return this.insertConditionFactory||(this.insertConditionFactory=new cn(this.logger),Nn(this.insertConditionFactory),(t=this.insertConditionFactory).registerCondition(pn,function(t){return new hn(t)}),t.registerCondition(An,function(t){return new wn(t)}),t.registerCondition(On,function(t){return new Pn(t)}),t.registerCondition(bn,function(t){return new mn(t)}),t.registerCondition(En,function(t){return new Cn(t)}),t.registerCondition(Sn,function(t){return new vn(t)}),Mn(this.insertConditionFactory)),this.insertConditionFactory};var Fn=new Ln(c.getLogger()),Un=(Bn.prototype.monitorTouchDetect=function(){var t=this;this.isMonitoring||(this.browserWindow.addEventListener("touchstart",function(){t.isTouching=!0}),this.browserWindow.addEventListener("touchend",function(){t.isTouching=!1}),this.browserWindow.addEventListener("touchcancel",function(){t.isTouching=!1}),this.isMonitoring=!0,this.logger.debug("[TOUCH]: Monitoring touch events"))},Bn.prototype.getIsTouching=function(){return this.isTouching},Bn.prototype.waitForTouchEnd=function(t){var e=this;if(!this.isTouching)return t();var i=setInterval(function(){if(e.logger.debug("[TOUCH]: Checking if user is touching"),!e.isTouching)return clearInterval(i),t()},100)},Bn);function Bn(t,e){this.browserWindow=t,this.logger=e,this.isTouching=!1,this.isMonitoring=!1,this.monitorTouchDetect()}x.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if("file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},x.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":case"select":return!0;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},x.prototype.sendClick=function(t,e){document.activeElement&&document.activeElement!==t&&document.activeElement.blur();e=e.changedTouches[0],e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1,button:0,relatedTarget:null});e.forwardedTouchEvent=!0,t.dispatchEvent(e),this.logger.debug("[FASTCLICK] Sent click event to element ".concat(t.tagName))},x.prototype.focus=function(t){var e;t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type&&"email"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},x.prototype.updateScrollParent=function(t){var e=t.fastClickScrollParent;if(!e||!e.contains(t)){var i=t;do{if(i.scrollHeight>i.offsetHeight){e=i,t.fastClickScrollParent=i;break}}while(i=i.parentElement)}e&&(e.fastClickLastScrollTop=e.scrollTop)},x.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},x.prototype.onTouchStart=function(t){if(1<t.targetTouches.length)return!0;var e=this.getTargetElementFromEventTarget(t.target),i=t.targetTouches[0],n=window.getSelection();return!(!n.rangeCount||n.isCollapsed)||(i.identifier&&i.identifier===this.lastTouchIdentifier?(t.preventDefault(),!1):(this.lastTouchIdentifier=i.identifier,this.updateScrollParent(e),this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=i.pageX,this.touchStartY=i.pageY,t.timeStamp-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0))},x.prototype.touchHasMoved=function(t){var t=t.changedTouches[0],e=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>e||Math.abs(t.pageY-this.touchStartY)>e},x.prototype.onTouchMove=function(t){return this.trackingClick&&(this.targetElement===this.getTargetElementFromEventTarget(t.target)&&!this.touchHasMoved(t)||(this.trackingClick=!1,this.targetElement=null)),!0},x.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},x.prototype.onTouchEnd=function(t){var e=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0;if(t.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;this.cancelNextClick=!1,this.lastClickTime=t.timeStamp;var i=this.trackingClickStart,n=(this.trackingClick=!1,this.trackingClickStart=0,e.tagName.toLowerCase());if("label"===n){var o=this.findControl(e);o&&(this.focus(e),e=o)}else if(this.needsFocus(e))return 100<t.timeStamp-i||window.top!==window&&"input"===n?this.targetElement=null:(this.focus(e),this.sendClick(e,t),"select"!==n&&(this.targetElement=null,t.preventDefault())),!1;o=e.fastClickScrollParent;return!(!o||o.fastClickLastScrollTop===o.scrollTop)||(this.needsClick(e)||(t.preventDefault(),this.sendClick(e,t)),!1)},x.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},x.prototype.onMouse=function(t){return!this.targetElement||(!!t.forwardedTouchEvent||(!t.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1))))},x.prototype.onClick=function(t){if(this.trackingClick)return this.targetElement=null,!(this.trackingClick=!1);if("submit"===t.target.type&&0===t.detail)return!0;t=this.onMouse(t);return t||(this.targetElement=null),t},x.prototype.destroy=function(){this.layer.removeEventListener("click",this.onClick,!0),this.layer.removeEventListener("touchstart",this.onTouchStart,!1),this.layer.removeEventListener("touchmove",this.onTouchMove,!1),this.layer.removeEventListener("touchend",this.onTouchEnd,!1),this.layer.removeEventListener("touchcancel",this.onTouchCancel,!1)};var Gn=x;function x(t,e){var i,n=this;this.layer=t,this.logger=e,this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.lastClickTime=0,this.cancelNextClick=!1,this.touchBoundary=10,this.tapDelay=200,this.tapTimeout=700,t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",function(t){return n.onTouchStart(t)},!1),t.addEventListener("touchmove",function(t){return n.onTouchMove(t)},!1),t.addEventListener("touchend",function(t){return n.onTouchEnd(t)},!1),t.addEventListener("touchcancel",function(){return n.onTouchCancel()},!1),"function"==typeof t.onclick&&(this.logger.debug("[FASTCLICK] re-using existing onclick"),i=t.onclick,t.addEventListener("click",function(t){i.call(n,t)},!1),t.onclick=null),this.logger.debug("[FASTCLICK] FastClick enabled")}function zn(){}zn.prototype.getTouchObserver=function(){return this.touchObserver||(this.touchObserver=new Un(a.getBrowserWindowObject(),c.getLogger())),this.touchObserver},zn.prototype.enableFastClick=function(){this.fastClick||(this.fastClick=new Gn(a.getBrowserWindowObject().document.body,c.getLogger()))};var Wn=new zn,jn=(qn.prototype.logContext=function(t){return"[SLOT-FORMAT][".concat(t.id,"]:")},qn.prototype.hasOverflow=function(t,i,n){for(var o=this,r=t.parentElement,s=["hidden","scroll","auto"],e=["overflow","overflow-x","overflow-y"];r;)e.forEach(function(t){var e=o.browserWindow.getComputedStyle(r)[t];if(-1!==s.indexOf(e)){if(!n)return o.logger.debug("".concat(o.logContext(i)," Miniscroller was not applied. ").concat(t,' on "').concat(r.id," ").concat(r.className,'"')),!0;r.style[t]="visible",o.logger.debug("".concat(o.logContext(i)," Force miniscroller. Update ").concat(t,' on "').concat(r.id," ").concat(r.className,'"'))}}),r=r.parentElement;return!1},qn.prototype.hasHeight=function(t,e,i){var n=t,o=this.browserWindow.getComputedStyle(t),r=o.height,o=o.minHeight;if(this.logger.debug("".concat(this.logContext(e),' applying miniscroller on element with height "').concat(r,'" min-height: "').concat(o,'"')),-1===["0px","auto"].indexOf(r)){if(!i)return this.logger.debug("".concat(this.logContext(e)," Miniscroller was not applied because of height ").concat(r,' already set for element "').concat(t.id,'"')),!0;this.logger.debug("".concat(this.logContext(e),' Force miniscroller. Update height on "').concat(n.className,'"'))}return!1},qn.prototype.getMiniscrollerOverrides=function(t){return this.miniscrollersParams[t.id]},qn.prototype.format=function(t,e){var i=e.attributes;!(this.templateSettings.isMiniScrollersEnabled()||0<Object.keys(this.miniscrollersParams).length)||!1===i.miniscroller||i.sticky||i.interscroller||i.interstitial||i.scrollToStick||this.hasHeight(t,e,null==(i=this.getMiniscrollerOverrides(e))?void 0:i.force)||this.hasOverflow(t,e,null==(i=this.getMiniscrollerOverrides(e))?void 0:i.forceOverflow)||(this.logger.debug("".concat(this.logContext(e),' Update slot element "').concat(t.id,'" to miniscroller')),this.updateSlotElementToMiniScroller(t,e))},qn.prototype.updateSlotElementToMiniScroller=function(t,e){var i=b().name,n=(t.classList.add("fuse-slot-mini-scroller"),(null==(n=this.getMiniscrollerOverrides(e))?void 0:n.forceHeight)||this.templateSettings.maxSlotHeightForBreakpoint(e,i));t.style.minHeight="".concat(n,"px")},qn.prototype.updateSlotForYandex=function(t,e){var i=b(),e=e.sizeMapping[i.name],n=0,o=0;e&&(e.forEach(function(t){"fluid"!==t&&(Number(t[0])>o&&(o=Number(t[0])),Number(t[1])>n&&(n=Number(t[1])))}),t.style.width="".concat(o,"px"),t.style.height="".concat(n,"px"),t.style.margin="auto")},qn);function qn(t,e,i,n){this.logger=t,this.templateSettings=e,this.browserWindow=i,this.miniscrollersParams=n}function Hn(){}Hn.prototype.getAuctionExecutor=function(){return this.auctionExecutor||(this.auctionExecutor=new vi(this.getFuseSlotRegistry(),Fe.getPrebidGlobal(),qi.getUam(),c.getLogger(),c.getReporter(),u,Wn.getTouchObserver())),this.auctionExecutor},Hn.prototype.getFuseSlotRegistry=function(){return this.fuseSlotRegistry||(this.fuseSlotRegistry=new ui(Fe.getPrebidGlobal(),c.getLogger(),c.getReporter(),a.getBrowserWindowObject(),c.getResourceLogger(),pi.getGptSlotRegistry(),u,Fn.getSlotConditionFactory())),this.fuseSlotRegistry},Hn.prototype.getAuctionScheduler=function(){var n=this;return this.auctionScheduler||(this.auctionScheduler=new Ei(c.getLogger(),a.getBrowserWindowObject(),function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return(t=n.getAuctionExecutor()).executeAuction.apply(t,e)},function(t){return n.getAuctionPlanner().plan(t)},function(t){return n.getFuseSlotRegistry().isDeletedSlot(t)},function(){return b().name},u)),this.auctionScheduler},Hn.prototype.getAuctionPlanner=function(){return this.auctionPlanner||(this.auctionPlanner=new hi(c.getLogger(),u,_i.getInitManager(),Wi.getConsentManger())),this.auctionPlanner},Hn.prototype.getController=function(){return this.controller||(this.controller=new Ii(this.getFuseSlotRegistry(),c.getLogger(),this.getAuctionScheduler(),u,this.getDomProcessor(),function(){return _i.getInitManager().isTagInitialised()})),this.controller},Hn.prototype.getDomProcessor=function(){return this.domProcessor||(this.domProcessor=new si(c.getLogger(),a.getBrowserWindowObject().document,u,this.getFuseSlotFormatter(),function(){return c.getReporter().getElapsedTime()})),this.domProcessor},Hn.prototype.getFuseSlotFormatter=function(){return this.fuseSlotFormatter||(this.fuseSlotFormatter=new jn(c.getLogger(),u,a.getBrowserWindowObject(),mt())),this.fuseSlotFormatter};var Vn=new Hn,f=(Qn.prototype.getZoneDivId=function(){return"fuse-injected-".concat(this.slot.id,"-").concat(++this.incrementalCounter)},Qn.prototype.createSlotElement=function(){return this.toHTML('<div id="'.concat(this.getZoneDivId(),'" data-fuse="').concat(this.slot.id,'" data-fuse-injected-at="').concat((new Date).getTime(),'" class="fuse-slot-').concat(this.type,'"></div>'))},Qn.prototype.toHTML=function(t){var e=document.createElement("div");return e.innerHTML=t,e.firstElementChild},Qn.prototype.getFuseSlotHeight=function(){var t=this.responsive.getCurrentBreakpoint().name,e=this.slot.sizeMapping,e=e[t]?e[t].map(function(t){return Number(t[1])}):[];return e.length?Math.max.apply(Math,e):0},Qn.prototype.getFuseSlotWidth=function(){var t=this.responsive.getCurrentBreakpoint().name,e=this.slot.sizeMapping,e=e[t]?e[t].map(function(t){return Number(t[0])}):[];return e.length?Math.max.apply(Math,e):0},Qn.prototype.getLogContext=function(){return"[".concat(this.type,"][").concat(this.slot.id,"]:")},Qn.prototype.getClassName=function(){return"publift-widget-".concat(this.slot.id)},Qn.prototype.getContainerElement=function(){return document.querySelector(".".concat(this.getClassName(),"-container"))},Qn.prototype.getStylesElement=function(){return document.querySelector("#".concat(this.getClassName(),"-styles"))},Qn.prototype.getWidgetElement=function(){return document.querySelector(".".concat(this.getClassName()))},Qn);function Qn(t,e,i){this.slot=t,this.logger=e,this.responsive=i,this.incrementalCounter=0}var Yn,Kn,Ae=this&&this.__extends||(Yn=function(t,e){return(Yn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}Yn(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),Jn=this&&this.__assign||function(){return(Jn=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Zn=(Ae(R,Kn=f),R.prototype.createWidget=function(t){var e=this.getClassName();return this.toHTML('\n<div class="'.concat(e,'-container closed" style="display: ').concat(0===t?"none":"block",'">\n<div class="').concat(e,'-container-background">\n</div>\n  <div class="').concat(e,'-button">\n    <div></div>\n    <div></div>\n  </div>\n  <div class="').concat(e,'">\n  </div>\n</div>\n'))},R.prototype.getHideAtElement=function(){var t=this.getAttributes().hideSelector;return t?document.querySelector(t):null},R.prototype.getFixedElement=function(){var t=this.getAttributes().fixedSelector;return t?document.querySelector(t):null},R.prototype.getFixedClass=function(){return"".concat(this.getClassName(),"-fixed")},R.prototype.getWidgetCloseButtonElement=function(){return document.querySelector(".".concat(this.getClassName(),"-button"))},R.prototype.makeAttributes=function(){var t=Jn({bgColor:"#EFEFEF",bgOpacity:.7,allowClose:!1,buttonColor:"#313131",barColor:"#EFEFEF",borderWidth:"0px",zIndex:2147483645,compact:!1},this.slot.stickyAttributes);return t.compact&&(t.bgOpacity=1,t.bgColor=t.barColor),t},R.prototype.addContent=function(t,e){var i=this,n=this.getClassName(),o=t.querySelector(".".concat(n)),r=this.createSlotElement(),o=(o.appendChild(r),t.querySelector(".".concat(n,"-button")).addEventListener("click",function(){t.classList.contains("closed")?i.onShow():i.onClose(),clearInterval(i.hideAtElementInterval)}),document.querySelector("body"));return o.insertAdjacentElement("beforeend",e),o.insertAdjacentElement("beforeend",t),r},R.prototype.getButtonStyles=function(t,e,i,n,o){return t?e?"border-radius: 0 0 2px 2px; top: ".concat(i,"px;"):"border-radius: 2px 2px 0 0; top: -20px;":e?"border-radius: 2px 2px 0 0; top: ".concat(n-20+o,"px;"):"border-radius: 0 0 2px 2px; top: 0px;"},R.prototype.getFixedSelectorStyles=function(t,e,i,n,o){return e?".".concat(t,"-fixed {\n  ").concat(i?"top":"bottom"," : ").concat(n?o:0,"px;\n}\n").concat(e," {\n  transition: ").concat(i?"top":"bottom"," .3s linear;\n}"):""},R.prototype.createStyles=function(){var t=this.getAttributes(),e=t.zIndex,i=t.compact,n=t.isTop,o=t.isButtonOutside,r=t.bgColor,s=t.bgOpacity,a=t.barColor,c=t.allowClose,l=t.allowReopen,u=t.buttonColor,d=t.fixedSelector,t=t.borderWidth,g=this.getFuseSlotHeight(),p=this.getContainerBordersSize(),h=this.getContainerBorderSize(),f=g+p,b=this.getFuseSlotWidth(),p=b+p,m=l&&o?h:0,y=this.getClassName();return this.toHTML('\n<style id="'.concat(y,'-styles">\n.').concat(y,"-container {\n  z-index: ").concat(e,";\n  position: fixed;\n  ").concat(n?"top: 0":"bottom: 0",";\n  width: ").concat(i?p+"px":"100%",";\n  height: ").concat(f,"px;\n  transition: transform .3s linear, height .3s linear;\n  ").concat(o?"":"overflow: hidden;","\n  visibility: hidden;\n  ").concat(i?"left: 50%; transform: translateX(-50%);":"left: 0;","\n}\n.").concat(y,"-container-background {\n  background-color: ").concat(r,";\n  opacity: ").concat(s,";\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: -1;\n}\n\n.").concat(y,"-button {\n  width: 40px;\n  margin-left: 2px;\n  height: 20px;\n  background-color: ").concat(a,";\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  display: ").concat(c?"flex":"none",";\n  transition: top .3s linear;\n  ").concat(this.getButtonStyles(o,n,f,g,h),"\n}\n.").concat(y,"-button :first-child, .").concat(y,"-button :last-child  {\n  background-color: ").concat(u,";\n  width: 13px;\n  height: 3px;\n  border-radius: 2px;\n}\n.").concat(y,"-button :first-child {\n  transform: rotate(").concat(n?"-":"","30deg) translateX(2px);\n}\n.").concat(y,"-button :last-child {\n  transform: rotate(").concat(n?"":"-","30deg) translateX(-2px);\n}\n.").concat(y," {\n  width: ").concat(i?b+"px":"100%",";\n  height: ").concat(g,"px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  transition: transform .3s linear, height .3s linear;\n  border").concat(i?"":n?"-bottom":"-top",": ").concat(t," solid ").concat(a,";\n}\n.").concat(y,"-container.closed {\n  ").concat(n?"transform: translateY(-".concat(f-m,"px)").concat(i?" TranslateX(-50%)":"",";"):"height: "+m+"px;","\n}\n.").concat(y,"-container.closed .").concat(y,"-button {\n  ").concat(l?"":"display: none;","\n}\n.").concat(y,"-container.closed .").concat(y,"-button :first-child {\n  transform: rotate(").concat(n?"":"-","30deg) translateX(2px);\n}\n.").concat(y,"-container.closed .").concat(y,"-button :last-child {\n  transform: rotate(").concat(n?"-":"","30deg) translateX(-2px);\n}\n").concat(this.getFixedSelectorStyles(y,d,n,g,f),"\n</style>\n"))},R.prototype.getContainerBorderSize=function(){var t=this.getAttributes().borderWidth;return Number(t.substring(0,t.length-2))},R.prototype.getContainerBordersSize=function(){var t=this.getAttributes().compact;return this.getContainerBorderSize()*(t?2:1)},R.prototype.getAttributes=function(){return this.attributes},R.prototype.insert=function(){var t=this,e=(this.logger.debug("".concat(this.getLogContext()," add widget")),this.createWidget(this.getFuseSlotHeight())),i=this.createStyles(),e=this.addContent(e,i);return window.requestAnimationFrame(function(){t.show()}),this.getHideAtElement()&&this.setHideAtElementListener(),[e]},R.prototype.hideAtElementListener=function(){var t=this.getContainerElement(),e=this.getHideAtElement(),i=this.getAttributes().isHideForever;Ct.checkInView(this.browserWindow,e,1,!1)?t.classList.contains("closed")||(this.hide(),i&&clearInterval(this.hideAtElementInterval)):t.classList.contains("closed")&&this.show()},R.prototype.setHideAtElementListener=function(){var t=this;this.getHideAtElement()&&(this.hideAtElementInterval=setInterval(function(){t.hideAtElementListener()},500))},R.prototype.isHideSelectorVisible=function(){var t=this.getHideAtElement();return!(!t||!Ct.checkInView(this.browserWindow,t,1,!1))},R.prototype.onBreakpointChange=function(){var t,e,i,n,o=this.getAttributes().compact,r=this.getContainerElement(),s=this.getWidgetElement();s&&(t=this.getFuseSlotHeight(),n=(e=this.getFuseSlotWidth())+(i=this.getContainerBordersSize()),r.style.height=(0===t?0:t+i)+"px",r.style.display=0===t?"none":"block",o&&t&&(r.style.width=n+"px",s.style.width=e+"px"),s.style.height=t+"px",0===t||this.isHideSelectorVisible()?this.updateFixedElement(!0):this.updateFixedElement(),this.getStylesElement().innerHTML=this.createStyles().innerHTML)},R.prototype.delete=function(){var t=this.getStylesElement(),e=this.getContainerElement();return this.updateFixedElement(!0),!(!t||!e)&&(t.remove(),e.remove(),!0)},R.prototype.show=function(){var e=this,i=this.slot.id;return this.logger.debug("".concat(this.getLogContext()," showing with waitForCreative ").concat(this.waitForCreative)),this.loadingByCreative||(this.waitForCreative?(this.loadingByCreative=!0,this.gpt.registerSlotOnLoadEndedCallbackAsync(function(t){-1!==t.slot.getSlotElementId().indexOf(i)&&(e.logger.debug("".concat(e.getLogContext()," show widget by creative ").concat(t.slot.getSlotElementId())),!e.isHideSelectorVisible()&&e.loadingByCreative&&e.onShow(),e.loadingByCreative=!1)})):this.onShow()),!0},R.prototype.onShow=function(){var e=this,t=this.getContainerElement();t.classList.remove("closed"),t.style.visibility="visible",this.updateFixedElement(),this.apiV3.getSlotsForTemplateId(this.slot.id).forEach(function(t){t&&e.apiV3.enableRefreshByZone(t.creativeDivId)}),this.onShowCloseCallback()},R.prototype.onClose=function(){var e=this;this.getContainerElement().classList.add("closed"),this.updateFixedElement(!0),this.apiV3.getSlotsForTemplateId(this.slot.id).forEach(function(t){t&&e.apiV3.disableRefreshByZone(t.creativeDivId)}),this.onShowCloseCallback()},R.prototype.hide=function(){return this.logger.debug("".concat(this.getLogContext()," hiding")),this.onClose(),!0},R.prototype.updateFixedElement=function(t){void 0===t&&(t=!1),this.logger.debug("".concat(this.getLogContext()," updateFixedElement ").concat(t?"restore":"update"));var e,i=this.getFixedElement();i&&(e=this.getFixedClass(),t?i.classList.remove(e):i.classList.add(e))},R);function R(t,e,i,n,o,r,s,a){void 0===a&&(a=!0);var c=Kn.call(this,t,e,i)||this;return c.slot=t,c.logger=e,c.responsive=i,c.browserWindow=n,c.gpt=o,c.apiV3=r,c.onShowCloseCallback=s,c.waitForCreative=a,c.loadingByCreative=!1,c.hiddenForever=!1,c.type="sticky",c.attributes=c.makeAttributes(),c}var Xn,$n,o=this&&this.__extends||(Xn=function(t,e){return(Xn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}Xn(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),to=this&&this.__assign||function(){return(to=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},eo=(o(io,$n=f),io.prototype.getAttributes=function(){return to({selector:".adBreak",showBanner:!1,height:"100vh",zIndex:1e7,top:"auto"},this.slot.interscrollerAttributes)},io.prototype.insert=function(){var t=this.getAttributes(),e=t.showBanner,i=t.top,n=t.zIndex,o=t.height,t=t.selector,r=this.getFuseSlotHeight(),s=this.createSlotElement(),a=this.getClassName(),e=e?'<div class="'.concat(a,'-container-message banner_top">Advertisement</div>'):"",e=this.toHTML('\n    <div class="'.concat(a,'-container">\n      ').concat(e,'\n        <div class="').concat(a,'-scroll-clip">\n          <div class="').concat(a,'">').concat(s.outerHTML,"</div>\n        </div>\n    </div>\n  ")),n=this.toHTML('\n  <style id="'.concat(a,'-styles">\n  .').concat(a,"-container {\n    width: 100vw;\n    min-height: ").concat(o,";\n    z-index: ").concat(n,";\n    position: relative;\n    display: ").concat(0===r?"none":"block",";\n  }\n\n  .").concat(a,"-container-message {\n    background-color: black;\n    color: white;\n    padding: .5em;\n    text-align: center;\n    font-family: sans-serif;\n  }\n\n  .").concat(a,"-scroll-clip {\n    position: absolute;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    padding: 0;\n    clip-path: inset(0px);\n    clip: rect(0px, auto, auto, 0px);\n    min-height: ").concat(o,"\n  }\n\n  .").concat(a," {\n    position: fixed;\n    top: ").concat(i,";\n    left: 0;\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    padding: 0;\n    bottom: 0;\n    transform: translateZ(0px);\n  }\n  </style>\n  ")),r=document.querySelector("body");if(r){o=document.querySelector(t);if(o)return r.insertAdjacentElement("beforeend",n),o.appendChild(e),e.style.marginLeft="-".concat(e.getBoundingClientRect().x,"px"),[s];this.logger.info("".concat(this.getLogContext()," insertionPoint with selector not found: ").concat(t))}return[]},io.prototype.onBreakpointChange=function(){var t=this.getFuseSlotHeight(),e=this.getContainerElement();e&&(e.style.display=0===t?"none":"block")},io.prototype.delete=function(){var t=this.getStylesElement(),e=this.getContainerElement();return!(!t||!e)&&(t.remove(),e.remove(),!0)},io.prototype.hide=function(){return this.getContainerElement().style.display="none",!0},io.prototype.show=function(){return this.getContainerElement().style.display="block",!0},io);function io(){var t=null!==$n&&$n.apply(this,arguments)||this;return t.type="interscroller",t}var no,oo,we=this&&this.__extends||(no=function(t,e){return(no=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}no(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),ro=this&&this.__assign||function(){return(ro=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},so=(we(k,oo=f),k.prototype.getAttributes=function(){return ro(ro({},this.slot.dynamicAttributes),{skip:Number(this.slot.dynamicAttributes.skip||0),each:Number(this.slot.dynamicAttributes.each||0),incrementEach:Number(this.slot.dynamicAttributes.incrementEach||0),repeatHeight:Number(this.slot.dynamicAttributes.repeatHeight||1e3)})},k.prototype.createElement=function(t,e){void 0===t&&(t=""),void 0===e&&(e="");var i=this.createSlotElement();return t&&t.split(" ").forEach(function(t){return i.classList.add(t)}),e&&(i.style.cssText=e),i},k.prototype.canBeInserted=function(t){var e=this.getLogContext();if(!t)return this.logger.warn("".concat(e," Selector should be defined")),!1;var i=document.querySelectorAll(t);return i.length?(this.logger.debug("".concat(e," Page has ").concat(i.length," elements suitable for selector ").concat(t)),!0):(this.logger.info("".concat(e," No element with selector ").concat(t," found")),!1)},k.prototype.notFuseSlot=function(t){return!t||t.getAttribute("data-fuse")!==this.slot.id||(this.logger.debug("".concat(this.getLogContext()," Skip insertion cause slot already inserted")),!1)},k.prototype.filterNodes=function(t){var e=this.getAttributes(),i=e.skip,n=e.each,o=e.position,r=e.incrementEach,s=[],a=0,c=n;return t.forEach(function(t,e){e+=1;if(i&&e<=i)return!1;if("incontent"!==o&&c){if((e-i-a)%c!=0)return!1;r&&(a+=c,c+=r)}s.push(t)}),s},k.prototype.getZoneDiv=function(t,e){return(e=void 0===e?!1:e)?t.querySelector("div[data-fuse]"):t},k.prototype.insert=function(){var c=this,t=this.getAttributes(),e=t.selector,l=t.position,u=t.classNames,d=t.css,g=t.wrapperContent,p=t.repeatHeight;if(!this.canBeInserted(e))return this.logger.debug("".concat(this.getLogContext()," Injection skipped")),[];var t=document.querySelectorAll(e),h=0,f=[];return this.filterNodes(t).forEach(function(t){var e=c.createElement(u,d),i=e,n=(g&&(e=c.wrapElement(e,g)),t.nextElementSibling),o=t.parentNode,r=t.previousElementSibling,s=t.lastElementChild;switch(l){case"after":c.notFuseSlot(n)&&(o.insertBefore(e,n),f.push(i));break;case"before":c.notFuseSlot(r)&&(o.insertBefore(e,t),f.push(i));break;case"replace":t.replaceWith(e),f.push(i);break;case"incontent":var a=t.getBoundingClientRect().top+t.getBoundingClientRect().height+document.documentElement.scrollTop,a=Math.floor(a/p);h<a&&(h=a,c.notFuseSlot(n)&&(o.insertBefore(e,n),f.push(i)));break;default:c.notFuseSlot(s)&&(t.appendChild(e),f.push(i))}}),f},k.prototype.wrapElement=function(t,e){var i=document.createElement("div");return i.innerHTML=e,i.firstElementChild.appendChild(t),i.firstElementChild},k.prototype.delete=function(){var t=document.querySelectorAll('[data-fuse="'.concat(this.slot.id,'"]'));return t.forEach(function(t){t.remove()}),0<t.length},k.prototype.hide=function(){throw new Error("Method not implemented.")},k.prototype.show=function(){throw new Error("Method not implemented.")},k.prototype.onBreakpointChange=function(){throw new Error("Method not implemented.")},k);function k(){var t=null!==oo&&oo.apply(this,arguments)||this;return t.type="dynamic",t}O.prototype.getStickySlots=function(){return this.settings.getFuseSlots().filter(function(t){return null==(t=t.attributes)?void 0:t.sticky})},O.prototype.getInterscrollerSlots=function(){return this.settings.getFuseSlots().filter(function(t){return null==(t=t.attributes)?void 0:t.interscroller})},O.prototype.getDynamicSlots=function(){return this.settings.getFuseSlots().filter(function(t){return null==(t=t.attributes)?void 0:t.dynamic})},O.prototype.getScrollToStickSlots=function(){return this.settings.getFuseSlots().filter(function(t){return null==(t=t.attributes)?void 0:t.scrollToStick})},O.prototype.getMiniscrollerSlots=function(){return this.settings.getFuseSlots().filter(function(t){return null==(t=t.attributes)?void 0:t.miniscroller})},O.prototype.isSlotInjected=function(t){return null!==document.querySelector('[data-fuse="'.concat(t.id,'"]'))},O.prototype.getWidget=function(e){return this.widgets.filter(function(t){return t.slot.id===e.id})[0]},O.prototype.removeWidget=function(t){var e=this.getWidget(t);return e?(e.delete(),this.logger.debug("[WIDGETS][".concat(t.id,"] Widget deleted")),!0):(this.logger.debug("[WIDGETS][".concat(t.id,"] Widget was not found")),!1)},O.prototype.cleanup=function(){var e=this;this.getWidgetSlots().forEach(function(t){return e.removeWidget(t)})},O.prototype.onBreakpointChange=function(){var e=this,t=this.getStickySlots(),i=this.getInterscrollerSlots();this.logger.info("[WIDGETS] onBreakpointChange Stickies: ".concat(t.length," Scrolls: ").concat(i.length)),[].concat(t,i).forEach(function(t){t=e.getWidget(t);t&&t.onBreakpointChange()})},O.prototype.getWidgetSlots=function(){return[].concat(this.getDynamicSlots(),this.getInterscrollerSlots(),this.getStickySlots())},O.prototype.getWidgetsWithSelector=function(){return[].concat(this.getDynamicSlots(),this.getInterscrollerSlots())},O.prototype.insertStyles=function(t){var e=document.createElement("div");e.innerHTML=t,document.querySelector("body").insertAdjacentElement("beforeend",e.firstElementChild)},O.prototype.cleanupDynamicSlots=function(){this.getDynamicSlots().forEach(function(t){document.querySelectorAll('[data-fuse="'.concat(t.id,'"]')).forEach(function(t){t.remove()})})},O.prototype.injectWidget=function(t){var e=this,i=(this.logger.debug("[WIDGETS][".concat(t.id,"] Inject widget")),t.attributes),n=i.sticky,o=i.interscroller,i=i.dynamic,r=this.getWidget(t),s=!1;if((n||o)&&this.isSlotInjected(t))this.logger.debug("[WIDGETS][".concat(t.id,"] Skip injection. DOM element exists"));else{if(!r){if(n)r=new Zn(t,this.logger,Oe,this.browserWindow,he,this.apiV3,function(){e.updateFuseStyles()},!this.settings.isYandexEnabled()),s=t.stickyAttributes.isTop;else if(o)r=new eo(t,this.logger,Oe);else{if(!i)return void this.logger.warn("[WIDGETS][".concat(t.id,"] Skip injection of unknown widget"));this.logger.debug("[WIDGETS][".concat(t.id,"] Injecting dynamic slot with attributes ").concat(JSON.stringify(t.dynamicAttributes))),r=new so(t,this.logger,Oe)}this.widgets.push(r)}n=r.insert();n.forEach(function(t){e.logger.debug("[WIDGETS][".concat(t.id,"] Run queueZone")),e.apiV3.queueZone(t.id)}),0<n.length&&this.apiV3.runAuction(),s&&this.updateFuseStyles()}},O.prototype.render=function(){var i=this;this.getWidgetSlots().forEach(function(t){var e;!t.insertCondition||!t.insertCondition.type||(e=i.conditionFactory.buildActivator(t.insertCondition,t.id,i.apiV3,function(){i.injectWidget(t)})).checkCondition()?i.injectWidget(t):e.enableTriggers()})},O.prototype.initConditions=function(){this.inited?this.logger.debug("[WIDGETS] Skipped initialisation as it is already initialised"):(this.logger.debug("[WIDGETS] Init conditions"),this.render(),this.inited=!0)},O.prototype.getMiniScrollersTopOffset=function(){var i=this,n=0,t=this.settings.getTopStickyHeaderSelector();return t&&(t=document.querySelector(t))&&(n+=t.clientHeight,this.logger.debug("[WIDGETS] miniscrollers offset set to ".concat(n," because of topStickyHeader"))),this.getStickySlots().forEach(function(t){var e;t.stickyAttributes.isTop&&(e=i.getWidget(t))&&!e.getContainerElement().classList.contains("closed")&&(n+=i.settings.maxSlotHeightForBreakpoint(t,b().name),i.logger.debug("[WIDGETS] miniscrollers offset set to ".concat(n," because of top sticky")))}),n},O.prototype.injectFuseStyles=function(){var t,e,i;document.getElementById("publift-fuse-styles")?this.logger.debug("[WIDGETS] styles already injected"):(t="",e=this.getMiniScrollersTopOffset(),this.settings.isMiniScrollersEnabled()&&(this.logger.debug("[WIDGETS] inject fuse styles"),i="\n      .fuse-slot-mini-scroller .fuse-slot {\n        top: ".concat(0|e,"px;\n        position: sticky !important;\n        overflow: hidden !important;\n      }\n      .fuse-slot-mini-scroller {\n        overflow: initial !important;\n        display: block !important;\n      }\n      "),this.logger.debug("[WIDGETS] injected miniScroller styles"),t+=i),i="\n    .fuse-slot-scroll-to-stick .fuse-slot {\n      z-index: 9999;\n      top: ".concat(0|e,"px;\n      position: fixed;\n      width: 100%;\n      left: 0px;\n      pointer-events: none;\n    }\n    "),this.insertStyles('<style id="publift-fuse-styles">'.concat(t+=i,"</style>")))},O.prototype.updateFuseStyles=function(){var t=document.getElementById("publift-fuse-styles");t&&t.remove(),this.injectFuseStyles()},O.prototype.getScrollToStickPrevElement=function(t){var e=t.previousElementSibling;return e||this.getScrollToStickPrevElement(t.parentElement)},O.prototype.addScrollToStickListener=function(){var n=this,o=this.getMiniScrollersTopOffset(),t=this.getScrollToStickSlots();t.length&&(this.logger.debug("[WIDGETS] scrollToStick slots found ".concat(this.getScrollToStickSlots().length,". Attach scroll listener")),this.browserWindow.addEventListener("scroll",function(){t.forEach(function(i){document.querySelectorAll('[data-fuse="'.concat(i.id,'"]')).forEach(function(t){var e=n.getScrollToStickPrevElement(t);e&&e.getBoundingClientRect().y+e.getBoundingClientRect().height-o<0?(n.logger.debug("[WIDGETS][".concat(i.id,"] scrollToStick set")),t.classList.add("fuse-slot-scroll-to-stick")):(n.logger.debug("[WIDGETS][".concat(i.id,"] scrollToStick removed")),t.classList.remove("fuse-slot-scroll-to-stick"))})})},!0))};var ao=O;function O(t,e,i,n,o){var r=this;this.logger=t,this.settings=e,this.apiV3=i,this.conditionFactory=n,this.browserWindow=o,this.inited=!1,this.widgets=[],ke(function(){return r.onBreakpointChange()})}lo.prototype.getCurrentBreakpointName=function(){return b().name},lo.prototype.getWindow=function(){return this.window},lo.prototype.registerAll=function(){this.logger.debug("[APIV3]: registerAll() started");var t=this.slotsController.registerAndRunAuction(!0,!1,this);this.logger.debug("[APIV3]: registerAll() finished, ".concat(t.length," slots found"))},lo.prototype.processNewSlots=function(){this.registerAll()},lo.prototype.registerZone=function(t){this.logger.debug("[APIV3]: registerZone('".concat(t,"') started"));t=this.slotsController.registerZoneAndQueue(t,!0,!1,this);return t&&this.slotsController.runAuction(),t},lo.prototype.queueZone=function(t){return this.logger.debug("[APIV3]: queueZone('".concat(t,"') started")),this.slotsController.registerZoneAndQueue(t,!0,!1,this)},lo.prototype.runAuction=function(){return this.logger.debug("[APIV3]: runAuction() started"),this.slotsController.runAuction()},lo.prototype.disableRefreshByZone=function(t){return this.auctionScheduler.disableSlotRefresh(t)},lo.prototype.enableRefreshByZone=function(t){return this.auctionScheduler.enableSlotRefresh(t)},lo.prototype.getSlotsForTemplateId=function(t){return this.slotRegistry.getSlotsForTemplateId(t)};var co=lo;function lo(t,e,i,n,o,r,s,a){this.window=t,this.logger=e,this.settingsGlobal=i,this.slotsController=n,this.slotRegistry=o,this.auctionScheduler=r,this.insertConditionFactory=s,this.slotConditionFactory=a,this.settings=new uo(this.settingsGlobal)}go.prototype.getSlotTemplate=function(t){return this.settings.getSlotTemplate(t)},go.prototype.setDisableWidgetRenderer=function(t){this.settings.getV2CompatOverrides().disableWidgetsRenderer=t},go.prototype.getLazyDeviceToggle=function(t,e){return this.settings.lazyDeviceToggle(t,e)};var uo=go;function go(t){this.settings=t}var po="PAGE_INIT";function ho(t,e){if(t&&e)return t=new URL(t),e=new URL(e),t.hash="",e.hash="",t.toString()==e.toString()}bo.prototype.reset=function(){return this.logger.info("[PAGE]: Resetting all page state"),this.resetPageFn()},bo.prototype.pageInit=function(t,e,i){this.logger.info("[PAGE]: pageInit('".concat(t,"', ").concat(e,", ").concat(JSON.stringify(i)));var n=!1;if(null===this.lastInitUrl)if(ho(t,this.initialUrl)){if(this.anyAuctionStartedFn())return void this.logger.info("[PAGE]: Ignored pageInit(), because the URL hasn't changed since load, and the auction has already run")}else this.logger.info("[PAGE]: First pageInit() call, but the URL has changed since load. Resetting."),this.reset(),n=!0;else{if(n=!0,ho(t,this.lastInitUrl))return void this.logger.warn("[PAGE]: Ignored pageInit(), because the URL has not changed since the last pageInit call");this.logger.info("[PAGE]: pageInit() called, and the URL has changed. Resetting."),this.reset()}this.lastInitUrl=t,null!=i&&i.pageTargets&&this.setPageTargeting(null==i?void 0:i.pageTargets),null!=i&&i.blockingFuseIds&&this.setBlock(i,n,e),this.pageInitEmitter.emit(po),this.registerAndRunAuctionFn()},bo.prototype.addPageInitListener=function(t){this.pageInitEmitter.isTriggered(po)?(this.logger.debug("[EVENT][".concat(po,"]: Already triggered, invoking callback synchronously")),t()):this.pageInitEmitter.on(po,t)},bo.prototype.setBlock=function(t,e,i){var n=(null==t?void 0:t.blockingTimeout)||2e3,e=e?n:n-i;e<=0?this.logger.info("[PAGE][pageInit]: Skipped setting auction block, because there is no time left on the timeout"):(n=t.blockingFuseIds.map(function(t){return"".concat(t)}),this.setAuctionBlockFn(n,e))};var fo=bo;function bo(t,e,i,n,o,r,s){this.logger=t,this.initialUrl=e,this.resetPageFn=i,this.registerAndRunAuctionFn=n,this.anyAuctionStartedFn=o,this.setAuctionBlockFn=r,this.setPageTargeting=s,this.lastInitUrl=null,this.pageInitEmitter=new ei([po],this.logger)}var mo=!1,yo=c.getLogger(),So=function(){return a.getBrowserWindowObject().fusetag.que},vo=function(){return So().length},Io=function(){return So().push=function(t){if("function"==typeof t)try{t.call()}catch(t){yo.error("Error processing command :",t.message,t.stack)}else yo.error("Commands written into fusetag.que.push must be wrapped in a function")}};function Eo(){}Eo.prototype.getApiV3=function(){return this.apiV3||(this.apiV3=new co(a.getBrowserWindowObject(),c.getLogger(),u,Vn.getController(),Vn.getFuseSlotRegistry(),Vn.getAuctionScheduler(),Fn.getInsertConditionFactory(),Fn.getSlotConditionFactory())),this.apiV3},Eo.prototype.getPageManager=function(){var t=this;return this.pageManager||(this.pageManager=new fo(c.getLogger(),a.getBrowserWindowObject().location.href,function(){return t.resetPage()},function(){return Vn.getController().registerAndRunAuction(!0,!1,t.getApiV3())},function(){return Vn.getAuctionScheduler().inAnyAuctionExecuted()},function(t,e){return Vn.getAuctionScheduler().setAuctionBlock(t,e)},function(t){t.forEach(function(t){return Le(t.key,t.value)})})),this.pageManager},Eo.prototype.resetPage=function(){pi.getGptSlotRegistry().purgeAll(),ti.reset(),Vn.getController().reset(),Pe.info("[TARGETING] Clearing page targeting"),Qt(De),De=[],yo.debug("[QUEUE]: Cleared fuse queue with ".concat(vo()," remaining items")),So().splice(0,So().length),$t(),oe()};var Co=new Eo,To=(Ao.prototype.getStatuses=function(){return this.statuses},Ao.prototype.start=function(t,e){var i=this;!(e=void 0===e?!1:e)&&this.statuses.length||(this.logger.debug("[WIDGETS][CHECKER] Start to check slots"),this.statuses=t.filter(function(t){var e;return(null==(e=t.dynamicAttributes)?void 0:e.selector)||(null==(e=t.interscrollerAttributes)?void 0:e.selector)}).map(function(t){var e=(null==(e=t.dynamicAttributes)?void 0:e.selector)||(null==(e=t.interscrollerAttributes)?void 0:e.selector);return{slot:t,selector:e,countSelector:i.countSelector(e),countSlot:i.countSlot(t.id)}}),this.statuses.length&&(this.checkInterval=setInterval(function(){return i.check()},100)))},Ao.prototype.stop=function(){clearInterval(this.checkInterval),this.statuses=[]},Ao.prototype.check=function(){var n=this;this.statuses.forEach(function(t){var e=n.countSelector(t.selector),i=n.countSlot(t.slot.id);t.countSelector===e&&t.countSlot===i||(n.logger.debug("[WIDGETS][".concat(t.slot.id,'] Injecting by selector "').concat(t.selector,'" change: selectors ').concat(e," slots ").concat(i)),n.widgetsRenderer.injectWidget(t.slot),t.countSelector=n.countSelector(t.selector),t.countSlot=n.countSlot(t.slot.id))})},Ao.prototype.countSelector=function(t){return document.querySelectorAll(t).length},Ao.prototype.countSlot=function(t){return document.querySelectorAll('[data-fuse="'.concat(t,'"]')).length},Ao);function Ao(t,e){this.logger=t,this.widgetsRenderer=e,this.checkInterval=null,this.statuses=[]}_o.prototype.initInterstitial=function(){var t,e,i=this;this.hasInterstitial?this.logger.log("Interstitial all ready present"):null==(e=null==(t=this.settings.getFuseSlots().find(function(t){return t.attributes&&!0===t.attributes.interstitial}))?void 0:t.insertCondition)||!e.type||(e=this.insertFactory.buildActivator(t.insertCondition,t.id,this.apiV3,function(){i.setInterstitialSlot(t)})).checkCondition()?this.setInterstitialSlot(t):e.enableTriggers()},_o.prototype.setInterstitialSlot=function(t){ie(t),this.hasInterstitial=!0};var wo=_o;function _o(t,e,i,n){this.logger=t,this.settings=e,this.insertFactory=i,this.apiV3=n,this.hasInterstitial=!1}function xo(){}xo.prototype.getWidgetsRenderer=function(){return this.widgetsRenderer||(this.widgetsRenderer=new ao(c.getLogger(),u,Co.getApiV3(),Fn.getInsertConditionFactory(),a.getBrowserWindowObject())),this.widgetsRenderer},xo.prototype.getWidgetsChecker=function(){return this.widgetsChecker||(this.widgetsChecker=new To(c.getLogger(),this.getWidgetsRenderer())),this.widgetsChecker},xo.prototype.getInterstitialManager=function(){return this.interstitialManager||(this.interstitialManager=new wo(c.getLogger(),u,Fn.getInsertConditionFactory(),Co.getApiV3())),this.interstitialManager};var Ro=new xo,ko=this&&this.__assign||function(){return(ko=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},P=c.getLogger(),Oo=pi.getGptSlotRegistry(),Po=c.getReporter(),Do=c.getResourceLogger(),Lo=Vn.getFuseSlotRegistry(),No=Vn.getController(),Mo=_i.getInitManager(),Fo=a.getBrowserWindowObject(),Uo="onTagInitialised",Bo=new ei([Uo],P),Go=Co.getApiV3(),zo=Co.getPageManager(),Wo=function(t,e){P.debug("[API]: loadSlotById(".concat(t,", ").concat(e,")")),(e?No.registerZoneAndQueue(e,!0,!0,Go):No.registerAndQueueLastSlotWithFuseId("".concat(t),!0,!0,Go))||P.warn("[API]: loadSlotById(".concat(t,", ").concat(e,") failed to register a slot")),No.runAuction(),Do.logResources("loadSlotById")},jo=function(t,e,i){P.debug("[API]: setSlotTargetingById(".concat(t,", ").concat(e,", ").concat(i,") started")),!t||"string"!=typeof t&&"number"!=typeof t||Oo.setSlotTargetingById("".concat(t),e,i)},qo=function(t){if(t&&("string"==typeof t||"number"==typeof t))return Oo.getSlots("".concat(t))};var Ho={enableApi:function(t){P.debug("[INIT]: Enabling Fuse API"),t.fuseUUID=u.getFuseUUID(),t.initialised=!1,t.init=!1,t.getCurrentBreakpoint=function(){return b()},t.pageInit=function(t){return P.debug("[API]: pageInit(".concat(JSON.stringify(t),")")),zo.pageInit(Fo.location.href,Po.getElapsedTime(),t)},t.registerAll=function(){return P.debug("[API]: registerAll()"),No.registerAndRunAuction(!0,!1,Go)},t.registerZone=function(t){P.debug("[API]: registerZone('".concat(t,"')"));t=null==(t=No.registerZoneAndQueue(t,!0,!1,Go))?void 0:t.creativeDivId;return t&&No.runAuction(),t},t.states=Po.states,t.events=Po.events,t.setTargeting=function(t,e){return P.debug("[API]: setTargeting(".concat(t,", ").concat(JSON.stringify(e),")")),Le(t,e)},t.onSlotRenderEnded=function(e){return re(function(t){t={slotId:t.slot.getSlotElementId(),hasCreative:!t.isEmpty,gptEvent:t};e(t)})},t.onTagInitialised=function(t){Bo.once(Uo,t)},t.onSlotsInitialised=function(t){Lo.getSlotInitEmitter().once(ci,t)},t.onSlotInitialised=function(t){Lo.getSlotInitEmitter().once(li,t)},t.privateApi={getWidgetRenderer:function(){return Ro.getWidgetsRenderer()},getObservers:function(){return ve.getObservers()},getInitStatus:function(){return Mo.getInitStatus()},getSlotProblems:function(){return Po.getSlotProblems()},resetPage:function(){return P.debug("[API]: resetPage()"),zo.reset()},runAuctionAllActiveSlots:function(){return P.debug("[API]: runAuctionAllActiveSlots()"),No.runAuctionAllActiveSlots()},setLogLevel:function(t){return P.setLogLevel(t)},getLogLevel:function(){return P.getLogLevel()},getLogs:function(){return P.getLogs()},getAuctionState:function(){return Vn.getAuctionExecutor().getStateView()},getSlotTestUrls:function(){return u.getSlotTestUrls()},isYandexEnabled:function(){return u.isYandexEnabled()},isPrebidEnabled:function(){return u.isPrebidEnabled()},isCmpEnabled:function(){return u.isCmpRequired()},isUamEnabled:function(){return u.isUamEnabled()},isBlockthroughEnabled:function(){return u.isBlockthroughEnabled()}},t.loadSlots=function(){P.debug("[API]: loadSlots()"),No.loadSlots(t,Go,function(){return zo.reset()})},t.getUnits=function(){return Lo.getElements()},t.loadSlotById=function(t,e){return Wo(t,e)},t.refreshSlots=function(){return P.debug("[API]: refreshSlots()"),No.runAuctionAllActiveSlots()},t.refreshSlotByCode=function(t){return P.debug("[API]: refreshSlotByCode(".concat(t,")")),No.forceRunAuction(t)},t.getAdSlotsById=function(t){return qo(t)},t.processNewSlots=function(){return P.debug("[API]: processNewSlots()"),No.registerAndRunAuction(!0,!1,Go)},t.getTargeting=function(){return De},t.getAdSlotsByFuseId=t.getAdSlotsById,t.getFuseSlots=t.getSlots,t.getFuseSettings=t.getSettings,t.getFuseUnits=t.getUnits,t.loadFuseSlots=t.loadSlots,t.resetSlots=function(){return P.debug("[API]: resetSlots()"),zo.reset()},t.resetFuseSlots=function(){return P.debug("[API]: resetFuseSlots()"),zo.reset()},t.loadFuseSlotById=t.loadSlotById,t.setSlotTargetingByFuseId=t.setSlotTargetingById,t.setSlotTargetingById=function(t,e,i){return jo(t,e,i)},t.widgetsRenderer=t.privateApi.getWidgetRenderer(),t.setDefaultTargeting=function(){return P.debug("[API]: setDefaultTargeting()"),$t()},t.getRefreshIntervals=function(){return No.getRefreshIntervals()},t.disableRefresh=function(){return P.debug("[API]: disableRefresh()"),No.clearRefreshIntervals()},t.getSlots=function(){return Lo.getSlotTemplates()},t.getSettings=function(){return ko({},u.getAccountSettings())}},tagInitEmitter:Bo,ON_TAG_INIT_EVENT:Uo},Vo="ZVeqITFg3t0RVj7Gh41kEbdx9DA",Qo=c.getLogger(),Yo=c.getReporter(),Ko=a.getBrowserWindowObject(),Jo=function(t){return{name:"Confiant",url:"//confiant-integrations.global.ssl.fastly.net/".concat(t,"/gpt_and_prebid/"),file:"config.js"}};var Zo={enable:function(t,e){void 0===t&&(t=Vo),Yo.setStateStatus("confiant_load_start"),Ko.confiant=Ko.confiant||{},B(Jo(t),function(){Qo.log("[CONFIANT]: Script loaded"),Yo.setStateStatus("confiant_load_finish"),e&&e()})}},Xo=c.getLogger(),$o=c.getReporter(),tr={name:"Blockthrough",url:"//publift-com.videoplayerhub.com/",file:"galleryplayer.js"};var D,er={enableIfApplicable:function(t){u.isBlockthroughEnabled()?Re()?($o.setStateStatus("blockthrough_load_start"),B(tr,function(){Xo.log("[BLOCKTHROUGH]: Tag loaded"),$o.setStateStatus("blockthrough_load_finish"),t&&t()})):Xo.debug("[INIT]: Skip loading blockthrough because page on XS breakpoint"):Xo.debug("[INIT]: Skip loading blockthrough because it is not enabled")}};if(null!=(D=window.self.fusetag)&&D.loading)throw Te="[FUSE]: Fusetag is already initialising, and may have been included in the page twice",console.error(Te),new Error(Te);if(null!=(r=window.self.fusetag)&&r.init)throw Ae="[FUSE]: Fusetag is already initialised, and may have been included in the page twice",console.error(Ae),new Error(Ae);var ir=window.self.fusetag||(window.self.fusetag={que:[]}),L=(ir.loading=!0,c.getReporter()),N=(L.setStateStatus("tag_loaded"),c.getLogger()),nr=(N.log("[INIT] Initialising with UUID ".concat(u.getFuseUUID())),qi.getUam()),or=Wi.getConsentManger(),rr=Vn.getController(),sr=Vn.getAuctionExecutor(),ar=_i.getInitManager(),cr=Ro.getWidgetsRenderer(),lr=Ro.getInterstitialManager(),ur=Co.getApiV3(),dr=c.getTelemetry(),gr=Co.getPageManager();function pr(){if(L.setStateStatus("fuse_queue_start"),mo)yo.error("[INIT] processBacklog() called, but it already ran");else{for(mo=!0,yo.log("[INIT]: Processing fuse queue with ".concat(So().length," pending items"));0<So().length;){var t=So().shift();if("function"==typeof t)try{yo.debug("[INIT]: Calling queued function"),t.call(),t.called=!0}catch(t){yo.error("[INIT]: Error calling queued function:",t.message,t.stack)}else yo.error("[INIT]: Commands written into fusetag.que.push must be wrapped in a function")}Io()}L.setStateStatus("fuse_queue_finish")}function hr(t,e){t?u.isScanDOMOnPageLoad()?(N.debug("[INIT]: Running second (".concat(e,") docReady auto-scan and auction")),L.setStateStatus("second_autoscan_".concat(e,"_start")),rr.registerAndRunAuction(!0,!1,ur),L.setStateStatus("second_autoscan_".concat(e,"_finish")),N.debug("[INIT]: Finished second docReady DOM scan")):N.debug("[INIT]: Skipped second docReady dom-scan because it is disabled"):ar.setDocReady()}function fr(){L.setStateStatus("fuse_bootstrap_start"),Ho.enableApi(ir);var i,n,e,o=u.getTagStartCutoffMs(),t=L.getElapsedTime();if(!(l(o)||t<o))return N.warn("[INIT]: Fuse will not show ads because it took ".concat(t,"ms before it began loading")),void L.setStateStatus("fuse_bootstrap_finish");u.isCmpRequired()&&(or.generateStubs(),or.loadVersion(),ar.addCmpDeterminedListener(function(){h(function(){ge(or.isAllowPersonalisation())})})),u.isQuantcastEnabled()&&ft(lt(),"simulate quantcast load delay",function(){return Wi.getQuantcastLoader().load()}),u.isPrebidEnabled()&&(o=u.getPrebidTagStartCutoffMs(),t=L.getElapsedTime(),l(o)||t<o?(i=function(){return ft(dt(),"simulate prebid download delay",function(){ar.setPrebidLoadStart(),ti.enable(function(t){t&&ar.setPrebidReady()}),ti.pushToPrebidQue(function(){L.setStateStatus("prebid_queue_executing"),ar.setPrebidAutoScanRegistrationsComplete()})})},o=b().name,u.isPrebidEnabledAtBP(o)?i():ke(function(t,e){t&&!ar.isPrebidLoadStarted()&&(N.info("[INIT]: Prebid is enabled for breakpoint ".concat(e,", loading it now")),i())})):N.info("[INIT]: Skipping prebid load because fuse took ".concat(t,"ms to begin loading"))),u.isUamEnabled()&&(o=u.getUamTagStartCutoffMs(),t=L.getElapsedTime(),l(o)||t<o?(n=function(){return ft(gt(),"simulate uam download delay",function(){nr.load(u.isCmpRequired())})},o=b().name,u.isUamEnabledAtBP(o)?n():ke(function(t,e){t&&!ar.isUamLoadStarted()&&(N.info("[INIT]: UAM is enabled for breakpoint ".concat(e,", loading it now")),n())})):N.info("[INIT]: Skipping UAM load because fuse took ".concat(t,"ms to begin loading"))),u.isYandexEnabled()?window.yaContextCb?ar.setYandexReady():((t=(o=a.getBrowserWindowObject().document).createElement("script")).innerHTML="window.yaContextCb=window.yaContextCb||[]",o.head.appendChild(t),(t=o.createElement("script")).src="https://yandex.ru/ads/system/context.js",t.async=!0,o.head.appendChild(t),e=setInterval(function(){var t;null!=(t=null==(t=window.Ya)?void 0:t.Context)&&t.AdvManager&&(ar.setYandexReady(),clearInterval(e))},100)):(ft(ut(),"simulate gpt init delay",function(){ee(function(){ar.setGptReady()})}),h(function(){L.setStateStatus("gpt_queue_start_executing"),ar.setGptAutoScanRegistrationsComplete()}),h(function(){lr.initInterstitial()}),re(function(t){return sr.reportOnRenderEndedEvent(t)}),se(function(t){return sr.reportOnLoadEvent(t)}),ae(function(t){return sr.reportSlotResponseReceived(t)}),u.getUseTelemetry()&&ce(function(t){var e=t.slot.getAdUnitPath(),t=null==(t=u.getFuseSlots().filter(function(t){return t.slot===e})[0])?void 0:t.id;t&&dr.recordAdUnitLoad({baseUrl:u.getFuseCDN(),fuseId:u.getFuseId(),adUnitId:t,publicationId:u.getPublicationId()})}),h(function(){er.enableIfApplicable()}));var r,s=a.getBrowserWindowObject(),o=(Rt(u.isConfiantEnabled(),function(){Zo.enable(u.getConfiantId())}),Rt(u.isIdentityEnabled(),function(){ze.enable(s)}),Rt(u.isResponsiveEnabled(),function(){rr.configureResponsive()}),N);u.getV2CompatOverrides(),Co.getApiV3();try{o.log("[INIT][onFuseLoadCallback] Start"),o.debug("[INIT][onFuseLoadCallback] Finish")}catch(t){o.error("[INIT][onFuseLoadCallback] Encountered error during evaluation",t)}"complete"===(t=document.readyState)?(N.info("[INIT]: Document state is already 'complete'"),hr(!1,t)):(r=!1,"interactive"===t&&(N.info("[INIT]: Document state is already 'interactive'"),hr(!(r=!0),t)),document.addEventListener("readystatechange",function(){var t=document.readyState,e=(L.setStateStatus("document_readystatechange_".concat(t)),N.info("[INIT]: Received document '".concat(t,"' listener callback")),r);r=!0,hr(e,t)})),u.getIosChromeClickHandle()&&(o=c.getDeviceInfo()).getBrowser()===Q.Chrome&&o.getOperatingSystem()===Y.IOS&&(N.debug("[INIT]: Monitoring touch for Chrome on IOS"),Wn.getTouchObserver().monitorTouchDetect(),Wn.enableFastClick()),ar.addInitReadyListener(function(){pr(),u.isWidgetRendererEnabled()&&(cr.initConditions(),Ro.getWidgetsChecker().start(cr.getWidgetsWithSelector()),cr.addScrollToStickListener()),cr.injectFuseStyles(),ir.initialised=!0,ir.init=!0,ir.loading=!1,L.setStateStatus("tag_initialised"),ar.setTagInitialised(),L.setStateStatus("on_tag_init_event_start"),Ho.tagInitEmitter.emit(Ho.ON_TAG_INIT_EVENT),L.setStateStatus("on_tag_init_event_finish"),u.isScanDOMOnPageLoad()?(L.setStateStatus("fuse_trigger_auto_auction_start"),rr.registerAndRunAuction(!0,!1,ur),L.setStateStatus("fuse_trigger_auto_auction_finish")):rr.runDeferredAuctionIfRequired()}),gr.addPageInitListener(function(){lr.initInterstitial()}),L.setStateStatus("fuse_bootstrap_finish")}ft(pt("fuseDelayInit"),"simulate slow fuse download",fr)});
